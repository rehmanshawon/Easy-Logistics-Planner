{"ast":null,"code":"var _jsxFileName = \"c:\\\\Tutorials\\\\fabric-drawing\\\\src\\\\App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useState, useCallback } from \"react\";\nimport \"./styles.css\";\nimport styles from \"./rightMenu.module.css\";\nimport { fabric } from \"fabric\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  version: \"3.6.3\",\n  objects: [{\n    type: \"rect\",\n    version: \"3.6.3\",\n    originX: \"left\",\n    originY: \"top\",\n    left: 106,\n    top: 33,\n    width: 60,\n    height: 70,\n    fill: \"red\",\n    stroke: null,\n    strokeWidth: 1,\n    strokeDashArray: null,\n    strokeLineCap: \"butt\",\n    strokeDashOffset: 0,\n    strokeLineJoin: \"miter\",\n    strokeMiterLimit: 4,\n    scaleX: 1,\n    scaleY: 1,\n    angle: 0,\n    flipX: false,\n    flipY: false,\n    opacity: 1,\n    shadow: null,\n    visible: true,\n    clipTo: null,\n    backgroundColor: \"\",\n    fillRule: \"nonzero\",\n    paintFirst: \"fill\",\n    globalCompositeOperation: \"source-over\",\n    transformMatrix: null,\n    skewX: 0,\n    skewY: 0,\n    rx: 0,\n    ry: 0\n  }]\n}; // Or you can use:\n// const fabric = require(\"fabric\").fabric;\n//const canvas = new fabric.Canvas(\"my-fabric-canvas\");\n\nconst App = () => {\n  _s();\n\n  const canvasRef = useRef();\n  const [canvas, setCanvas] = useState();\n  const [canvasHistory, setCanvasHistory] = useState([initialState]);\n  const [canvasState, setCanvasState] = useState(initialState);\n  const [canvasTool, setCanvasTool] = useState(\"select\");\n  var nRect = true;\n  var Rectangle = null;\n  var origX, origY;\n  const onObjectModified = useCallback(e => {\n    const newCanvasState = e.target.canvas.toJSON();\n    setCanvasState(newCanvasState); // Limit history depth\n\n    setCanvasHistory(history => [...history, newCanvasState].slice(-32));\n  }, [setCanvasState, setCanvasHistory]);\n  React.useEffect(() => {//console.log(JSON.stringify(canvasState));\n  }, [canvasState]);\n  React.useEffect(() => {\n    const canvas = new fabric.Canvas(canvasRef.current);\n    canvas.loadFromJSON(initialState); //canvas.on(\"object:added\", onObjectModified);\n\n    canvas.on(\"object:modified\", onObjectModified); //canvas.on(\"object:removed\", onObjectModified);\n\n    const rect = new fabric.Rect({\n      width: 50,\n      height: 50,\n      fill: \"blue\",\n      angle: 10,\n      top: 20,\n      left: 20\n    });\n    const textbox = new fabric.Textbox(\"Click on the Rectangle to move it.\", {\n      fontSize: 20,\n      left: 50,\n      top: 100,\n      width: 200\n    });\n    canvas.add(textbox);\n    canvas.add(rect);\n    setCanvas(canvas); //refCanvas.current = canvas;\n    // UseEffect's cleanup function\n\n    return () => {\n      canvas.dispose(); //setCanvas(null);\n    };\n  }, [canvasRef, onObjectModified, setCanvas]);\n  const moveHistory = useCallback(step => {\n    const currentStateIndex = canvasHistory.indexOf(canvasState);\n    const prevState = canvasHistory[currentStateIndex + step];\n    canvas.loadFromJSON(prevState);\n    setCanvasState(prevState);\n  }, [canvas, canvasState, canvasHistory, setCanvasState]);\n  const onUndo = useCallback(() => moveHistory(-1), [moveHistory]);\n  const onRedo = useCallback(() => moveHistory(1), [moveHistory]);\n\n  const handleMouseClick = event => {\n    //let o = canvas.getActiveObject();\n    //console.log(o);\n    if (nRect) {\n      var pointer = canvas.getPointer(event);\n      origX = pointer.x;\n      origY = pointer.y;\n      Rectangle = new fabric.Rect({\n        left: origX,\n        top: origY,\n        fill: \"transparent\",\n        stroke: \"red\",\n        strokeWidth: 3\n      }); //console.log(Rectangle);\n\n      canvas.add(Rectangle);\n      setCanvas(canvas); //canvas.renderAll();\n      //setRect((prevState) => (prevState = false));\n\n      nRect = false; //setNewRectangle(false);\n    } else {\n      pointer = canvas.getPointer(event);\n\n      if (origX > pointer.x) {\n        Rectangle.set({\n          left: Math.abs(pointer.x)\n        });\n      }\n\n      if (origY > pointer.y) {\n        Rectangle.set({\n          top: Math.abs(pointer.y)\n        });\n      }\n\n      Rectangle.set({\n        width: Math.abs(origX - pointer.x)\n      });\n      Rectangle.set({\n        height: Math.abs(origY - pointer.y)\n      }); //setNewRectangle(true);\n\n      nRect = true; // Render the Canvas\n\n      canvas.renderAll(); // Save the canvas to State variable\n\n      const newCanvasState = canvas.toJSON();\n      setCanvasState(newCanvasState); // Save state to History and Limit history depth to 32\n\n      setCanvasHistory(history => [...history, newCanvasState].slice(-32));\n    }\n  };\n\n  const handleMouseMove = event => {\n    if (nRect) return; //canvas.renderAll();\n\n    var pointer = canvas.getPointer(event);\n\n    if (origX > pointer.x) {\n      Rectangle.set({\n        left: Math.abs(pointer.x)\n      });\n    }\n\n    if (origY > pointer.y) {\n      Rectangle.set({\n        top: Math.abs(pointer.y)\n      });\n    }\n\n    Rectangle.set({\n      width: Math.abs(origX - pointer.x)\n    });\n    Rectangle.set({\n      height: Math.abs(origY - pointer.y)\n    }); //console.log(Rectangle);\n\n    canvas.renderAll(); //var pointer = canvas.getPointer(event);\n    //console.log(pointer);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    onMouseMove: handleMouseMove,\n    onClick: handleMouseClick,\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Hello CodeSandbox\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Start editing to see some magic happen!\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onUndo,\n      disabled: canvasHistory[0] === canvasState,\n      children: \"Undo\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onRedo,\n      disabled: canvasHistory[canvasHistory.length - 1] === canvasState,\n      children: \"Redo\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.right,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.tab,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: setCanvasTool(\"select\"),\n          id: \"defaultSelect\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.tooltip,\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"images/Select2.png\",\n              alt: \"TextBox\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.tooltiptext,\n              children: \"Selection\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 209,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      id: \"my-fabric-canvas\",\n      width: \"1000\",\n      height: \"800\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 188,\n    columnNumber: 5\n  }, this);\n};\n\n_s(App, \"BvuvmmQks02/3Qj3H3flYK1IAO4=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["c:/Tutorials/fabric-drawing/src/App.js"],"names":["React","useRef","useState","useCallback","styles","fabric","initialState","version","objects","type","originX","originY","left","top","width","height","fill","stroke","strokeWidth","strokeDashArray","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","scaleX","scaleY","angle","flipX","flipY","opacity","shadow","visible","clipTo","backgroundColor","fillRule","paintFirst","globalCompositeOperation","transformMatrix","skewX","skewY","rx","ry","App","canvasRef","canvas","setCanvas","canvasHistory","setCanvasHistory","canvasState","setCanvasState","canvasTool","setCanvasTool","nRect","Rectangle","origX","origY","onObjectModified","e","newCanvasState","target","toJSON","history","slice","useEffect","Canvas","current","loadFromJSON","on","rect","Rect","textbox","Textbox","fontSize","add","dispose","moveHistory","step","currentStateIndex","indexOf","prevState","onUndo","onRedo","handleMouseClick","event","pointer","getPointer","x","y","set","Math","abs","renderAll","handleMouseMove","length","right","tab","tooltip","tooltiptext"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useCallback } from \"react\";\nimport \"./styles.css\";\nimport styles from \"./rightMenu.module.css\";\nimport { fabric } from \"fabric\";\n\nconst initialState = {\n  version: \"3.6.3\",\n  objects: [\n    {\n      type: \"rect\",\n      version: \"3.6.3\",\n      originX: \"left\",\n      originY: \"top\",\n      left: 106,\n      top: 33,\n      width: 60,\n      height: 70,\n      fill: \"red\",\n      stroke: null,\n      strokeWidth: 1,\n      strokeDashArray: null,\n      strokeLineCap: \"butt\",\n      strokeDashOffset: 0,\n      strokeLineJoin: \"miter\",\n      strokeMiterLimit: 4,\n      scaleX: 1,\n      scaleY: 1,\n      angle: 0,\n      flipX: false,\n      flipY: false,\n      opacity: 1,\n      shadow: null,\n      visible: true,\n      clipTo: null,\n      backgroundColor: \"\",\n      fillRule: \"nonzero\",\n      paintFirst: \"fill\",\n      globalCompositeOperation: \"source-over\",\n      transformMatrix: null,\n      skewX: 0,\n      skewY: 0,\n      rx: 0,\n      ry: 0,\n    },\n  ],\n};\n\n// Or you can use:\n// const fabric = require(\"fabric\").fabric;\n//const canvas = new fabric.Canvas(\"my-fabric-canvas\");\nconst App = () => {\n  const canvasRef = useRef();\n  const [canvas, setCanvas] = useState();\n  const [canvasHistory, setCanvasHistory] = useState([initialState]);\n  const [canvasState, setCanvasState] = useState(initialState);\n  const [canvasTool, setCanvasTool] = useState(\"select\");\n\n  var nRect = true;\n  var Rectangle = null;\n  var origX, origY;\n\n  const onObjectModified = useCallback(\n    (e) => {\n      const newCanvasState = e.target.canvas.toJSON();\n      setCanvasState(newCanvasState);\n      // Limit history depth\n      setCanvasHistory((history) => [...history, newCanvasState].slice(-32));\n    },\n    [setCanvasState, setCanvasHistory]\n  );\n\n  React.useEffect(() => {\n    //console.log(JSON.stringify(canvasState));\n  }, [canvasState]);\n\n  React.useEffect(() => {\n    const canvas = new fabric.Canvas(canvasRef.current);\n    canvas.loadFromJSON(initialState);\n    //canvas.on(\"object:added\", onObjectModified);\n    canvas.on(\"object:modified\", onObjectModified);\n\n    //canvas.on(\"object:removed\", onObjectModified);\n\n    const rect = new fabric.Rect({\n      width: 50,\n      height: 50,\n      fill: \"blue\",\n      angle: 10,\n      top: 20,\n      left: 20,\n    });\n    const textbox = new fabric.Textbox(\"Click on the Rectangle to move it.\", {\n      fontSize: 20,\n      left: 50,\n      top: 100,\n      width: 200,\n    });\n    canvas.add(textbox);\n    canvas.add(rect);\n    setCanvas(canvas);\n    //refCanvas.current = canvas;\n    // UseEffect's cleanup function\n    return () => {\n      canvas.dispose();\n      //setCanvas(null);\n    };\n  }, [canvasRef, onObjectModified, setCanvas]);\n\n  const moveHistory = useCallback(\n    (step) => {\n      const currentStateIndex = canvasHistory.indexOf(canvasState);\n      const prevState = canvasHistory[currentStateIndex + step];\n      canvas.loadFromJSON(prevState);\n      setCanvasState(prevState);\n    },\n    [canvas, canvasState, canvasHistory, setCanvasState]\n  );\n\n  const onUndo = useCallback(() => moveHistory(-1), [moveHistory]);\n\n  const onRedo = useCallback(() => moveHistory(1), [moveHistory]);\n\n  const handleMouseClick = (event) => {\n    //let o = canvas.getActiveObject();\n    //console.log(o);\n    if (nRect) {\n      var pointer = canvas.getPointer(event);\n      origX = pointer.x;\n      origY = pointer.y;\n      Rectangle = new fabric.Rect({\n        left: origX,\n        top: origY,\n        fill: \"transparent\",\n        stroke: \"red\",\n        strokeWidth: 3,\n      });\n      //console.log(Rectangle);\n      canvas.add(Rectangle);\n      setCanvas(canvas);\n      //canvas.renderAll();\n      //setRect((prevState) => (prevState = false));\n      nRect = false;\n      //setNewRectangle(false);\n    } else {\n      pointer = canvas.getPointer(event);\n      if (origX > pointer.x) {\n        Rectangle.set({ left: Math.abs(pointer.x) });\n      }\n      if (origY > pointer.y) {\n        Rectangle.set({ top: Math.abs(pointer.y) });\n      }\n      Rectangle.set({ width: Math.abs(origX - pointer.x) });\n      Rectangle.set({ height: Math.abs(origY - pointer.y) });\n\n      //setNewRectangle(true);\n      nRect = true;\n      // Render the Canvas\n      canvas.renderAll();\n\n      // Save the canvas to State variable\n      const newCanvasState = canvas.toJSON();\n      setCanvasState(newCanvasState);\n      // Save state to History and Limit history depth to 32\n      setCanvasHistory((history) => [...history, newCanvasState].slice(-32));\n    }\n  };\n  const handleMouseMove = (event) => {\n    if (nRect) return;\n    //canvas.renderAll();\n    var pointer = canvas.getPointer(event);\n    if (origX > pointer.x) {\n      Rectangle.set({ left: Math.abs(pointer.x) });\n    }\n    if (origY > pointer.y) {\n      Rectangle.set({ top: Math.abs(pointer.y) });\n    }\n    Rectangle.set({ width: Math.abs(origX - pointer.x) });\n    Rectangle.set({ height: Math.abs(origY - pointer.y) });\n\n    //console.log(Rectangle);\n    canvas.renderAll();\n\n    //var pointer = canvas.getPointer(event);\n    //console.log(pointer);\n  };\n\n  return (\n    <div\n      onMouseMove={handleMouseMove}\n      onClick={handleMouseClick}\n      className=\"App\"\n    >\n      <h1>Hello CodeSandbox</h1>\n      <h2>Start editing to see some magic happen!</h2>\n      <button onClick={onUndo} disabled={canvasHistory[0] === canvasState}>\n        Undo\n      </button>\n      <button\n        onClick={onRedo}\n        disabled={canvasHistory[canvasHistory.length - 1] === canvasState}\n      >\n        Redo\n      </button>\n      <div className={styles.right}>\n        <div className={styles.tab}>\n          <button onClick={setCanvasTool(\"select\")} id=\"defaultSelect\">\n            <div className={styles.tooltip}>\n              <img src={\"images/Select2.png\"} alt=\"TextBox\"></img>\n              <span className={styles.tooltiptext}>Selection</span>\n            </div>\n          </button>\n        </div>\n      </div>\n      <canvas ref={canvasRef} id=\"my-fabric-canvas\" width=\"1000\" height=\"800\" />\n    </div>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}