{"ast":null,"code":"import _slicedToArray from\"C:/Tutorials/elp-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"C:/Tutorials/elp-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3;import React,{useRef,useEffect}from\"react\";import styled from\"styled-components\";import throttle from\"lodash.throttle\";import{convertRGBtoHSL}from\"./utils\";import Svg from\"./Svg\";import usePaintSquare from\"./usePaintSquare\";import config from\"./config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var squareSize=config.squareSize,crossSize=config.crossSize,delay=config.delay;export var SquareWrapper=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  position: relative;\\n  width: \",\";\\n  height: \",\";\\n  cursor: crosshair;\\n\"])),squareSize+\"px\",squareSize+\"px\");export var Canvas=styled.canvas.attrs(function(p){return{width:squareSize,height:squareSize};})(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\"])));export var Cross=styled.div.attrs(function(p){return{style:{top:p.top+\"px\",left:p.left+\"px\",width:crossSize+\"px\",height:crossSize+\"px\",transition:p.animate?\"top .2s ease-out, left .2s ease-out\":\"0s\"}};})(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  display: grid;\\n  justify-items: center;\\n  align-items: center;\\n  svg {\\n    width: 100%;\\n    height: 100%;\\n  }\\n\"])));var Square=function Square(_ref){var hue=_ref.hue,squareXY=_ref.squareXY,animate=_ref.animate,setSquare=_ref.setSquare,offsetTop=_ref.offsetTop,offsetLeft=_ref.offsetLeft,setSquareXY=_ref.setSquareXY,setAnimate=_ref.setAnimate;var square=useRef(null);var canvas=useRef(null);usePaintSquare(canvas,hue);useEffect(function(){var canvasRef=canvas.current;var ctx=canvasRef.getContext(\"2d\");function computePosition(e){var x=Math.max(crossSize/-2,Math.min(e.clientX-offsetLeft-crossSize+2.5,squareSize-crossSize/2));var y=Math.max(crossSize/-2,Math.min(e.clientY-offsetTop-crossSize+2.5,squareSize-crossSize/2));return[x,y];}function changeColor(e){var _computePosition=computePosition(e),_computePosition2=_slicedToArray(_computePosition,2),x=_computePosition2[0],y=_computePosition2[1];var x1=Math.min(x+crossSize/2,squareSize-1);var y1=Math.min(y+crossSize/2,squareSize-1);var _ctx$getImageData$dat=_slicedToArray(ctx.getImageData(x1,y1,1,1).data,3),r=_ctx$getImageData$dat[0],g=_ctx$getImageData$dat[1],b=_ctx$getImageData$dat[2];var _convertRGBtoHSL=convertRGBtoHSL([r,g,b]),_convertRGBtoHSL2=_slicedToArray(_convertRGBtoHSL,3),h=_convertRGBtoHSL2[0],s=_convertRGBtoHSL2[1],l=_convertRGBtoHSL2[2];setSquare([s,l]);setSquareXY([x,y]);}var onMouseMove=throttle(function(e){changeColor(e);},delay);function onMouseUp(e){changeColor(e);document.body.removeEventListener(\"mousemove\",onMouseMove);document.body.removeEventListener(\"mouseup\",onMouseUp);}function onMouseDown(e){setAnimate(false);document.body.addEventListener(\"mousemove\",onMouseMove);document.body.addEventListener(\"mouseup\",onMouseUp);}canvasRef.addEventListener(\"mousedown\",onMouseDown);return function(){canvasRef.removeEventListener(\"mousedown\",onMouseDown);};},[offsetTop,offsetLeft,setSquare,setSquareXY,setAnimate]);return/*#__PURE__*/_jsxs(SquareWrapper,{ref:square,children:[/*#__PURE__*/_jsx(Cross,{top:squareXY[1],left:squareXY[0],animate:animate,children:/*#__PURE__*/_jsx(Svg,{name:\"cross\"})}),/*#__PURE__*/_jsx(Canvas,{ref:canvas})]});};export default Square;","map":{"version":3,"sources":["C:/Tutorials/elp-app/src/components/Picker/Square.js"],"names":["React","useRef","useEffect","styled","throttle","convertRGBtoHSL","Svg","usePaintSquare","config","squareSize","crossSize","delay","SquareWrapper","div","Canvas","canvas","attrs","p","width","height","Cross","style","top","left","transition","animate","Square","hue","squareXY","setSquare","offsetTop","offsetLeft","setSquareXY","setAnimate","square","canvasRef","current","ctx","getContext","computePosition","e","x","Math","max","min","clientX","y","clientY","changeColor","x1","y1","getImageData","data","r","g","b","h","s","l","onMouseMove","onMouseUp","document","body","removeEventListener","onMouseDown","addEventListener"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect } from \"react\"\r\nimport styled from \"styled-components\"\r\nimport throttle from \"lodash.throttle\"\r\nimport { convertRGBtoHSL } from \"./utils\"\r\nimport Svg from \"./Svg\"\r\nimport usePaintSquare from \"./usePaintSquare\"\r\nimport config from \"./config\"\r\n\r\nconst { squareSize, crossSize, delay } = config\r\n\r\nexport const SquareWrapper = styled.div`\r\n  position: relative;\r\n  width: ${squareSize + \"px\"};\r\n  height: ${squareSize + \"px\"};\r\n  cursor: crosshair;\r\n`\r\n\r\nexport const Canvas = styled.canvas.attrs(p => ({\r\n  width: squareSize,\r\n  height: squareSize\r\n}))``\r\n\r\nexport const Cross = styled.div.attrs(p => ({\r\n  style: {\r\n    top: p.top + \"px\",\r\n    left: p.left + \"px\",\r\n    width: crossSize + \"px\",\r\n    height: crossSize + \"px\",\r\n    transition: p.animate ? \"top .2s ease-out, left .2s ease-out\" : \"0s\"\r\n  }\r\n}))`\r\n  position: absolute;\r\n  display: grid;\r\n  justify-items: center;\r\n  align-items: center;\r\n  svg {\r\n    width: 100%;\r\n    height: 100%;\r\n  }\r\n`\r\n\r\nconst Square = ({\r\n  hue,\r\n  squareXY,\r\n  animate,\r\n  setSquare,\r\n  offsetTop,\r\n  offsetLeft,\r\n  setSquareXY,\r\n  setAnimate\r\n}) => {\r\n  const square = useRef(null)\r\n  const canvas = useRef(null)\r\n\r\n  usePaintSquare(canvas, hue)\r\n\r\n  useEffect(() => {\r\n    const canvasRef = canvas.current\r\n    const ctx = canvasRef.getContext(\"2d\")\r\n\r\n    function computePosition(e) {\r\n      const x = Math.max(\r\n        crossSize / -2,\r\n        Math.min(\r\n          e.clientX - offsetLeft - crossSize + 2.5,\r\n          squareSize - crossSize / 2\r\n        )\r\n      )\r\n      const y = Math.max(\r\n        crossSize / -2,\r\n        Math.min(\r\n          e.clientY - offsetTop - crossSize + 2.5,\r\n          squareSize - crossSize / 2\r\n        )\r\n      )\r\n\r\n      return [x, y]\r\n    }\r\n\r\n    function changeColor(e) {\r\n      const [x, y] = computePosition(e)\r\n      const x1 = Math.min(x + crossSize / 2, squareSize - 1)\r\n      const y1 = Math.min(y + crossSize / 2, squareSize - 1)\r\n      const [r, g, b] = ctx.getImageData(x1, y1, 1, 1).data\r\n      const [h, s, l] = convertRGBtoHSL([r, g, b])\r\n      setSquare([s, l])\r\n      setSquareXY([x, y])\r\n    }\r\n\r\n    const onMouseMove = throttle(e => {\r\n      changeColor(e)\r\n    }, delay)\r\n\r\n    function onMouseUp(e) {\r\n      changeColor(e)\r\n      document.body.removeEventListener(\"mousemove\", onMouseMove)\r\n      document.body.removeEventListener(\"mouseup\", onMouseUp)\r\n    }\r\n\r\n    function onMouseDown(e) {\r\n      setAnimate(false)\r\n      document.body.addEventListener(\"mousemove\", onMouseMove)\r\n      document.body.addEventListener(\"mouseup\", onMouseUp)\r\n    }\r\n\r\n    canvasRef.addEventListener(\"mousedown\", onMouseDown)\r\n\r\n    return () => {\r\n      canvasRef.removeEventListener(\"mousedown\", onMouseDown)\r\n    }\r\n  }, [offsetTop, offsetLeft, setSquare, setSquareXY, setAnimate])\r\n\r\n  return (\r\n    <SquareWrapper ref={square}>\r\n      <Cross top={squareXY[1]} left={squareXY[0]} animate={animate}>\r\n        <Svg name=\"cross\" />\r\n      </Cross>\r\n      <Canvas ref={canvas} />\r\n    </SquareWrapper>\r\n  )\r\n}\r\n\r\nexport default Square\r\n"]},"metadata":{},"sourceType":"module"}