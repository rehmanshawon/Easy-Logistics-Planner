{"ast":null,"code":"import _toConsumableArray from\"C:/Tutorials/elp-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _createForOfIteratorHelper from\"C:/Tutorials/elp-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _slicedToArray from\"C:/Tutorials/elp-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"C:/Tutorials/elp-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject;import React,{useRef,useState}from\"react\";import{fabric}from\"fabric\";import{SketchPicker}from\"react-color\";import Picker from\"../src/components/Picker/Picker\";import MediaQuery from\"react-responsive\";import{useMediaQuery}from\"react-responsive\";import reactCSS from\"reactcss\";import imgUndo from\"./images/undo2.png\";import imgRedo from\"./images/redo2.png\";import imgDelete from\"./images/delete2.png\";import imglineWidth from\"./images/lineWidth2.png\";import imgStroke1 from\"./images/stroke1.png\";import imgStroke2 from\"./images/stroke2.png\";import imgStroke4 from\"./images/stroke4.png\";import imgStroke5 from\"./images/stroke5.png\";import imgStroke10 from\"./images/stroke10.png\";import imgStroke12 from\"./images/stroke12.png\";import imgStroke15 from\"./images/stroke15.png\";import imgStroke20 from\"./images/stroke20.png\";import imgStroke25 from\"./images/stroke25.png\";import imgLineStyle from\"./images/LineStyle2.png\";import imgLineStyle1 from\"./images/lineStyle1.png\";import imgLineStyle2 from\"./images/lineStyle2png.png\";import imgLineStyle3 from\"./images/lineStyle3.png\";import imgLineStyle4 from\"./images/lineStyle4.png\";import imgLineStyle5 from\"./images/lineStyle5.png\";import imgLineStyle6 from\"./images/lineStyle6.png\";import imgLineStyle7 from\"./images/lineStyle7.png\";import imgText from\"./images/TextBox2.png\";import imgFreeHand from\"./images/PenTool2.png\";import imgSelection from\"./images/Select2.png\";import imgCloud from\"./images/Cloud2.png\";import imgCallout from\"./images/CallOut2.png\";import imgImageEdit from\"./images/Image2.png\";import imgLine from\"./images/Line2.png\";import imgPolyline from\"./images/Polyline2.png\";import imgArrow from\"./images/Arrow2.png\";import imgArc from\"./images/Arc2.png\";import imgRect from\"./images/Rectangle2.png\";import imgPolygon from\"./images/Polygon2.png\";import imgRPolygon from\"./images/RPolygon2.png\";import imgCircle from\"./images/Circle2.png\";import imgEllipse from\"./images/Ellipse2.png\";import imgDimension from\"./images/Dimension2.png\";import imgArea from\"./images/Area2.png\";import imgLength from\"./images/Length2.png\";import imgPerimeter from\"./images/Perimeter2.png\";import imgDropper from\"./images/dropper2.png\";import imgNoStroke from\"./images/noStroke2.png\";import imgNoFill from\"./images/noFill2.png\";import imgFileAccess from\"./images/FileAccess2.png\";import imgNewFile from\"./images/NewFile2.png\";import imgOpenFile from\"./images/OpenFile2.png\";import imgRecentFile from\"./images/recentFile2.png\";import imgCanvasSettings from\"./images/Canvas2.png\";import imgCanvasSize from\"./images/CanvasSize2.png\";import imgCanvasColor from\"./images/CanvasColor2.png\";import imgCanvasImage from\"./images/CanvasImage2.png\";import imgLayers from\"./images/Layers2.png\";import imgLayerBefore from\"./images/InsertBefore2.png\";import imgLayerAfter from\"./images/InsertAfter2.png\";import imgLayerUp from\"./images/Up2.png\";import imgLayerDown from\"./images/Down2.png\";import imgLayerHide from\"./images/Hide2.png\";import imgLayerLock from\"./images/Lock2.png\";import imgLayerSort from\"./images/SortAlpha2.png\";import imgWarehouse from\"./images/Warehouse2.png\";import imgCrane from\"./images/Crane2.png\";import imgElevator from\"./images/Elevator2.png\";import imgLabels from\"./images/labels2.png\";import imgCloud2 from\"./images/CloudTool2.png\";import imgWedge from\"./images/wedge2.png\";import imgRing from\"./images/Ring2.png\";import imgFilledArc from\"./images/FilledArc2.png\";import imgPhase from\"./images/Phases2.png\";import imgNewPhase from\"./images/NewPhase2.png\";import imgPhaseStart from\"./images/StartDate2.png\";import imgPhaseEnd from\"./images/EndDate2.png\";import imgPhaseDelete from\"./images/DeletePhase2.png\";import imgMeasurement from\"./images/Measure2.png\";import imgPageScale from\"./images/PageScale2.png\";import imgSetUnits from\"./images/setunit2.png\";import imgAnimation from\"./images/Animation2.png\";import imgPlay from\"./images/Play2.png\";import\"./styles.css\";import styles from\"./rightMenu.module.css\";import tbStyles from\"./toolbar.module.css\";import styled from\"styled-components\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var Backdrop=styled.div.attrs(function(p){return{style:{zIndex:p.zIndex,display:p.show?\"block\":\"none\",background:p.backdrop?\"rgba(0, 0, 0, 0.1)\":\"transparent\"}};})(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  position: fixed;\\n  z-index: 1;\\n  top: 0;\\n  bottom: 0;\\n  left: 0;\\n  right: 0;\\n\"])));var initialState={version:\"3.6.3\",objects:[{type:\"rect\",version:\"3.6.3\",originX:\"left\",originY:\"top\",left:0,top:0,width:1,height:1,fill:\"black\",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:\"butt\",strokeDashOffset:0,strokeLineJoin:\"miter\",strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:false,flipY:false,opacity:1,shadow:null,visible:false,clipTo:null,backgroundColor:\"\",fillRule:\"nonzero\",paintFirst:\"fill\",globalCompositeOperation:\"source-over\",transformMatrix:null,skewX:0,skewY:0,rx:0,ry:0,name:\"shape-rect-n\"}]};var fontCheck=new Set([// Windows 10\n\"Arial\",\"Arial Black\",\"Bahnschrift\",\"Calibri\",\"Cambria\",\"Cambria Math\",\"Candara\",\"Comic Sans MS\",\"Consolas\",\"Constantia\",\"Corbel\",\"Courier New\",\"Ebrima\",\"Franklin Gothic Medium\",\"Gabriola\",\"Gadugi\",\"Georgia\",\"HoloLens MDL2 Assets\",\"Impact\",\"Ink Free\",\"Javanese Text\",\"Leelawadee UI\",\"Lucida Console\",\"Lucida Sans Unicode\",\"Malgun Gothic\",\"Marlett\",\"Microsoft Himalaya\",\"Microsoft JhengHei\",\"Microsoft New Tai Lue\",\"Microsoft PhagsPa\",\"Microsoft Sans Serif\",\"Microsoft Tai Le\",\"Microsoft YaHei\",\"Microsoft Yi Baiti\",\"MingLiU-ExtB\",\"Mongolian Baiti\",\"MS Gothic\",\"MV Boli\",\"Myanmar Text\",\"Nirmala UI\",\"Palatino Linotype\",\"Segoe MDL2 Assets\",\"Segoe Print\",\"Segoe Script\",\"Segoe UI\",\"Segoe UI Historic\",\"Segoe UI Emoji\",\"Segoe UI Symbol\",\"SimSun\",\"Sitka\",\"Sylfaen\",\"Symbol\",\"Tahoma\",\"Times New Roman\",\"Trebuchet MS\",\"Verdana\",\"Webdings\",\"Wingdings\",\"Yu Gothic\",// macOS\n\"American Typewriter\",\"Andale Mono\",\"Arial\",\"Arial Black\",\"Arial Narrow\",\"Arial Rounded MT Bold\",\"Arial Unicode MS\",\"Avenir\",\"Avenir Next\",\"Avenir Next Condensed\",\"Baskerville\",\"Big Caslon\",\"Bodoni 72\",\"Bodoni 72 Oldstyle\",\"Bodoni 72 Smallcaps\",\"Bradley Hand\",\"Brush Script MT\",\"Chalkboard\",\"Chalkboard SE\",\"Chalkduster\",\"Charter\",\"Cochin\",\"Comic Sans MS\",\"Copperplate\",\"Courier\",\"Courier New\",\"Didot\",\"DIN Alternate\",\"DIN Condensed\",\"Futura\",\"Geneva\",\"Georgia\",\"Gill Sans\",\"Helvetica\",\"Helvetica Neue\",\"Herculanum\",\"Hoefler Text\",\"Impact\",\"Lucida Grande\",\"Luminari\",\"Marker Felt\",\"Menlo\",\"Microsoft Sans Serif\",\"Monaco\",\"Noteworthy\",\"Optima\",\"Palatino\",\"Papyrus\",\"Phosphate\",\"Rockwell\",\"Savoye LET\",\"SignPainter\",\"Skia\",\"Snell Roundhand\",\"Tahoma\",\"Times\",\"Times New Roman\",\"Trattatello\",\"Trebuchet MS\",\"Verdana\",\"Zapfino\"].sort());//const useForceUpdate = () => useState()[1];\n// Or you can use:\n// const fabric = require(\"fabric\").fabric;\n//const canvas = new fabric.Canvas(\"my-fabric-canvas\");\nfunction getWindowDimensions(){var _window=window,width=_window.innerWidth,height=_window.innerHeight;return{width:width,height:height};}function determineAdjustedCoords(fromX,fromY,toX,toY){// this function uses the last point plotted, the length of the lines to the new x and y coords (using toX and toY) to determine an adjusted rubber band end-point\n// find the angle subtended by the current rubber band line i.e. unadjusted (as dictated by the actual mouse coords) and the x axis\n// var xLen = Math.abs(toX - fromX);\n// var yLen = Math.abs(toY - fromY);\nvar xLen=toX-fromX;var yLen=toY-fromY;// if x or y difference is zero then no action needed so return\nif(xLen===0&&yLen===0)return;var theta=Math.atan(yLen/xLen)*(180/Math.PI);// find the hypontenuse of the triangle bounded by the x axis and the actual rubber band line - this will also be the hypontenuse of the adjusted rubber band line\nvar hyp;// verify if any of the components are zero\nif(Math.sin(theta*(Math.PI/180))===0)hyp=xLen;else{if(yLen===0)hyp=xLen;else hyp=yLen/Math.sin(theta*(Math.PI/180));}// find which sector the angle lies in and round it to the nearest sector\nvar sector=Math.round(theta/15);// find the angle subtended by the adjusted rubber band line (as dictated by the coords we are trying to determine)\nvar thetaNew=sector*15;// find new x and y coords of the adjusted rubber band line end points\nvar xNew=Math.cos(thetaNew*(Math.PI/180))*hyp;var yNew=Math.sin(thetaNew*(Math.PI/180))*hyp;// required coords equal the new coords added to the last point plotted (fromX,fromY)\nvar px=fromX+Math.round(xNew);var py=fromY+Math.round(yNew);return{tx:px,ty:py};}var App=function App(){var isDesktopOrLaptop=useMediaQuery({query:\"(min-width: 1224px)\"});var isBigScreen=useMediaQuery({query:\"(min-width: 1824px)\"});var isTabletOrMobile=useMediaQuery({query:\"(max-width: 1224px)\"});var isPortrait=useMediaQuery({query:\"(orientation: portrait)\"});var isRetina=useMediaQuery({query:\"(min-resolution: 2dppx)\"});//const mforceUpdate = useForceUpdate();\n// for undo/redoing\nvar _useState=useState([initialState]),_useState2=_slicedToArray(_useState,2),past=_useState2[0],setPast=_useState2[1];var _useState3=useState([initialState]),_useState4=_slicedToArray(_useState3,2),future=_useState4[0],setFuture=_useState4[1];var _useState5=useState(getWindowDimensions()),_useState6=_slicedToArray(_useState5,2),windowDimensions=_useState6[0],setWindowDimensions=_useState6[1];//const [newAction, setNewAction] = useState(0);\nvar _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),pageLoad=_useState8[0],setPageLoad=_useState8[1];// const canvasRender = useRef(0);\nvar mouseMoving=useRef(false);var canvasRef=useRef();var containerRef=useRef();var mainDiv=useRef(null);var rightBar=useRef();var shapeCount=useRef(0);var isDrawing=useRef(false);var currentStroke=useRef(\"\");var editPoly=useRef(true);var openPoly=useRef(null);var polyType=useRef(\"\");var someValue=useRef(0.0);var activeObjectStrokeRef=useRef(null);var activeObjectFillRef=useRef(null);//const [reRender, forceUpdate] = useReducer((x) => x + 1, 0);\n//const forceUpdate = React.useReducer(() => ({}))[1];\n//const [, updateComponent] = React.useState();\n//const forceUpdateComponent = React.useCallback(() => updateComponent({}), []);\n//anchors\nvar _useState9=useState(),_useState10=_slicedToArray(_useState9,2),canvas=_useState10[0],setCanvas=_useState10[1];var _useState11=useState(\"rgba(0, 0, 0, 1)\"),_useState12=_slicedToArray(_useState11,2),pickerStroke=_useState12[0],setPickerColorStroke=_useState12[1];var _useState13=useState(\"rgba(0, 0, 0, 1)\"),_useState14=_slicedToArray(_useState13,2),pickerFill=_useState14[0],setPickerColorFill=_useState14[1];//const [canvasHistory, setCanvasHistory] = useState([initialState]);\n//const [canvasHistory, setCanvasHistory] = useState([]);\n// const [canvasState, setCanvasState] = useState(initialState);\n//const [canvasState, setCanvasState] = useState();\nvar _useState15=useState(\"select\"),_useState16=_slicedToArray(_useState15,2),canvasTool=_useState16[0],setCanvasTool=_useState16[1];var _useState17=useState(1),_useState18=_slicedToArray(_useState17,2),strokeWidth=_useState18[0],setStrokeWidth=_useState18[1];// const [stroke, setStrokeColor] = useState(\"black\");\nvar _useState19=useState({r:\"0\",g:\"0\",b:\"0\",a:\"1\"}),_useState20=_slicedToArray(_useState19,2),stroke=_useState20[0],setStrokeColor=_useState20[1];var _useState21=useState({r:\"0\",g:\"0\",b:\"0\",a:\"0\"}),_useState22=_slicedToArray(_useState21,2),fill=_useState22[0],setFillColor=_useState22[1];var _useState23=useState({r:\"255\",g:\"255\",b:\"0\",a:\"1\"}),_useState24=_slicedToArray(_useState23,2),textHighlight=_useState24[0],setHighlight=_useState24[1];// const [fill, setFillColor] = useState(\"black\");\nvar _useState25=useState(0),_useState26=_slicedToArray(_useState25,2),dashSize=_useState26[0],setDashSize=_useState26[1];var _useState27=useState(0),_useState28=_slicedToArray(_useState27,2),gapSize=_useState28[0],setGapSize=_useState28[1];var _useState29=useState(100),_useState30=_slicedToArray(_useState29,2),opacity=_useState30[0],setOpacity=_useState30[1];// const [snap, setSnap] = useState(false);\nvar _useState31=useState(\"\"),_useState32=_slicedToArray(_useState31,2),font=_useState32[0],setFont=_useState32[1];var _useState33=useState(30),_useState34=_slicedToArray(_useState33,2),fontSize=_useState34[0],setFontSize=_useState34[1];var _useState35=useState(\"normal\"),_useState36=_slicedToArray(_useState35,2),fontWeight=_useState36[0],setFontWeight=_useState36[1];var _useState37=useState(\"regular\"),_useState38=_slicedToArray(_useState37,2),fontStyle=_useState38[0],setFontStyle=_useState38[1];//const [textHighlight, setHighlight] = useState(\"yellow\");\nvar _useState39=useState(false),_useState40=_slicedToArray(_useState39,2),showStrokePicker=_useState40[0],setShowStrokePicker=_useState40[1];var _useState41=useState(false),_useState42=_slicedToArray(_useState41,2),showFillPicker=_useState42[0],setShowFillPicker=_useState42[1];var _useState43=useState(false),_useState44=_slicedToArray(_useState43,2),showHighlightPicker=_useState44[0],setShowHighlightPicker=_useState44[1];//const [shapeCount, setShapeCount] = useState(0);\n//const opacity = useRef(100);\nvar snap=useRef(false);var newShape=useRef(true);var anchors=useRef([]);var pointer=useRef();var line=useRef(null);var origX=useRef();var origY=useRef();var angle=useRef();var arrow=useRef(null);var selectedShape=useRef(null);var polyPoints=useRef([]);var rpolygon=useRef(null);var Rectangle=useRef(null);var circle=useRef(null);var ellipse=useRef(null);var polyLine=useRef(null);var polyLines=useRef([]);var currentToolId=useRef(null);var currentOpenPanel=\"none\";var drawingObject={};drawingObject.type=\"\";drawingObject.background=\"\";drawingObject.border=\"\";var StrokeSwatchClick=function StrokeSwatchClick(){setShowStrokePicker(function(showStrokePicker){return!showStrokePicker;});if(!showStrokePicker){//Todo\nvar activeShape=canvas.getActiveObject();if(activeShape){if(activeShape.stroke===\"rgba(255,255,255,0)\"){setStrokeColor({r:255,g:255,b:255,a:1});setShapeAttributes({stroke:\"rgba(255,255,255,1)\"});}}}};var FillSwatchClick=function FillSwatchClick(){setShowFillPicker(function(showFillPicker){return!showFillPicker;});if(!showFillPicker){//Todo\nvar activeShape=canvas.getActiveObject();if(activeShape){if(activeShape.fill===\"rgba(255,255,255,0)\"){setFillColor({r:255,g:255,b:255,a:1});setShapeAttributes({fill:\"rgba(255,255,255,1)\"});}}}};var HighlightSwatchClick=function HighlightSwatchClick(){setShowHighlightPicker(function(showHighlightPicker){return!showHighlightPicker;});};var StrokeSwatchClose=function StrokeSwatchClose(){setShowStrokePicker(false);};var FillSwatchClose=function FillSwatchClose(){setShowFillPicker(false);};var HighlightSwatchClose=function HighlightSwatchClose(){setShowHighlightPicker(false);};var StrokeSwatchChange=function StrokeSwatchChange(color){//console.log(stroke);\nsetStrokeColor(color.rgb);// setShapeAttributes({\n//   stroke:\n//     \"rgba(\" +\n//     color.rgb.r +\n//     \", \" +\n//     color.rgb.g +\n//     \", \" +\n//     color.rgb.b +\n//     \", \" +\n//     color.rgb.a +\n//     \")\",\n// });\nsetShapeAttributes({stroke:pickerStroke});};var FillSwatchChange=function FillSwatchChange(color){//console.log(stroke);\nsetFillColor(color.rgb);setShapeAttributes({fill:\"rgba(\"+color.rgb.r+\", \"+color.rgb.g+\", \"+color.rgb.b+\", \"+color.rgb.a+\")\"});//console.log(swatchStyles.fill);\n};var HighlightSwatchChange=function HighlightSwatchChange(color){//console.log(stroke);\nsetHighlight(color.rgb);setShapeAttributes({textBackgroundColor:\"rgba(\"+color.rgb.r+\", \"+color.rgb.g+\", \"+color.rgb.b+\", \"+color.rgb.a+\")\"});};var calcPolygonPoints=function calcPolygonPoints(sideCount,radius){var sweep=Math.PI*2/sideCount;var cx=radius;var cy=radius;var points=[];for(var i=0;i<sideCount;i++){var x=cx+radius*Math.cos(i*sweep);var y=cy+radius*Math.sin(i*sweep);points.push({x:x,y:y});}return points;};/*\n  function click(id) {\n    var ev = new MouseEvent(\"click\", {\n      view: window,\n      bubbles: true,\n      cancelable: true,\n    });\n\n    var el = document.getElementById(id);\n    el.dispatchEvent(ev);\n  }\n  */var saveCanvasState=function saveCanvasState(newCanvasState){past.push(newCanvasState);setPast(past);setFuture([]);sessionStorage.clear();sessionStorage.myFabricJSCanvas=JSON.stringify(newCanvasState);// sessionStorage.setItem(\"history\", JSON.stringify(past));\n};/*\n  const onObjectModified = useCallback(\n    (e) => {\n      const newCanvasState = e.target.canvas.toJSON([\"name\"]);\n      //const newCanvasState = canvas.toJSON([\"name\"]);\n      setCanvasState(newCanvasState);\n      // Limit history depth\n      setCanvasHistory((history) => [...history, newCanvasState].slice(-32));\n      //setPast([...past, newCanvasState]);\n      //setFuture([]);\n      console.log(newCanvasState);\n    },\n    [setCanvasState, setCanvasHistory]\n  );\n*/React.useEffect(function(){// window.localStorage.setItem(\"colors\", JSON.stringify(colors));\n// setShapeAttributes({\n//   stroke: pickerStroke,\n// });\nif(canvas===undefined)return;var activeShape=canvas.getActiveObject();if(activeShape){// if (activeShape.stroke === \"rgba(255,255,255,0)\") {\n// setStrokeColor({ r: 255, g: 255, b: 255, a: 1 });\nsetShapeAttributes({stroke:pickerStroke});// }\n}// console.log(pickerStroke);\n},[pickerStroke,setPickerColorStroke,canvas]);React.useEffect(function(){// window.localStorage.setItem(\"colors\", JSON.stringify(colors));\n// setShapeAttributes({\n//   stroke: pickerStroke,\n// });\nif(canvas===undefined)return;var activeShape=canvas.getActiveObject();if(activeShape){// if (activeShape.stroke === \"rgba(255,255,255,0)\") {\n// setStrokeColor({ r: 255, g: 255, b: 255, a: 1 });\nsetShapeAttributes({fill:pickerFill});// }\n}// console.log(pickerStroke);\n},[pickerFill,setPickerColorFill,canvas]);React.useEffect(function(){/*\n    ---disabled for memory issues--\n    var history = JSON.parse(sessionStorage.getItem(\"history\")); //get them back    \n    if (history !== null) setPast(history);\n    */var fontAvailable=new Set();var _iterator=_createForOfIteratorHelper(fontCheck.values()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _font=_step.value;if(document.fonts.check(\"12px \\\"\".concat(_font,\"\\\"\"))){fontAvailable.add(_font);var x=document.getElementById(\"fonts\");var option=document.createElement(\"option\");option.text=_font;x.add(option);}}}catch(err){_iterator.e(err);}finally{_iterator.f();}},[]);// React.useEffect(() => {}, [canvasState]);\nReact.useEffect(function(){//console.log(\"shift pressed\");\nvar canvas=new fabric.Canvas(canvasRef.current);canvas.set({fireRightClick:true,fireMiddleClick:true,// <-- enable firing of middle click events\nstopContextMenu:true,controlsAboveOverlay:false,targetFindTolerance:15,preserveObjectStacking:true,perPixelTargetFind:true});if(pageLoad===null&&sessionStorage.myFabricJSCanvas!==undefined){setPageLoad(1);//console.log(sessionStorage.myFabricJSCanvas);\nvar data=JSON.parse(sessionStorage.myFabricJSCanvas);canvas.loadFromJSON(data);canvas.forEachObject(function(o){if(o.name.includes(\"anchor\")){canvas.remove(o);}});anchors.current=[];var json=canvas.toJSON([\"name\"]);past.push(json);setPast(past);/*\n      //disabled for memory issues. as a result, undoing after refresh is not possible\n      var history = JSON.parse(sessionStorage.getItem(\"history\")); //get them back      \n      if (history !== null) setPast(history);\n      */setFuture([]);}else{canvas.loadFromJSON(past[past.length-1]);}canvas.renderAll();function handleResize(){var ratio=canvas.getWidth()/canvas.getHeight();var containerWidth=containerRef.current.clientWidth>1191?1191:containerRef.current.clientWidth-100;var containerHeight=containerRef.current.clientHeight-100;var scale=containerWidth/canvas.getWidth();var zoom=canvas.getZoom()*scale;canvas.setDimensions({width:containerWidth,height:containerWidth/ratio});canvas.setViewportTransform([zoom,0,0,zoom,0,0]);}window.addEventListener(\"resize\",handleResize);editPoly.current=true;if(canvasTool===\"pen\"){canvas.isDrawingMode=1;canvas.freeDrawingBrush.color=\"rgba(\"+stroke.r+\", \"+stroke.g+\", \"+stroke.b+\", \"+stroke.a+\")\";canvas.freeDrawingBrush.width=strokeWidth;}if(canvasTool!==\"select\"){canvas.selection=false;canvas.defaultCursor=\"crosshair\";canvas.forEachObject(function(o){o.selectable=false;o.hoverCursor=\"move\";});if(openPoly.current!==null){openPoly.current=null;canvas.forEachObject(function(o){if(o.name.includes(\"anchor\")){canvas.remove(o);}});anchors.current=[];canvas.renderAll();var newCanvasState=canvas.toJSON([\"name\"]);saveCanvasState(newCanvasState);sessionStorage.myFabricJSCanvas=JSON.stringify(newCanvasState);}}else{canvas.selection=true;canvas.forEachObject(function(o){o.selectable=true;});var allObjects=canvas.getObjects();var lastObjectCreated=allObjects[allObjects.length-1];canvas.setActiveObject(lastObjectCreated);//console.log(lastObjectCreated);\ncanvas.renderAll();}canvas.on(\"object:rotating\",function(options){if(!snap.current)return;var angle=options.target.angle;var locked=Math.ceil(options.target.angle/5)*5;if(Math.abs(angle-locked)<10||Math.abs(locked-angle)<10){angle=locked;}options.target.set({angle:angle});});//canvas.on(\"object:added\", onObjectModified);\n// canvas.on(\"object:modified\", onObjectModified);\ncanvas.on(\"object:modified\",function(e){var newCanvasState=e.target.canvas.toJSON([\"name\"]);past.push(newCanvasState);setPast(past);//console.log(past);\nsetFuture([]);sessionStorage.clear();sessionStorage.myFabricJSCanvas=JSON.stringify(newCanvasState);// sessionStorage.setItem(\"history\", JSON.stringify(past));\n});canvas.on(\"object:removed\",function(e){var newCanvasState=e.target.canvas.toJSON([\"name\"]);past.push(newCanvasState);setPast(past);//console.log(past);\nsetFuture([]);sessionStorage.clear();sessionStorage.myFabricJSCanvas=JSON.stringify(newCanvasState);// sessionStorage.setItem(\"history\", JSON.stringify(past));\n});canvas.on(\"mouse:dblclick\",function(e){if(canvasTool===\"polygon\"){canvas.remove(line.current);for(var i=0;i<polyLines.current.length;i++){canvas.remove(polyLines.current[i]);}newShape.current=true;isDrawing.current=false;var polyGon=null;polyGon=new fabric.Polygon(polyPoints.current,{stroke:\"rgba(\"+stroke.r+\", \"+stroke.g+\", \"+stroke.b+\", \"+stroke.a+\")\",fill:\"rgba(\"+fill.r+\", \"+fill.g+\", \"+fill.b+\", \"+fill.a+\")\",strokeWidth:strokeWidth,selectable:false,hoverCursor:\"default\",name:\"shape-polygon-\"+shapeCount.current});canvas.add(polyGon);editPoly.current=true;canvas.setActiveObject(polyGon);// document.getElementById(\"select\").click();\ncanvas.renderAll();shapeCount.current++;var _newCanvasState=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState);}if(canvasTool===\"polyline\"){canvas.remove(line.current);for(i=0;i<polyLines.current.length;i++){canvas.remove(polyLines.current[i]);}newShape.current=true;isDrawing.current=false;var polyLine=new fabric.Polyline(polyPoints.current,{stroke:\"rgba(\"+stroke.r+\", \"+stroke.g+\", \"+stroke.b+\", \"+stroke.a+\")\",fill:\"\",strokeWidth:strokeWidth,selectable:false,hoverCursor:\"default\",name:\"shape-polyline-\"+shapeCount.current});canvas.add(polyLine);canvas.setActiveObject(polyLine);// document.getElementById(\"select\").click();\neditPoly.current=true;canvas.renderAll();shapeCount.current++;var _newCanvasState2=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState2);}if(canvasTool===\"select\"){console.log(e.target);if(e.target===null)return;if(e.target.type===\"polyline\"&&editPoly.current){canvas.set({perPixelTargetFind:false});canvas.forEachObject(function(o){if(o.name.includes(\"anchor\")){canvas.remove(o);}});anchors.current=[];polyType.current=\"polyline\";// polyPoints = [];\nvar editable=e.target;openPoly.current=editable;//for future hiding the anchor points.\neditable.set({hasControls:false,hasBorders:false,selectable:false,hoverCursor:\"default\"});editPoly.current=false;// console.log(editable.get(\"points\"));\nvar str=editable.get(\"name\");var id=str.split(\"-\");var matrix=editable.calcTransformMatrix();var transformedPoints=editable.get(\"points\").map(function(p){return new fabric.Point(p.x-editable.pathOffset.x,p.y-editable.pathOffset.y);}).map(function(p){return fabric.util.transformPoint(p,matrix);});var pFill=editable.get(\"fill\");var pStroke=editable.get(\"stroke\");var pName=editable.get(\"name\");canvas.remove(editable);var updatedPoly=new fabric.Polyline(transformedPoints,{fill:pFill,stroke:pStroke,name:pName,hasControls:false,hasBorders:false,selectable:false,hoverCursor:\"default\"});canvas.add(updatedPoly);canvas.sendToBack(updatedPoly);openPoly.current=updatedPoly;anchors.current=[];transformedPoints.forEach(function(p,index){var anchor=new fabric.Circle({left:p.x,top:p.y,radius:15,fill:\"green\",originX:\"center\",originY:\"center\",hasControls:false,hasBorders:false,name:\"anchor-\"+id[2]+\"-\"+index});canvas.add(anchor);anchors.current.push(anchor);});canvas.renderAll();return;}//if (e.target === null && !editPoly.current) {\nif(e.target.type===\"polyline\"&&!editPoly.current){canvas.set({perPixelTargetFind:true});polyType.current=\"\";editable=e.target;editable.set({hasControls:true,hasBorders:true,selectable:true,hoverCursor:\"move\"});editPoly.current=true;anchors.current.forEach(function(anchor){canvas.remove(anchor);});anchors.current=[];openPoly.current=null;canvas.renderAll();return;}if(e.target.type===\"polygon\"&&editPoly.current){if(e.target===null)return;if(e.target.name.includes(\"rpolygon\"))return;canvas.set({perPixelTargetFind:false});canvas.forEachObject(function(o){if(o.name.includes(\"anchor\")){canvas.remove(o);}});anchors.current=[];polyType.current=\"polygon\";// polyPoints = [];\neditable=e.target;openPoly.current=editable;//for future hiding the anchor points.\neditable.set({hasControls:false,hasBorders:false,selectable:false,hoverCursor:\"default\"});editPoly.current=false;// console.log(editable.get(\"points\"));\nstr=editable.get(\"name\");id=str.split(\"-\");matrix=editable.calcTransformMatrix();transformedPoints=editable.get(\"points\").map(function(p){return new fabric.Point(p.x-editable.pathOffset.x,p.y-editable.pathOffset.y);}).map(function(p){return fabric.util.transformPoint(p,matrix);});pFill=editable.get(\"fill\");pStroke=editable.get(\"stroke\");pName=editable.get(\"name\");canvas.remove(editable);updatedPoly=new fabric.Polygon(transformedPoints,{fill:pFill,stroke:pStroke,name:pName,hasControls:false,hasBorders:false,selectable:false,hoverCursor:\"default\"});canvas.add(updatedPoly);canvas.sendToBack(updatedPoly);anchors.current=[];transformedPoints.forEach(function(p,index){var anchor=new fabric.Circle({left:p.x,top:p.y,radius:15,fill:\"green\",originX:\"center\",originY:\"center\",hasControls:false,hasBorders:false,name:\"anchor-\"+id[2]+\"-\"+index});canvas.add(anchor);anchors.current.push(anchor);});canvas.renderAll();return;}if(e.target.type===\"polygon\"&&!editPoly.current){if(e.target.name.includes(\"rpolygon\"))return;canvas.set({perPixelTargetFind:true});polyType.current=\"\";editable=e.target;editable.set({hasControls:true,hasBorders:true,selectable:true,hoverCursor:\"move\"});editPoly.current=true;anchors.current.forEach(function(anchor){canvas.remove(anchor);});anchors.current=[];canvas.renderAll();return;}}});// canvas.on(\"dragenter\", function (options) {\n//   alert(\"draggin\");\n// });\ncanvas.on(\"object:moving\",function(options){// if (options.e.altKey) alert(\"moving\");\nif(options.target.type!==\"circle\"){if(openPoly.current!==null){openPoly.current=null;editPoly.current=true;anchors.current.forEach(function(anchor){canvas.remove(anchor);});anchors.current=[];canvas.renderAll();return;}}if(options.target.type===\"circle\"){var p=options.target;//console.log(p.get(\"name\"));\nif(p.name.includes(\"circle\"))return;if(p.name.includes(\"arc\"))return;var str=p.name.split(\"-\");if(polyType.current===\"polyline\"){var pname=\"shape-polyline-\"+str[1];}if(polyType.current===\"polygon\"){pname=\"shape-polygon-\"+str[1];}//console.log(pname);\nvar object=null;var objects=canvas.getObjects();for(var i=0;i<objects.length;i++){if(objects[i].name&&objects[i].name===pname){object=objects[i];break;}}// console.log(object);\nobject.points[str[2]]={x:p.getCenterPoint().x,y:p.getCenterPoint().y};//console.log(p.getCenterPoint());\nvar pFill=object.get(\"fill\");var pStroke=object.get(\"stroke\");var pName=object.get(\"name\");var pPoints=object.get(\"points\");//UNCOMMENT LINES 39 - 42 TO HAVE A WORKAROUND\ncanvas.remove(object);if(polyType.current===\"polyline\"){var updatedPoly=new fabric.Polyline(pPoints,{fill:pFill,stroke:pStroke,name:pName,hasControls:false,hasBorders:false,selectable:false,hoverCursor:\"default\"});}if(polyType.current===\"polygon\"){updatedPoly=new fabric.Polygon(pPoints,{fill:pFill,stroke:pStroke,name:pName,hasControls:false,hasBorders:false,selectable:false,hoverCursor:\"default\"});}canvas.add(updatedPoly);canvas.sendToBack(updatedPoly);canvas.renderAll();}});canvas.on(\"mouse:up\",function(e){this.setViewportTransform(this.viewportTransform);this.isDragging=false;mouseMoving.current=false;if(e.button===2)return;// if (e.button === 3) {\n//   setActiveTool(e, \"select\");\n//   setCanvas(\"select\");\n//   return;\n// }\n// this.selection = true;\nif(canvas.isDrawingMode){var allObjects=canvas.getObjects();var path=allObjects[allObjects.length-1];path.set({name:\"shape-path-\"+shapeCount.current});//console.log(path);\nshapeCount.current=shapeCount.current+1;canvas.selection=true;// document.getElementById(\"select\").click();\ncanvas.setActiveObject(allObjects[allObjects.length-1]);canvas.renderAll();var _newCanvasState3=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState3);// }\n}if(canvasTool===\"text\"){//console.log(canvas.getObjects());\npointer.current=canvas.getPointer(e);var text=new fabric.IText(\"Esc to edit\",{left:pointer.current.x,top:pointer.current.y,fontFamily:\"Arial\",fontSize:\"30\",// fontWeight: \"regular\",\n//stroke: stroke,\n// strokeWidth: strokeWidth,\n// selectable: false,\nhoverCursor:\"default\",name:\"shape-text-\"+shapeCount.current});//console.log(text);\ncanvas.add(text);// document.getElementById(\"select\").click();\ncanvas.setActiveObject(text);canvas.renderAll();shapeCount.current=shapeCount.current+1;// Save the canvas to State variable\nvar _newCanvasState4=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState4);}if(canvasTool===\"line\"){if(newShape.current){pointer.current=canvas.getPointer(e);var points=[pointer.current.x,pointer.current.y,pointer.current.x,pointer.current.y];line.current=new fabric.Line(points,{strokeWidth:strokeWidth,stroke:pickerStroke,originX:\"center\",originY:\"center\",padding:15,//selectable: false,\nhoverCursor:\"default\",name:\"shape-line-\"+shapeCount.current});canvas.add(line.current);shapeCount.current=shapeCount.current+1;newShape.current=false;}else{pointer.current=canvas.getPointer(e);if(e.e.shiftKey){var _determineAdjustedCoo=determineAdjustedCoords(line.current.x1,line.current.y1,pointer.current.x,pointer.current.y),tx=_determineAdjustedCoo.tx,ty=_determineAdjustedCoo.ty;line.current.set({x2:tx,y2:ty});// var deltaX = Math.abs(pointer.current.x - line.current.x1);\n// var deltaY = Math.abs(pointer.current.y - line.current.y1);\n// if (deltaX > deltaY)\n//   line.current.set({ x2: pointer.current.x, y2: line.current.y1 });\n// if (deltaY > deltaX)\n//   line.current.set({ x2: line.current.x1, y2: pointer.current.y });\n}else line.current.set({x2:pointer.current.x,y2:pointer.current.y});// line.current.set({ x2: pointer.current.x, y2: pointer.current.y });\n// document.getElementById(\"select\").click();\ncanvas.setActiveObject(line.current);canvas.renderAll();newShape.current=true;// Save the canvas to State variable\nvar _newCanvasState5=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState5);}}if(canvasTool===\"arrow\"){if(newShape.current){pointer.current=canvas.getPointer(e);var arrowLinePoints=[pointer.current.x,pointer.current.y,pointer.current.x,pointer.current.y];line.current=new fabric.Line(arrowLinePoints,{stroke:pickerStroke,strokeWidth:strokeWidth,originX:\"center\",originY:\"center\",padding:15});// reference points for arrowhead\norigX.current=line.current.x2;origY.current=line.current.y2;var dx=line.current.x2-line.current.x1,dy=line.current.y2-line.current.y1;/* calculate angle.current of arrow.current */angle.current=Math.atan2(dy,dx);angle.current*=180/Math.PI;angle.current+=90;arrow.current=new fabric.Triangle({angle:angle.current,fill:pickerFill,top:line.current.y2,left:line.current.x2,width:15,height:15,originX:\"center\",originY:\"center\",stroke:pickerStroke,strokeWidth:strokeWidth});canvas.add(line.current);canvas.add(arrow.current);canvas.renderAll();newShape.current=false;}else{canvas.remove(line.current);canvas.remove(arrow.current);selectedShape.current=new fabric.Group([line.current,arrow.current],{hasBorders:true,hasControls:true,selectable:false,hoverCursor:\"default\",originX:\"center\",originY:\"center\"});shapeCount.current=shapeCount.current+1;selectedShape.current.set(\"name\",\"shape-arrow-\"+shapeCount.current+1);canvas.add(selectedShape.current);canvas.setActiveObject(selectedShape.current);// document.getElementById(\"select\").click();\nnewShape.current=true;// Save the canvas to State variable\nvar _newCanvasState6=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState6);}}if(canvasTool===\"polyline\"){if(newShape.current){polyPoints.current=[];isDrawing.current=true;pointer.current=canvas.getPointer(e);origX.current=pointer.current.x;origY.current=pointer.current.y;polyPoints.current.push(pointer.current);line.current=new fabric.Line([pointer.current.x,pointer.current.y,pointer.current.x,pointer.current.y],{stroke:pickerStroke,strokeWidth:strokeWidth,hasControls:false,hasBorders:false,selectable:false,lockMovementX:true,lockMovementY:true,hoverCursor:\"default\",originX:\"center\",originY:\"center\",padding:15});canvas.add(line.current);//polyLines.current.push(polyline);\nnewShape.current=false;}else{pointer.current=canvas.getPointer(e);line.current.set({x1:pointer.current.x,y1:pointer.current.y});polyPoints.current.push(pointer.current);if(polyPoints.current.length>1){var startPoint=polyPoints.current[polyPoints.current.length-2];var endPoint=polyPoints.current[polyPoints.current.length-1];var evt=e.e;if(evt.shiftKey===true){if(Math.abs(pointer.current.x-startPoint.x)>Math.abs(pointer.current.y-startPoint.y)){console.log(\"line should be horizontally strait\");endPoint.y=startPoint.y;line.current.set({x1:pointer.current.x,y1:endPoint.y});}else{console.log(\"line should be vertically strait\");endPoint.x=startPoint.x;line.current.set({x1:startPoint.x,y1:pointer.current.y});}polyPoints.current.pop();polyPoints.current.push(endPoint);}var newPolyLine=new fabric.Line([startPoint.x,startPoint.y,endPoint.x,endPoint.y],{stroke:pickerStroke,strokeWidth:strokeWidth,hasControls:false,hasBorders:false,selectable:false,lockMovementX:true,lockMovementY:true,hoverCursor:\"default\",originX:\"center\",originY:\"center\",padding:15});var distance=Math.sqrt(Math.pow(origX.current-pointer.current.x,2)+Math.pow(origY.current-pointer.current.y,2));console.log(distance);if(distance<20){if(window.confirm(\"Close the shape? Press OK to close it. Cancel to keep the shape open.\")){newPolyLine.set({x2:origX.current,y2:origY.current});canvas.add(newPolyLine);canvas.renderAll();polyLines.current.push(newPolyLine);canvas.remove(line.current);for(var i=0;i<polyLines.current.length;i++){canvas.remove(polyLines.current[i]);}newShape.current=true;isDrawing.current=false;polyLine.current=null;polyPoints.current.pop();polyPoints.current.push(polyPoints.current[0]);console.log(polyPoints.current);polyLine.current=new fabric.Polygon(polyPoints.current,{stroke:pickerStroke,fill:pickerFill,strokeWidth:strokeWidth,padding:15,selectable:false,hoverCursor:\"default\",name:\"shape-polygon-\"+shapeCount.current});// console.log(fill);\ncanvas.add(polyLine.current);canvas.setActiveObject(polyLine.current);// document.getElementById(\"select\").click();\neditPoly.current=true;canvas.renderAll();shapeCount.current++;var _newCanvasState7=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState7);return;}else{// Do nothing!\nconsole.log(\"Shape still open double click to finish\");}}canvas.add(newPolyLine);polyLines.current.push(newPolyLine);canvas.renderAll();}}}if(canvasTool===\"polygon\"){if(newShape.current){polyPoints.current=[];isDrawing.current=true;pointer.current=canvas.getPointer(e);polyPoints.current.push(pointer.current);line.current=new fabric.Line([pointer.current.x,pointer.current.y,pointer.current.x,pointer.current.y],{stroke:pickerStroke,strokeWidth:strokeWidth,padding:15,hasControls:false,hasBorders:false,selectable:false,lockMovementX:true,lockMovementY:true,hoverCursor:\"default\",originX:\"center\",originY:\"center\"});canvas.add(line.current);newShape.current=false;}else{pointer.current=canvas.getPointer(e);line.current.set({x1:pointer.current.x,y1:pointer.current.y});polyPoints.current.push(pointer.current);if(polyPoints.current.length>1){startPoint=polyPoints.current[polyPoints.current.length-2];endPoint=polyPoints.current[polyPoints.current.length-1];newPolyLine=new fabric.Line([startPoint.x,startPoint.y,endPoint.x,endPoint.y],{stroke:pickerStroke,strokeWidth:strokeWidth,padding:15,hasControls:false,hasBorders:false,selectable:false,lockMovementX:true,lockMovementY:true,hoverCursor:\"default\",originX:\"center\",originY:\"center\"});canvas.add(newPolyLine);polyLines.current.push(newPolyLine);canvas.renderAll();}}}if(canvasTool===\"rpolygon\"){if(newShape.current){pointer.current=canvas.getPointer(e);origX.current=pointer.current.x;origY.current=pointer.current.y;rpolygon.current=new fabric.Polygon(calcPolygonPoints(8,Math.abs(origX.current-pointer.current.x)/2),{objectCaching:false,left:origX.current,top:origY.current,originX:\"center\",originY:\"center\",fill:pickerFill,perPixelTargetFind:false,strokeWidth:strokeWidth,stroke:pickerStroke,hasControls:false,hasBorders:false,padding:15,name:\"shape-rpolygon-\"+shapeCount.current});canvas.add(rpolygon.current);newShape.current=false;shapeCount.current++;}else{newShape.current=true;var matrix=rpolygon.current.calcTransformMatrix();var transformedPoints=rpolygon.current.get(\"points\").map(function(p){return new fabric.Point(p.x-rpolygon.current.pathOffset.x,p.y-rpolygon.current.pathOffset.y);}).map(function(p){return fabric.util.transformPoint(p,matrix);});canvas.remove(rpolygon.current);var updatedPoly=new fabric.Polygon(transformedPoints,{fill:pickerFill,stroke:pickerStroke,padding:15,name:\"shape-rpolygon-\"+shapeCount.current,// hasControls: false,\n// hasBorders: false,\n//selectable: false,\nhoverCursor:\"default\"});updatedPoly.set({originX:\"center\",originY:\"center\",left:origX.current+updatedPoly.width/2,top:origY.current+updatedPoly.height/2});canvas.add(updatedPoly);canvas.setActiveObject(updatedPoly);//  document.getElementById(\"select\").click();\ncanvas.renderAll();// Save the canvas to State variable\nvar _newCanvasState8=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState8);}}if(canvasTool===\"rect\"){if(newShape.current){pointer.current=canvas.getPointer(e);origX.current=pointer.current.x;origY.current=pointer.current.y;Rectangle.current=new fabric.Rect({left:origX.current,top:origY.current,fill:pickerFill,stroke:pickerStroke,strokeWidth:strokeWidth,padding:15,strokeDashArray:[dashSize,gapSize],centeredScaling:true,opacity:opacity,selectable:false,hoverCursor:\"default\",name:\"shape-rect-\"+shapeCount.current});shapeCount.current++;canvas.add(Rectangle.current);newShape.current=false;}else{pointer.current=canvas.getPointer(e);if(origX.current>pointer.current.x){Rectangle.current.set({left:Math.abs(pointer.current.x)});}if(origY.current>pointer.current.y){Rectangle.current.set({top:Math.abs(pointer.current.y)});}Rectangle.current.set({width:Math.abs(origX.current-pointer.current.x)});Rectangle.current.set({height:Math.abs(origY.current-pointer.current.y)});Rectangle.current.set({originX:\"center\",originY:\"center\",left:origX.current+Rectangle.current.width/2,top:origY.current+Rectangle.current.height/2});newShape.current=true;canvas.setActiveObject(Rectangle.current);//  document.getElementById(\"select\").click();\ncanvas.renderAll();// Save the canvas to State variable\nvar _newCanvasState9=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState9);}}if(canvasTool===\"arc\"){if(newShape.current){pointer.current=canvas.getPointer(e);origX.current=pointer.current.x;origY.current=pointer.current.y;circle.current=new fabric.Circle({left:origX.current,top:origY.current,originX:\"left\",originY:\"top\",radius:pointer.current.x-origX.current,angle:45,startAngle:0,endAngle:Math.PI,fill:pickerFill,stroke:pickerStroke,strokeWidth:strokeWidth,padding:15,selectable:false,hoverCursor:\"default\",name:\"shape-arc-\"+shapeCount.current});canvas.add(circle.current);newShape.current=false;shapeCount.current++;}else{pointer.current=canvas.getPointer(e);var radius=Math.max(Math.abs(origY.current-pointer.current.y),Math.abs(origX.current-pointer.current.x))/2;if(radius>circle.current.strokeWidth){radius-=circle.current.strokeWidth/2;}circle.current.set({radius:radius});if(origX.current>pointer.current.x){circle.current.set({originX:\"right\"});}else{circle.current.set({originX:\"left\"});}if(origY.current>pointer.current.y){circle.current.set({originY:\"bottom\"});}else{circle.current.set({originY:\"top\"});}newShape.current=true;canvas.setActiveObject(circle.current);// document.getElementById(\"select\").click();\ncanvas.renderAll();// Save the canvas to State variable\nvar _newCanvasState10=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState10);}}if(canvasTool===\"circle\"){if(newShape.current){pointer.current=canvas.getPointer(e);origX.current=pointer.current.x;origY.current=pointer.current.y;circle.current=new fabric.Circle({left:origX.current,top:origY.current,originX:\"left\",originY:\"top\",radius:pointer.current.x-origX.current,angle:0,fill:pickerFill,stroke:pickerStroke,strokeWidth:strokeWidth,padding:15,selectable:false,hoverCursor:\"default\",name:\"shape-circle-\"+shapeCount.current});canvas.add(circle.current);newShape.current=false;shapeCount.current++;}else{pointer.current=canvas.getPointer(e);radius=Math.max(Math.abs(origY.current-pointer.current.y),Math.abs(origX.current-pointer.current.x))/2;if(radius>circle.current.strokeWidth){radius-=circle.current.strokeWidth/2;}radius+=someValue.current;circle.current.set({radius:radius});if(origX.current>pointer.current.x){circle.current.set({originX:\"right\"});}else{circle.current.set({originX:\"left\"});}if(origY.current>pointer.current.y){circle.current.set({originY:\"bottom\"});}else{circle.current.set({originY:\"top\"});}circle.current.set({originX:\"center\",originY:\"center\",left:origX.current+circle.current.radius,top:origY.current+circle.current.radius});newShape.current=true;canvas.setActiveObject(circle.current);//  document.getElementById(\"select\").click();\ncanvas.renderAll();// Save the canvas to State variable\nvar _newCanvasState11=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState11);}}if(canvasTool===\"ellipse\"){if(newShape.current){pointer.current=canvas.getPointer(e);origX.current=pointer.current.x;origY.current=pointer.current.y;ellipse.current=new fabric.Ellipse({left:origX.current,top:origY.current,originX:\"left\",originY:\"top\",rx:pointer.current.x-origX.current,ry:pointer.current.y-origY.current,angle:0,fill:pickerFill,stroke:pickerStroke,strokeWidth:strokeWidth,padding:15,type:\"ellipse\",selectable:false,hoverCursor:\"default\",name:\"shape-ellipse-\"+shapeCount.current});canvas.add(ellipse.current);newShape.current=false;}else{pointer.current=canvas.getPointer(e);var rx=Math.abs(origX.current-pointer.current.x)/2;var ry=Math.abs(origY.current-pointer.current.y)/2;rx+=someValue.current;ry+=someValue.current;if(rx>ellipse.current.strokeWidth){rx-=ellipse.current.strokeWidth/2;}if(ry>ellipse.current.strokeWidth){ry-=ellipse.current.strokeWidth/2;}ellipse.current.set({rx:rx,ry:ry});if(origX.current>pointer.current.x){ellipse.current.set({originX:\"right\"});}else{ellipse.current.set({originX:\"left\"});}if(origY.current>pointer.current.y){ellipse.current.set({originY:\"bottom\"});}else{ellipse.current.set({originY:\"top\"});}ellipse.current.set({originX:\"center\",originY:\"center\",left:origX.current+ellipse.current.rx,top:origY.current+ellipse.current.ry});newShape.current=true;canvas.setActiveObject(ellipse.current);// document.getElementById(\"select\").click();\ncanvas.renderAll();// Save the canvas to State variable\nvar _newCanvasState12=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState12);}}//check if user clicked an object\nif(e.target){evt=e.e;if(evt.altKey===true){if(e.target.name.includes(\"anchor\")){console.log(e.target);var editable=openPoly.current;var newPoints=editable.get(\"points\");console.log(newPoints.length);if(newPoints.length<=3)return;canvas.remove(e.target);var pFill=editable.get(\"fill\");var pStroke=editable.get(\"stroke\");var pName=editable.get(\"name\");var id=e.target.name.split(\"-\");var pointIndex=parseInt(id[2]);var cloneArray=newPoints.slice();cloneArray.splice(pointIndex,1);console.log(newPoints);console.log(cloneArray);//canvas.remove(openPoly.current);\neditable.set({points:cloneArray});console.log(editable);/*\n            var updatedPoly = new fabric.Polyline(cloneArray, {\n              fill: pFill,\n              stroke: pStroke,\n              name: pName,\n              hasControls: false,\n              hasBorders: false,\n              selectable: false,\n              hoverCursor: \"default\",\n            });\n            canvas.add(updatedPoly);\n            canvas.sendToBack(updatedPoly);\n            */canvas.renderAll();//anchors.current = [];\n}}if(!editPoly.current)return;var activeShape=canvas.getActiveObject();//if (activeShape.length > 1) return;\n//        console.log(activeShape.type);\nif(activeShape){console.log(activeShape);// if (activeShape.stroke && activeShape.type !== \"i-text\") {\n//   if (currentStroke.current !== null) {\n//     var rgba = currentStroke.current\n//       .substr(5)\n//       .split(\")\")[0]\n//       .split(\",\");\n//     setStrokeColor({\n//       r: rgba[0],\n//       g: rgba[1],\n//       b: rgba[2],\n//       a: rgba[3],\n//     });\n//     //if()\n//     console.log(activeShape.stroke);\n//     setPickerColor(activeShape.stroke);\n//     currentStroke.current = activeShape.stroke;\n//     // activeObjectStrokeRef.current();\n//     if (activeObjectStrokeRef?.current) {\n//       activeObjectStrokeRef.current(activeShape.stroke);\n//     }\n//   }\n//   setStrokeWidth(activeShape.strokeWidth);\n// } else {\n//   if (activeObjectStrokeRef?.current) {\n//     activeObjectStrokeRef.current(\"nill\");\n//   }\n// }\nif(activeShape.stroke!==null&&activeShape.type!==\"i-text\"){// setPickerColorStroke(activeShape.stroke);\nif(activeObjectStrokeRef===null||activeObjectStrokeRef===void 0?void 0:activeObjectStrokeRef.current){activeObjectStrokeRef.current(activeShape.stroke);}}else{if(activeObjectStrokeRef===null||activeObjectStrokeRef===void 0?void 0:activeObjectStrokeRef.current){activeObjectStrokeRef.current(\"nill\");}}if(activeShape.fill){// setPickerColorFill(activeShape.fill);\nif(activeObjectFillRef===null||activeObjectFillRef===void 0?void 0:activeObjectFillRef.current){activeObjectFillRef.current(activeShape.fill);}}else{if(activeObjectFillRef===null||activeObjectFillRef===void 0?void 0:activeObjectFillRef.current){activeObjectFillRef.current(\"nill\");}// console.log(activeShape.fill);\n// rgba = activeShape.fill.substr(5).split(\")\")[0].split(\",\");\n// setFillColor({ r: rgba[0], g: rgba[1], b: rgba[2], a: rgba[3] });\n}//console.log(activeShape.opacity);\nif(Number.isNaN(activeShape.opacity))setOpacity(100);else setOpacity(activeShape.opacity*100);//setOpacity(activeShape.opacity * 100);\n//setFont(activeShape.fontFamily);\n///setFontSize(activeShape.fontSize);\n//setFontWeight(activeShape.fontWeight);\n//setFontStyle(activeShape.fontStyle);\n}}});canvas.on(\"mouse:wheel\",function(opt){var delta=opt.e.deltaY;var zoom=canvas.getZoom();zoom*=Math.pow(0.999,delta);if(zoom>20)zoom=20;if(zoom<0.01)zoom=0.01;canvas.zoomToPoint({x:opt.e.offsetX,y:opt.e.offsetY},zoom);opt.e.preventDefault();opt.e.stopPropagation();var vpt=this.viewportTransform;if(zoom<400/1000){vpt[4]=200-1000*zoom/2;vpt[5]=200-1000*zoom/2;}else{if(vpt[4]>=0){vpt[4]=0;}else if(vpt[4]<canvas.getWidth()-1000*zoom){vpt[4]=canvas.getWidth()-1000*zoom;}if(vpt[5]>=0){vpt[5]=0;}else if(vpt[5]<canvas.getHeight()-1000*zoom){vpt[5]=canvas.getHeight()-1000*zoom;}}});//object.on\ncanvas.on(\"mouse:down\",function(opt){if(canvasTool!==\"select\"){this.selection=false;}var evt=opt.e;if(opt.button===2){this.isDragging=true;this.selection=false;this.lastPosX=evt.clientX;this.lastPosY=evt.clientY;}// if (opt.button === 3) {\n//   setCanvasTool(\"select\");\n//   setActiveTool(evt, \"select\");\n//   //document.getElementById(\"select\").click();\n//   // canvas.renderAll();\n//   //this.selection = true;\n//   canvasRef.current.click();\n//   //return;\n// }\nif(opt.e.altKey){if(evt.target){var temp,oObjectType;var oObject=canvas.getActiveObject();if(oObject){oObjectType=oObject.get(\"type\");oObject.clone(function(cloned){temp=cloned;});shapeCount.current=shapeCount.current+1;temp.set({hasControls:false,hasBorders:false,name:oObjectType+shapeCount.current});canvas.add(temp);canvas.renderAll();// Save the canvas to State variable\nvar _newCanvasState13=canvas.toJSON([\"name\"]);saveCanvasState(_newCanvasState13);}}}});canvas.on(\"mouse:move\",function(opt){if(this.isDragging){var e=opt.e;var vpt=this.viewportTransform;vpt[4]+=e.clientX-this.lastPosX;vpt[5]+=e.clientY-this.lastPosY;this.requestRenderAll();this.lastPosX=e.clientX;this.lastPosY=e.clientY;}if(newShape.current===true&&canvasTool!==\"pen\"){return;}if(canvasTool===\"rect\"){mouseMoving.current=true;pointer.current=canvas.getPointer(opt);if(origX.current>pointer.current.x){Rectangle.current.set({left:Math.abs(pointer.current.x)});}if(origY.current>pointer.current.y){Rectangle.current.set({top:Math.abs(pointer.current.y)});}Rectangle.current.set({width:Math.abs(origX.current-pointer.current.x)});Rectangle.current.set({height:Math.abs(origY.current-pointer.current.y)});canvas.requestRenderAll();}if(canvasTool===\"line\"){mouseMoving.current=true;pointer.current=canvas.getPointer(opt);if(opt.e.shiftKey){var _determineAdjustedCoo2=determineAdjustedCoords(line.current.x1,line.current.y1,pointer.current.x,pointer.current.y),tx=_determineAdjustedCoo2.tx,ty=_determineAdjustedCoo2.ty;line.current.set({x2:tx,y2:ty});// var deltaX = Math.abs(pointer.current.x - line.current.x1);\n// var deltaY = Math.abs(pointer.current.y - line.current.y1);\n// if (deltaX > deltaY)\n//   line.current.set({ x2: pointer.current.x, y2: line.current.y1 });\n// if (deltaY > deltaX)\n//   line.current.set({ x2: line.current.x1, y2: pointer.current.y });\n}else line.current.set({x2:pointer.current.x,y2:pointer.current.y});canvas.renderAll();}if(canvasTool===\"arrow\"){mouseMoving.current=true;pointer.current=canvas.getPointer(opt);if(opt.e.shiftKey){var _determineAdjustedCoo3=determineAdjustedCoords(line.current.x1,line.current.y1,pointer.current.x,pointer.current.y),tx=_determineAdjustedCoo3.tx,ty=_determineAdjustedCoo3.ty;line.current.set({x2:tx,y2:ty});// var deltaX = Math.abs(pointer.current.x - line.current.x1);\n// var deltaY = Math.abs(pointer.current.y - line.current.y1);\n// if (deltaX > deltaY)\n//   line.current.set({ x2: pointer.current.x, y2: line.current.y1 });\n// if (deltaY > deltaX)\n//   line.current.set({ x2: line.current.x1, y2: pointer.current.y });\n}else line.current.set({x2:pointer.current.x,y2:pointer.current.y});var dx=line.current.x2-line.current.x1,dy=line.current.y2-line.current.y1;angle.current=Math.atan2(dy,dx);angle.current*=180/Math.PI;angle.current+=90;arrow.current.set({top:line.current.y2,left:line.current.x2,angle:angle.current,width:15,height:15});canvas.renderAll();}if(canvasTool===\"polyline\"){if(isDrawing.current){mouseMoving.current=true;var endPoint=canvas.getPointer(opt);var evt=opt.e;if(evt.shiftKey===true){if(Math.abs(endPoint.x-line.current.x1)>Math.abs(endPoint.y-line.current.y1)){console.log(\"line should be horizontally strait\");line.current.set({x2:endPoint.x,y2:line.current.y1});canvas.renderAll();return;}else{console.log(\"line should be vertically strait\");line.current.set({x2:line.current.x1,y2:endPoint.y});canvas.renderAll();return;}}line.current.set({x2:endPoint.x,y2:endPoint.y});canvas.renderAll();}}if(canvasTool===\"polygon\"){if(isDrawing.current){mouseMoving.current=true;endPoint=canvas.getPointer(opt);line.current.set({x2:endPoint.x,y2:endPoint.y});canvas.renderAll();}}if(canvasTool===\"rpolygon\"){mouseMoving.current=true;pointer.current=canvas.getPointer(opt);rpolygon.current.set({points:calcPolygonPoints(8,Math.abs(origX.current-pointer.current.x)/2),left:origX.current,top:origY.current});canvas.renderAll();}if(canvasTool===\"arc\"){mouseMoving.current=true;pointer.current=canvas.getPointer(opt);var radius=Math.max(Math.abs(origY.current-pointer.current.y),Math.abs(origX.current-pointer.current.x))/2;if(radius>circle.current.strokeWidth){radius-=circle.current.strokeWidth/2;}circle.current.set({radius:radius});if(origX.current>pointer.current.x){circle.current.set({originX:\"right\"});circle.current.set({angle:-135});}else{circle.current.set({originX:\"left\"});circle.current.set({angle:135});}if(origY.current>pointer.current.y){circle.current.set({originY:\"bottom\"});}else{circle.current.set({originY:\"top\"});}canvas.renderAll();}if(canvasTool===\"circle\"){mouseMoving.current=true;pointer.current=canvas.getPointer(opt);someValue.current=Math.max(Math.abs(origX.current-pointer.current.x),Math.abs(origY.current-pointer.current.y))/20;radius=Math.max(Math.abs(origX.current-pointer.current.x),Math.abs(origY.current-pointer.current.y))/2;// radius = Math.abs(origX.current - pointer.current.x) / 2;\nradius+=someValue.current;if(radius>circle.current.strokeWidth){radius-=circle.current.strokeWidth/2;}circle.current.set({radius:radius});if(origX.current>pointer.current.x){circle.current.set({originX:\"right\"});}else{circle.current.set({originX:\"left\"});}if(origY.current>pointer.current.y){circle.current.set({originY:\"bottom\"});}else{circle.current.set({originY:\"top\"});}canvas.renderAll();}if(canvasTool===\"ellipse\"){mouseMoving.current=true;pointer.current=canvas.getPointer(opt);var rx=Math.abs(origX.current-pointer.current.x)/2;var ry=Math.abs(origY.current-pointer.current.y)/2;someValue.current=Math.max(Math.abs(origX.current-pointer.current.x),Math.abs(origY.current-pointer.current.y))/20;rx+=someValue.current;ry+=someValue.current;if(rx>ellipse.current.strokeWidth){rx-=ellipse.current.strokeWidth/2;}if(ry>ellipse.current.strokeWidth){ry-=ellipse.current.strokeWidth/2;}ellipse.current.set({rx:rx,ry:ry});if(origX.current>pointer.current.x){ellipse.current.set({originX:\"right\"});}else{ellipse.current.set({originX:\"left\"});}if(origY.current>pointer.current.y){ellipse.current.set({originY:\"bottom\"});}else{ellipse.current.set({originY:\"top\"});}canvas.renderAll();}});canvas.on(\"mouse:over\",function(e){/*\n      if (e.target) {\n        //console.log(currentStroke.current);\n        currentStroke.current = e.target.get(\"stroke\");\n        //console.log(currentStroke.current);\n        e.target.set(\"stroke\", \"rgba(255,0,0,1)\");\n        canvas.renderAll();\n      }\n      */});canvas.on(\"mouse:out\",function(e){/*\n      if (e.target) {\n        e.target.set(\"stroke\", currentStroke.current);\n        canvas.renderAll();\n      }\n      */});setCanvas(canvas);return function(){canvas.dispose();window.removeEventListener(\"resize\",handleResize);};},[canvasRef,canvasTool,setCanvas]);//const onUndo = useCallback(() => moveHistory(-1), [moveHistory]);\nvar onUndo=function onUndo(){var present=past.pop();var newFuture=[present].concat(_toConsumableArray(future));setFuture(newFuture);var previous=past[past.length-1];canvas.loadFromJSON(previous);setPast(past);console.log(past);};// const onRedo = useCallback(() => moveHistory(1), [moveHistory]);\nvar onRedo=function onRedo(){var next=future[0];canvas.loadFromJSON(next);var newFuture=future.slice(1);past.push(next);setPast(past);setFuture(newFuture);console.log(future);};var setShapeAttributes=function setShapeAttributes(attributes){if(canvas===undefined)return;var activeShape=canvas.getActiveObject();if(activeShape){var Attributes=attributes||{};if(activeShape.type===\"group\"){activeShape.item(0).set({stroke:Attributes.stroke||activeShape.item(1).stroke,strokeWidth:Attributes.strokeWidth||activeShape.item(1).strokeWidth});activeShape.item(1).set({stroke:Attributes.stroke||activeShape.item(1).stroke,strokeWidth:Attributes.strokeWidth||activeShape.item(1).strokeWidth,fill:Attributes.fill||activeShape.item(1).fill});}activeShape.set({strokeWidth:Attributes.strokeWidth||activeShape.strokeWidth,stroke:Attributes.stroke===\"nill\"?null:Attributes.stroke||activeShape.stroke,fill:Attributes.fill===\"nill\"?null:Attributes.fill||activeShape.fill,opacity:Attributes.opacity/100||activeShape.opacity,strokeDashArray:Attributes.strokeDashArray||activeShape.strokeDashArray,fontFamily:Attributes.fontFamily||activeShape.fontFamily,fontSize:Attributes.fontSize||activeShape.fontSize,fontWeight:Attributes.fontWeight||activeShape.fontWeight,fontStyle:Attributes.fontStyle||activeShape.fontStyle,textBackgroundColor:Attributes.textBackgroundColor||activeShape.textBackgroundColor});canvas.renderAll();canvas.setActiveObject(activeShape);var newCanvasState=canvas.toJSON([\"name\"]);saveCanvasState(newCanvasState);}};function deleteObjects(){if(canvas.getActiveObjects().length===0){// window.location.reload();\nreturn;}canvas.getActiveObjects().forEach(function(obj){canvas.remove(obj);});}/*\n  var simulateMouseEvent = function (element, eventName, coordX, coordY) {\n    element.dispatchEvent(\n      new MouseEvent(eventName, {\n        view: window,\n        bubbles: true,\n        cancelable: true,\n        clientX: coordX,\n        clientY: coordY,\n        button: 0,\n      })\n    );\n  };\n\n  \n  function hexToRGB(hex, alpha) {\n    var r = parseInt(hex.slice(1, 3), 16),\n      g = parseInt(hex.slice(3, 5), 16),\n      b = parseInt(hex.slice(5, 7), 16);\n    if (alpha) {\n      return \"rgba(\" + r + \", \" + g + \", \" + b + \", \" + alpha + \")\";\n    } else {\n      return \"rgb(\" + r + \", \" + g + \", \" + b + \")\";\n    }\n  }\n*/function w3_openPanel(evt,panelId){if(currentOpenPanel!==panelId){document.getElementById(\"Library\").style.height=\"400px\";document.getElementById(panelId).style.display=\"block\";if(currentOpenPanel!==\"none\")document.getElementById(currentOpenPanel).style.display=\"none\";currentOpenPanel=panelId;return;}if(currentOpenPanel===panelId){if(panelId===\"none\")return;document.getElementById(panelId).style.display=\"none\";currentOpenPanel=\"none\";document.getElementById(\"Library\").style.height=\"0px\";}/*\n    else {\n      if (currentOpenPanel !== \"None\") {\n        document.getElementById(currentOpenPanel).style.display = \"none\";\n      }\n      document.getElementById(\"Library\").style.height = \"400px\";\n      document.getElementById(panelId).style.display = \"block\";\n      currentOpenPanel = panelId;\n    }\n    */}var setActiveTool=function setActiveTool(e,id){if(currentToolId.current!==null){//console.log(currentToolId);\ndocument.getElementById(currentToolId.current).style.backgroundColor=\"#003059\";document.getElementById(id).style.backgroundColor=\"grey\";currentToolId.current=id;return;}else{//console.log(id);\ndocument.getElementById(id).style.backgroundColor=\"grey\";currentToolId.current=id;}};function handleKeyDown(event){if(mouseMoving.current===false){if(event.key===\"Escape\"){setCanvasTool(\"select\");setActiveTool(event,\"select\");return;}if(event.key===\"s\"){setCanvasTool(\"select\");setActiveTool(event,\"select\");return;}if(event.key===\"r\"){setCanvasTool(\"rect\");setActiveTool(event,\"rect\");return;}if(event.key===\"l\"){setCanvasTool(\"line\");setActiveTool(event,\"line\");return;}if(event.key===\"a\"){setCanvasTool(\"arrow\");setActiveTool(event,\"arrow\");return;}if(event.key===\"c\"){setCanvasTool(\"circle\");setActiveTool(event,\"circle\");return;}if(event.key===\"e\"){setCanvasTool(\"ellipse\");setActiveTool(event,\"ellipse\");return;}if(event.key===\"t\"){setCanvasTool(\"text\");setActiveTool(event,\"text\");return;}if(event.key===\"p\"){setCanvasTool(\"pen\");setActiveTool(event,\"pen\");return;}if(event.key===\"Delete\"){deleteObjects();return;}if(event.ctrlKey&&event.key===\"z\"){if(past.length===1)return;onUndo();return;}if(event.ctrlKey&&event.key===\"y\"){if(future.length===0)return;onRedo();return;}}if(mouseMoving.current===true){mouseMoving.current=false;if(event.key===\"Escape\"){if(canvasTool===\"rect\"){canvas.remove(Rectangle.current);newShape.current=true;shapeCount.current--;return;}if(canvasTool===\"line\"){canvas.remove(line.current);newShape.current=true;shapeCount.current--;return;}if(canvasTool===\"arrow\"){canvas.remove(line.current);canvas.remove(arrow.current);newShape.current=true;return;}if(canvasTool===\"polyline\"){canvas.remove(line.current);//canvas.remove(polyLine.current);\nnewShape.current=true;return;}if(canvasTool===\"polygon\"){canvas.remove(line.current);newShape.current=true;return;}if(canvasTool===\"rpolygon\"){canvas.remove(rpolygon.current);newShape.current=true;shapeCount.current--;return;}if(canvasTool===\"arc\"){canvas.remove(circle.current);newShape.current=true;shapeCount.current--;return;}if(canvasTool===\"circle\"){canvas.remove(circle.current);newShape.current=true;shapeCount.current--;return;}if(canvasTool===\"ellipse\"){canvas.remove(ellipse.current);newShape.current=true;shapeCount.current--;return;}}//setActiveTool(event, \"select\");\n}}var url=\"#\";var swatchStyles=reactCSS({default:{stroke:{width:\"36px\",height:\"14px\",borderRadius:\"2px\",background:\"rgba(\".concat(stroke.r,\", \").concat(stroke.g,\", \").concat(stroke.b,\", \").concat(stroke.a,\")\")},blank:{width:\"36px\",height:\"14px\",borderRadius:\"2px\"},fill:{width:\"36px\",height:\"14px\",borderRadius:\"2px\",background:\"rgba(\".concat(fill.r,\", \").concat(fill.g,\", \").concat(fill.b,\", \").concat(fill.a,\")\")},highlight:{width:\"36px\",height:\"14px\",borderRadius:\"2px\",background:\"rgba(\".concat(textHighlight.r,\", \").concat(textHighlight.g,\", \").concat(textHighlight.b,\", \").concat(textHighlight.a,\")\")},swatch:{padding:\"0px\",background:\"#fff\",borderRadius:\"1px\",boxShadow:\"0 0 0 1px rgba(0,0,0,.1)\",display:\"inline-block\",cursor:\"pointer\",backgroundImage:\"url(images/no.png)\"},pickerContainer:{display:\"inline-block\"},popover:{position:\"absolute\",zIndex:\"2\"},cover:{position:\"fixed\",top:\"50px\",right:\"0px\",bottom:\"0px\",left:\"100px\"}}});return/*#__PURE__*/_jsx(MediaQuery,{minDeviceWidth:1224,children:/*#__PURE__*/_jsxs(\"div\",{ref:mainDiv,className:\"App\",id:\"mainDiv\",onKeyDown:function onKeyDown(e){handleKeyDown(e);document.getElementById(\"my-fabric-canvas\").focus();},tabIndex:-1// tabIndex=\"0\"\n,children:[/*#__PURE__*/_jsxs(\"div\",{className:tbStyles.propBar,children:[/*#__PURE__*/_jsxs(\"a\",{href:url,children:[/*#__PURE__*/_jsx(\"button\",{className:tbStyles.buttontoolbar,onClick:onUndo,id:\"undo\"//disabled={canvasHistory[0] === canvasState}\n,disabled:past.length===1,children:/*#__PURE__*/_jsxs(\"div\",{className:tbStyles.tooltipDown,children:[/*#__PURE__*/_jsx(\"img\",{src:imgUndo,alt:\"Undo\"}),/*#__PURE__*/_jsx(\"span\",{className:tbStyles.tooltiptextDown,children:\"Undo\"})]})}),/*#__PURE__*/_jsx(\"button\",{className:tbStyles.buttontoolbar,onClick:onRedo,id:\"redo\"//disabled={canvasHistory[canvasHistory.length - 1] === canvasState}\n,disabled:future.length===0,children:/*#__PURE__*/_jsxs(\"div\",{className:tbStyles.tooltipDown,children:[/*#__PURE__*/_jsx(\"img\",{src:imgRedo,alt:\"Redo\"}),/*#__PURE__*/_jsx(\"span\",{className:tbStyles.tooltiptextDown,children:\"Redo\"})]})}),/*#__PURE__*/_jsx(\"button\",{className:tbStyles.buttontoolbar,onClick:deleteObjects,id:\"del\",children:/*#__PURE__*/_jsxs(\"div\",{className:tbStyles.tooltipDown,children:[/*#__PURE__*/_jsx(\"img\",{src:imgDelete,alt:\"Delete\"}),/*#__PURE__*/_jsx(\"span\",{className:tbStyles.tooltiptextDown,children:\"Delete\"})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:tbStyles.dropdown,children:/*#__PURE__*/_jsxs(\"button\",{className:tbStyles.buttontoolbar,id:\"wList\",children:[/*#__PURE__*/_jsx(\"img\",{src:imglineWidth,alt:\"Line Width\"}),/*#__PURE__*/_jsxs(\"div\",{id:\"wlDropDown\",className:tbStyles.dropdowncontent,children:[/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setStrokeWidth(1);setShapeAttributes({strokeWidth:1});},children:/*#__PURE__*/_jsx(\"img\",{src:imgStroke1,alt:\"1\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setStrokeWidth(2);setShapeAttributes({strokeWidth:2});},children:/*#__PURE__*/_jsx(\"img\",{src:imgStroke2,alt:\"2\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setStrokeWidth(4);setShapeAttributes({strokeWidth:4});},children:/*#__PURE__*/_jsx(\"img\",{src:imgStroke4,alt:\"4\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setStrokeWidth(5);setShapeAttributes({strokeWidth:5});},children:/*#__PURE__*/_jsx(\"img\",{src:imgStroke5,alt:\"5\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setStrokeWidth(10);setShapeAttributes({strokeWidth:10});},children:/*#__PURE__*/_jsx(\"img\",{src:imgStroke10,alt:\"10\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setStrokeWidth(12);setShapeAttributes({strokeWidth:12});},children:/*#__PURE__*/_jsx(\"img\",{src:imgStroke12,alt:\"12\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setStrokeWidth(15);setShapeAttributes({strokeWidth:15});},children:/*#__PURE__*/_jsx(\"img\",{src:imgStroke15,alt:\"15\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setStrokeWidth(20);setShapeAttributes({strokeWidth:20});},children:/*#__PURE__*/_jsx(\"img\",{src:imgStroke20,alt:\"20\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setStrokeWidth(25);setShapeAttributes({strokeWidth:25});},children:/*#__PURE__*/_jsx(\"img\",{src:imgStroke25,alt:\"25\"})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:tbStyles.dropdown,children:/*#__PURE__*/_jsxs(\"button\",{className:tbStyles.buttontoolbar,id:\"sList\",children:[/*#__PURE__*/_jsx(\"img\",{src:imgLineStyle,alt:\"Line Style\"}),/*#__PURE__*/_jsxs(\"div\",{id:\"lsDropDown\",className:tbStyles.dropdowncontent,children:[/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setDashSize(0);setGapSize(0);setShapeAttributes({strokeDashArray:[0,0]});},children:/*#__PURE__*/_jsx(\"img\",{src:imgLineStyle1,alt:\"1\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setDashSize(10);setGapSize(5);setShapeAttributes({strokeDashArray:[10,5]});},children:/*#__PURE__*/_jsx(\"img\",{src:imgLineStyle2,alt:\"1\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setDashSize(10);setGapSize(5);setShapeAttributes({strokeDashArray:[10,5]});},children:/*#__PURE__*/_jsx(\"img\",{src:imgLineStyle3,alt:\"1\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setDashSize(20);setGapSize(5);setShapeAttributes({strokeDashArray:[20,5]});},children:/*#__PURE__*/_jsx(\"img\",{src:imgLineStyle4,alt:\"1\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setDashSize(20);setGapSize(10);setShapeAttributes({strokeDashArray:[20,10]});},children:/*#__PURE__*/_jsx(\"img\",{src:imgLineStyle5,alt:\"1\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setDashSize(5);setGapSize(5);setShapeAttributes({strokeDashArray:[5,5]});},children:/*#__PURE__*/_jsx(\"img\",{src:imgLineStyle6,alt:\"1\"})}),/*#__PURE__*/_jsx(\"a\",{href:url,onClick:function onClick(e){setDashSize(2);setGapSize(2);setShapeAttributes({strokeDashArray:[2,2]});},children:/*#__PURE__*/_jsx(\"img\",{src:imgLineStyle7,alt:\"1\"})})]})]})}),/*#__PURE__*/_jsx(\"button\",{className:tbStyles.buttontoolbar,id:\"dropper\",children:/*#__PURE__*/_jsxs(\"div\",{className:tbStyles.tooltipDown,children:[/*#__PURE__*/_jsx(\"img\",{src:imgDropper,alt:\"Pick a color\"}),/*#__PURE__*/_jsx(\"span\",{className:tbStyles.tooltiptextDown,children:\"Pick a color\"})]})}),\"\\xA0Stroke\\xA0\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"strokePoint\",value:strokeWidth,min:\"0\",max:\"50\",onChange:function onChange(e){setStrokeWidth(+e.target.value);setShapeAttributes({strokeWidth:+e.target.value});}}),\"\\xA0Dash\\xA0\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"0\",max:\"20\",id:\"dashSize\",value:dashSize,onChange:function onChange(e){setDashSize(+e.target.value);setShapeAttributes({strokeDashArray:[+e.target.value,+e.target.value]});}}),\"\\xA0Stroke Color\\xA0\",/*#__PURE__*/_jsx(\"div\",{style:swatchStyles.pickerContainer,children:/*#__PURE__*/_jsx(Picker,{setPickerColor:setPickerColorStroke,type:\"Stroke\",ref:activeObjectStrokeRef})}),\"\\xA0Fill Color\\xA0\",/*#__PURE__*/_jsx(\"div\",{style:swatchStyles.pickerContainer,children:/*#__PURE__*/_jsx(Picker,{setPickerColor:setPickerColorFill,type:\"Fill\",ref:activeObjectFillRef})}),\"\\xA0Opacity\",/*#__PURE__*/_jsx(\"input\",{type:\"range\",id:\"opacityRange\",value:opacity,onChange:function onChange(e){//opacity.current = e.target.value;\nsetOpacity(e.target.value);setShapeAttributes({opacity:e.target.value});}}),\"\\xA0 Angle snap:\",/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"chkSnap\",onChange:function onChange(e){//console.log(e.target.checked);\nsnap.current=e.target.checked;}}),\"\\xA0Font\",/*#__PURE__*/_jsx(\"select\",{name:\"fonts\",id:\"fonts\",onChange:function onChange(e){setFont(e.target.value);setShapeAttributes({fontFamily:e.target.value});}}),\"\\xA0Size\",/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"fontSize\",value:fontSize,min:\"0\",max:\"100\",onChange:function onChange(e){setFontSize(+e.target.value);setShapeAttributes({fontSize:+e.target.value});}}),\"\\xA0\",/*#__PURE__*/_jsxs(\"label\",{children:[\"FontWeight:\",/*#__PURE__*/_jsxs(\"select\",{value:fontWeight,onChange:function onChange(e){setFontWeight(e.target.value);setShapeAttributes({fontWeight:e.target.value});},children:[/*#__PURE__*/_jsx(\"option\",{value:\"normal\",children:\"Normal\"}),/*#__PURE__*/_jsx(\"option\",{value:\"bold\",children:\"Bold\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{children:[\"FontSyle:\",/*#__PURE__*/_jsxs(\"select\",{value:fontStyle,onChange:function onChange(e){setFontStyle(e.target.value);setShapeAttributes({fontStyle:e.target.value});},children:[/*#__PURE__*/_jsx(\"option\",{value:\"regular\",children:\"Regular\"}),/*#__PURE__*/_jsx(\"option\",{value:\"italic\",children:\"Italic\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{id:\"lMenu\",className:styles.menu,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tableft,children:[/*#__PURE__*/_jsx(\"button\",{onMouseEnter:function onMouseEnter(e){w3_openPanel(e,\"File\");},onClick:function onClick(e){w3_openPanel(e,currentOpenPanel);},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgFileAccess,alt:\"FileAccess\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextleft,children:\"File Access\"})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){w3_openPanel(e,currentOpenPanel);},onMouseEnter:function onMouseEnter(e){w3_openPanel(e,\"CanvasSet\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgCanvasSettings,alt:\"Canvas Settings\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextleft,children:\"Canvas Settings\"})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){w3_openPanel(e,currentOpenPanel);},onMouseEnter:function onMouseEnter(e){w3_openPanel(e,\"LayerSet\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgLayers,alt:\"Layers\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextleft,children:\"Layers\"})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){w3_openPanel(e,currentOpenPanel);},onMouseEnter:function onMouseEnter(e){w3_openPanel(e,\"Warehouse\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgWarehouse,alt:\"Warehouse\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextleft,children:\"Warehouse\"})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){w3_openPanel(e,currentOpenPanel);},onMouseEnter:function onMouseEnter(e){w3_openPanel(e,\"Phases\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgPhase,alt:\"Phases\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextleft,children:\"Phases\"})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){w3_openPanel(e,currentOpenPanel);},onMouseEnter:function onMouseEnter(e){w3_openPanel(e,\"Measures\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgMeasurement,alt:\"Measurements\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextleft,children:\"Measures\"})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){w3_openPanel(e,currentOpenPanel);},onMouseEnter:function onMouseEnter(e){w3_openPanel(e,\"Animation\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgAnimation,alt:\"Animation\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextleft,children:\"Phase Player\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:styles.tabbar})]})}),/*#__PURE__*/_jsxs(\"div\",{id:\"Library\",className:styles.library,onClick:function onClick(e){//document.getElementById(\"File\").style.display = \"none\";\nw3_openPanel(e,currentOpenPanel);},children:[/*#__PURE__*/_jsxs(\"div\",{id:\"File\",className:styles.File,style:{display:\"none\"},children:[\"File Access\",/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){//document.getElementById(\"File\").style.display = \"none\";\nw3_openPanel(e,currentOpenPanel);},className:tbStyles.close,title:\"Close Modal\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.btngroup,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgNewFile,alt:\"NewFile\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"New File\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgOpenFile,alt:\"OpenFile\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Open File\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgRecentFile,alt:\"RecentFile\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Recent File\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"CanvasSet\",className:styles.CanvasSet,style:{display:\"none\"},children:[\"Canvas Settings\",/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){//document.getElementById(\"File\").style.display = \"none\";\nw3_openPanel(e,currentOpenPanel);},className:tbStyles.close,title:\"Close Modal\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.btngroup,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgCanvasSize,alt:\"CanvasSize\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Canvas Size\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgCanvasColor,alt:\"CanvasColor\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Canvas Color\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgCanvasImage,alt:\"CanvasImage\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Canvas Image\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"LayerSet\",className:styles.LayerSet,style:{display:\"none\"},children:[\"Layers\",/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){//document.getElementById(\"File\").style.display = \"none\";\nw3_openPanel(e,currentOpenPanel);},className:tbStyles.close,title:\"Close Modal\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.sbtngroup,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgLayerBefore,alt:\"AddLayerBefore\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Add Layer Before\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgLayerAfter,alt:\"AddLayerAfter\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Add Layer After\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgLayerUp,alt:\"LayerUp\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Layer Up\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgLayerDown,alt:\"LayerDown\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Layer Down\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgLayerHide,alt:\"HideLayer\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Hide Layer\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgLayerLock,alt:\"LockLayer\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Lock Layer\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgLayerSort,alt:\"SortLayer\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Sort layer\"})]})]}),/*#__PURE__*/_jsxs(\"ul\",{className:styles.a,children:[/*#__PURE__*/_jsx(\"li\",{children:\"Shapes\"}),/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:\"Circle\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Rectangle\"})]}),/*#__PURE__*/_jsx(\"li\",{children:\"Texts\"}),/*#__PURE__*/_jsx(\"li\",{children:\"Lines\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"Warehouse\",className:styles.Warehouse,style:{display:\"none\"},children:[\"Warehouse\",/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){//document.getElementById(\"File\").style.display = \"none\";\nw3_openPanel(e,currentOpenPanel);},className:tbStyles.close,title:\"Close Modal\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.btngroup,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgCrane,alt:\"Crane\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Crane\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgElevator,alt:\"Elevator\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Elevator\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgLabels,alt:\"Labels\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Labels\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgCloud2,alt:\"Cloud\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Cloud\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgCallout,alt:\"Callout\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Callout\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgWedge,alt:\"Wedge\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Wedge\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgRing,alt:\"Ring\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Ring\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgFilledArc,alt:\"FilledArc\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Filled Arc\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"Phases\",className:styles.Phases,style:{display:\"none\"},children:[\"Phases\",/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){//document.getElementById(\"File\").style.display = \"none\";\nw3_openPanel(e,currentOpenPanel);},className:tbStyles.close,title:\"Close Modal\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.btngroup,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgNewPhase,alt:\"NewPhase\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"NewPhase\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgPhaseStart,alt:\"StartDate\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Start Date\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgPhaseEnd,alt:\"EndDate\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"End Date\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgPhaseDelete,alt:\"DeletePhase\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Delete Phase \"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"Measures\",className:styles.Measures,style:{display:\"none\"},children:[\"Measurement\",/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){//document.getElementById(\"File\").style.display = \"none\";\nw3_openPanel(e,currentOpenPanel);},className:tbStyles.close,title:\"Close Modal\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.btngroup,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgPageScale,alt:\"PageScale\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Page Scale\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgSetUnits,alt:\"SetUnits\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Set Units\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgLength,alt:\"Length\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Length\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgPerimeter,alt:\"Perimeter\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Perimeter\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgArea,alt:\"Area\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Area\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{id:\"Animation\",className:styles.Animation,style:{display:\"none\"},children:[\"Phase Player\",/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(e){//document.getElementById(\"File\").style.display = \"none\";\nw3_openPanel(e,currentOpenPanel);},className:tbStyles.close,title:\"Close Modal\",children:\"\\xD7\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.sbtngroup,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:\"Phase1\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Play\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:\"Phase2\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Play\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:\"Phase3\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Play\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.sbtngroup,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:/*#__PURE__*/_jsx(\"img\",{src:imgPlay,alt:\"Play\"})}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"Play/Stop\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"1\",max:\"100\"}),\"Play Speed\",/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:\"1\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"1 Day/Second\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:\"2\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"2 Day/Second\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:\"5\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"5 Day/Second\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:\"10\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"10 Day/Second\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"button\",{children:\"30\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptextB,children:\"30 Day/Second\"})]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.right,ref:rightBar,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tab,children:[/*#__PURE__*/_jsx(\"button\",{id:\"select\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=true;setCanvasTool(\"select\");setActiveTool(e,\"select\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgSelection,alt:\"Select\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Selection [S]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"text\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"text\");setActiveTool(e,\"text\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgText,alt:\"TextBox\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Text [T]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"pen\",onClick:function onClick(e){setCanvasTool(\"pen\");canvas.isDrawingMode=1;if(stroke.a===0)setStrokeColor({r:0,g:0,b:0,a:1});canvas.freeDrawingBrush.color=stroke;canvas.freeDrawingBrush.width=strokeWidth;setActiveTool(e,\"pen\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgFreeHand,alt:\"Pen\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Free-hand [H]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"cloud\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"cloud\");setActiveTool(e,\"cloud\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgCloud,alt:\"Cloud\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Cloud\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"callout\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"callout\");setActiveTool(e,\"callout\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgCallout,alt:\"Callout\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Callout\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"image\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"image\");setActiveTool(e,\"image\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgImageEdit,alt:\"Edit\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Image Edit [I]\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:styles.tabspace}),/*#__PURE__*/_jsx(\"button\",{id:\"line\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;editPoly.current=true;setCanvasTool(\"line\");setActiveTool(e,\"line\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgLine,alt:\"Line\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Line [L]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"polyline\",onClick:function onClick(e){canvas.isDrawingMode=false;setCanvasTool(\"polyline\");setActiveTool(e,\"polyline\");canvas.selection=false;var objects=canvas.getObjects();for(var i=0;i<objects.length;i++){objects[i].set({selectable:false,evented:false});}},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgPolyline,alt:\"Polyline\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Polyline [P]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"arrow\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"arrow\");setActiveTool(e,\"arrow\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgArrow,alt:\"Arrow\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Arrow [A]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"arc\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"arc\");setActiveTool(e,\"arc\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgArc,alt:\"Arc\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Arc [Q]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"rect\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;canvas.selection=false;canvas.forEachObject(function(o){o.selectable=false;});canvas.renderAll();setCanvasTool(\"rect\");setActiveTool(e,\"rect\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgRect,alt:\"Rectangle\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Rectangle [R]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"polygon\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"polygon\");setActiveTool(e,\"polygon\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgPolygon,alt:\"Polygon\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Polygon [G]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"rpolygon\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"rpolygon\");setActiveTool(e,\"rpolygon\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgRPolygon,alt:\"Regular Polygon\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Regular Polygon [U]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"circle\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"circle\");setActiveTool(e,\"circle\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgCircle,alt:\"Circle\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Circle [C]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"ellipse\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"ellipse\");setActiveTool(e,\"ellipse\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgEllipse,alt:\"Ellipse\"}),/*#__PURE__*/_jsxs(\"span\",{className:styles.tooltiptext,children:[\"Ellipse \",\"  \",\" [E]\"]})]})}),/*#__PURE__*/_jsx(\"div\",{className:styles.tabspace}),/*#__PURE__*/_jsx(\"button\",{id:\"dimension\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"dimension\");setActiveTool(e,\"dimension\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgDimension,alt:\"Dimension\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Dimension [D]\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"area\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"area\");setActiveTool(e,\"area\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgArea,alt:\"Area\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Area\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"length\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"length\");setActiveTool(e,\"length\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgLength,alt:\"Length\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Length\"})]})}),/*#__PURE__*/_jsx(\"button\",{id:\"perimeter\",onClick:function onClick(e){canvas.isDrawingMode=false;canvas.selection=false;setCanvasTool(\"perimeter\");setActiveTool(e,\"perimeter\");},children:/*#__PURE__*/_jsxs(\"div\",{className:styles.tooltip,children:[/*#__PURE__*/_jsx(\"img\",{src:imgPerimeter,alt:\"Perimeter\"}),/*#__PURE__*/_jsx(\"span\",{className:styles.tooltiptext,children:\"Perimeter\"})]})})]})}),/*#__PURE__*/_jsx(\"div\",{ref:containerRef,children:/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,id:\"my-fabric-canvas\",width:isBigScreen?1191:isDesktopOrLaptop?1086:isTabletOrMobile?960:640,height:isBigScreen?842:isDesktopOrLaptop?768:isTabletOrMobile?540:320})})]})});};export default App;","map":{"version":3,"sources":["C:/Tutorials/elp-app/src/App.js"],"names":["React","useRef","useState","fabric","SketchPicker","Picker","MediaQuery","useMediaQuery","reactCSS","imgUndo","imgRedo","imgDelete","imglineWidth","imgStroke1","imgStroke2","imgStroke4","imgStroke5","imgStroke10","imgStroke12","imgStroke15","imgStroke20","imgStroke25","imgLineStyle","imgLineStyle1","imgLineStyle2","imgLineStyle3","imgLineStyle4","imgLineStyle5","imgLineStyle6","imgLineStyle7","imgText","imgFreeHand","imgSelection","imgCloud","imgCallout","imgImageEdit","imgLine","imgPolyline","imgArrow","imgArc","imgRect","imgPolygon","imgRPolygon","imgCircle","imgEllipse","imgDimension","imgArea","imgLength","imgPerimeter","imgDropper","imgNoStroke","imgNoFill","imgFileAccess","imgNewFile","imgOpenFile","imgRecentFile","imgCanvasSettings","imgCanvasSize","imgCanvasColor","imgCanvasImage","imgLayers","imgLayerBefore","imgLayerAfter","imgLayerUp","imgLayerDown","imgLayerHide","imgLayerLock","imgLayerSort","imgWarehouse","imgCrane","imgElevator","imgLabels","imgCloud2","imgWedge","imgRing","imgFilledArc","imgPhase","imgNewPhase","imgPhaseStart","imgPhaseEnd","imgPhaseDelete","imgMeasurement","imgPageScale","imgSetUnits","imgAnimation","imgPlay","styles","tbStyles","styled","Backdrop","div","attrs","p","style","zIndex","display","show","background","backdrop","initialState","version","objects","type","originX","originY","left","top","width","height","fill","stroke","strokeWidth","strokeDashArray","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","scaleX","scaleY","angle","flipX","flipY","opacity","shadow","visible","clipTo","backgroundColor","fillRule","paintFirst","globalCompositeOperation","transformMatrix","skewX","skewY","rx","ry","name","fontCheck","Set","sort","getWindowDimensions","window","innerWidth","innerHeight","determineAdjustedCoords","fromX","fromY","toX","toY","xLen","yLen","theta","Math","atan","PI","hyp","sin","sector","round","thetaNew","xNew","cos","yNew","px","py","tx","ty","App","isDesktopOrLaptop","query","isBigScreen","isTabletOrMobile","isPortrait","isRetina","past","setPast","future","setFuture","windowDimensions","setWindowDimensions","pageLoad","setPageLoad","mouseMoving","canvasRef","containerRef","mainDiv","rightBar","shapeCount","isDrawing","currentStroke","editPoly","openPoly","polyType","someValue","activeObjectStrokeRef","activeObjectFillRef","canvas","setCanvas","pickerStroke","setPickerColorStroke","pickerFill","setPickerColorFill","canvasTool","setCanvasTool","setStrokeWidth","r","g","b","a","setStrokeColor","setFillColor","textHighlight","setHighlight","dashSize","setDashSize","gapSize","setGapSize","setOpacity","font","setFont","fontSize","setFontSize","fontWeight","setFontWeight","fontStyle","setFontStyle","showStrokePicker","setShowStrokePicker","showFillPicker","setShowFillPicker","showHighlightPicker","setShowHighlightPicker","snap","newShape","anchors","pointer","line","origX","origY","arrow","selectedShape","polyPoints","rpolygon","Rectangle","circle","ellipse","polyLine","polyLines","currentToolId","currentOpenPanel","drawingObject","border","StrokeSwatchClick","activeShape","getActiveObject","setShapeAttributes","FillSwatchClick","HighlightSwatchClick","StrokeSwatchClose","FillSwatchClose","HighlightSwatchClose","StrokeSwatchChange","color","rgb","FillSwatchChange","HighlightSwatchChange","textBackgroundColor","calcPolygonPoints","sideCount","radius","sweep","cx","cy","points","i","x","y","push","saveCanvasState","newCanvasState","sessionStorage","clear","myFabricJSCanvas","JSON","stringify","useEffect","undefined","fontAvailable","values","document","fonts","check","add","getElementById","option","createElement","text","Canvas","current","set","fireRightClick","fireMiddleClick","stopContextMenu","controlsAboveOverlay","targetFindTolerance","preserveObjectStacking","perPixelTargetFind","data","parse","loadFromJSON","forEachObject","o","includes","remove","json","toJSON","length","renderAll","handleResize","ratio","getWidth","getHeight","containerWidth","clientWidth","containerHeight","clientHeight","scale","zoom","getZoom","setDimensions","setViewportTransform","addEventListener","isDrawingMode","freeDrawingBrush","selection","defaultCursor","selectable","hoverCursor","allObjects","getObjects","lastObjectCreated","setActiveObject","on","options","target","locked","ceil","abs","e","polyGon","Polygon","Polyline","console","log","editable","hasControls","hasBorders","str","get","id","split","matrix","calcTransformMatrix","transformedPoints","map","Point","pathOffset","util","transformPoint","pFill","pStroke","pName","updatedPoly","sendToBack","forEach","index","anchor","Circle","pname","object","getCenterPoint","pPoints","viewportTransform","isDragging","button","path","getPointer","IText","fontFamily","Line","padding","shiftKey","x1","y1","x2","y2","arrowLinePoints","dx","dy","atan2","Triangle","Group","lockMovementX","lockMovementY","startPoint","endPoint","evt","pop","newPolyLine","distance","sqrt","pow","confirm","objectCaching","Rect","centeredScaling","startAngle","endAngle","max","Ellipse","altKey","newPoints","pointIndex","parseInt","cloneArray","slice","splice","Number","isNaN","opt","delta","deltaY","zoomToPoint","offsetX","offsetY","preventDefault","stopPropagation","vpt","lastPosX","clientX","lastPosY","clientY","temp","oObjectType","oObject","clone","cloned","requestRenderAll","dispose","removeEventListener","onUndo","present","newFuture","previous","onRedo","next","attributes","Attributes","item","deleteObjects","getActiveObjects","obj","w3_openPanel","panelId","setActiveTool","handleKeyDown","event","key","ctrlKey","url","swatchStyles","default","borderRadius","blank","highlight","swatch","boxShadow","cursor","backgroundImage","pickerContainer","popover","position","cover","right","bottom","focus","propBar","buttontoolbar","tooltipDown","tooltiptextDown","dropdown","dropdowncontent","value","checked","menu","tableft","tooltip","tooltiptextleft","tabbar","library","File","close","btngroup","tooltiptextB","CanvasSet","LayerSet","sbtngroup","Warehouse","Phases","Measures","Animation","tab","tooltiptext","tabspace","evented"],"mappings":"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","sourcesContent":["import React, { useRef, useState } from \"react\";\nimport { fabric } from \"fabric\";\nimport { SketchPicker } from \"react-color\";\nimport Picker from \"../src/components/Picker/Picker\";\nimport MediaQuery from \"react-responsive\";\nimport { useMediaQuery } from \"react-responsive\";\nimport reactCSS from \"reactcss\";\n\nimport imgUndo from \"./images/undo2.png\";\nimport imgRedo from \"./images/redo2.png\";\nimport imgDelete from \"./images/delete2.png\";\nimport imglineWidth from \"./images/lineWidth2.png\";\nimport imgStroke1 from \"./images/stroke1.png\";\nimport imgStroke2 from \"./images/stroke2.png\";\nimport imgStroke4 from \"./images/stroke4.png\";\nimport imgStroke5 from \"./images/stroke5.png\";\nimport imgStroke10 from \"./images/stroke10.png\";\nimport imgStroke12 from \"./images/stroke12.png\";\nimport imgStroke15 from \"./images/stroke15.png\";\nimport imgStroke20 from \"./images/stroke20.png\";\nimport imgStroke25 from \"./images/stroke25.png\";\nimport imgLineStyle from \"./images/LineStyle2.png\";\nimport imgLineStyle1 from \"./images/lineStyle1.png\";\nimport imgLineStyle2 from \"./images/lineStyle2png.png\";\nimport imgLineStyle3 from \"./images/lineStyle3.png\";\nimport imgLineStyle4 from \"./images/lineStyle4.png\";\nimport imgLineStyle5 from \"./images/lineStyle5.png\";\nimport imgLineStyle6 from \"./images/lineStyle6.png\";\nimport imgLineStyle7 from \"./images/lineStyle7.png\";\nimport imgText from \"./images/TextBox2.png\";\nimport imgFreeHand from \"./images/PenTool2.png\";\nimport imgSelection from \"./images/Select2.png\";\nimport imgCloud from \"./images/Cloud2.png\";\nimport imgCallout from \"./images/CallOut2.png\";\nimport imgImageEdit from \"./images/Image2.png\";\nimport imgLine from \"./images/Line2.png\";\nimport imgPolyline from \"./images/Polyline2.png\";\nimport imgArrow from \"./images/Arrow2.png\";\nimport imgArc from \"./images/Arc2.png\";\nimport imgRect from \"./images/Rectangle2.png\";\nimport imgPolygon from \"./images/Polygon2.png\";\nimport imgRPolygon from \"./images/RPolygon2.png\";\nimport imgCircle from \"./images/Circle2.png\";\nimport imgEllipse from \"./images/Ellipse2.png\";\nimport imgDimension from \"./images/Dimension2.png\";\nimport imgArea from \"./images/Area2.png\";\nimport imgLength from \"./images/Length2.png\";\nimport imgPerimeter from \"./images/Perimeter2.png\";\nimport imgDropper from \"./images/dropper2.png\";\nimport imgNoStroke from \"./images/noStroke2.png\";\nimport imgNoFill from \"./images/noFill2.png\";\nimport imgFileAccess from \"./images/FileAccess2.png\";\nimport imgNewFile from \"./images/NewFile2.png\";\nimport imgOpenFile from \"./images/OpenFile2.png\";\nimport imgRecentFile from \"./images/recentFile2.png\";\nimport imgCanvasSettings from \"./images/Canvas2.png\";\nimport imgCanvasSize from \"./images/CanvasSize2.png\";\nimport imgCanvasColor from \"./images/CanvasColor2.png\";\nimport imgCanvasImage from \"./images/CanvasImage2.png\";\nimport imgLayers from \"./images/Layers2.png\";\nimport imgLayerBefore from \"./images/InsertBefore2.png\";\nimport imgLayerAfter from \"./images/InsertAfter2.png\";\nimport imgLayerUp from \"./images/Up2.png\";\nimport imgLayerDown from \"./images/Down2.png\";\nimport imgLayerHide from \"./images/Hide2.png\";\nimport imgLayerLock from \"./images/Lock2.png\";\nimport imgLayerSort from \"./images/SortAlpha2.png\";\nimport imgWarehouse from \"./images/Warehouse2.png\";\nimport imgCrane from \"./images/Crane2.png\";\nimport imgElevator from \"./images/Elevator2.png\";\nimport imgLabels from \"./images/labels2.png\";\nimport imgCloud2 from \"./images/CloudTool2.png\";\nimport imgWedge from \"./images/wedge2.png\";\nimport imgRing from \"./images/Ring2.png\";\nimport imgFilledArc from \"./images/FilledArc2.png\";\nimport imgPhase from \"./images/Phases2.png\";\nimport imgNewPhase from \"./images/NewPhase2.png\";\nimport imgPhaseStart from \"./images/StartDate2.png\";\nimport imgPhaseEnd from \"./images/EndDate2.png\";\nimport imgPhaseDelete from \"./images/DeletePhase2.png\";\nimport imgMeasurement from \"./images/Measure2.png\";\nimport imgPageScale from \"./images/PageScale2.png\";\nimport imgSetUnits from \"./images/setunit2.png\";\nimport imgAnimation from \"./images/Animation2.png\";\nimport imgPlay from \"./images/Play2.png\";\n\nimport \"./styles.css\";\nimport styles from \"./rightMenu.module.css\";\nimport tbStyles from \"./toolbar.module.css\";\nimport styled from \"styled-components\";\n\nexport const Backdrop = styled.div.attrs((p) => ({\n  style: {\n    zIndex: p.zIndex,\n    display: p.show ? \"block\" : \"none\",\n    background: p.backdrop ? \"rgba(0, 0, 0, 0.1)\" : \"transparent\",\n  },\n}))`\n  position: fixed;\n  z-index: 1;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n`;\n\nconst initialState = {\n  version: \"3.6.3\",\n  objects: [\n    {\n      type: \"rect\",\n      version: \"3.6.3\",\n      originX: \"left\",\n      originY: \"top\",\n      left: 0,\n      top: 0,\n      width: 1,\n      height: 1,\n      fill: \"black\",\n      stroke: null,\n      strokeWidth: 1,\n      strokeDashArray: null,\n      strokeLineCap: \"butt\",\n      strokeDashOffset: 0,\n      strokeLineJoin: \"miter\",\n      strokeMiterLimit: 4,\n      scaleX: 1,\n      scaleY: 1,\n      angle: 0,\n      flipX: false,\n      flipY: false,\n      opacity: 1,\n      shadow: null,\n      visible: false,\n      clipTo: null,\n      backgroundColor: \"\",\n      fillRule: \"nonzero\",\n      paintFirst: \"fill\",\n      globalCompositeOperation: \"source-over\",\n      transformMatrix: null,\n      skewX: 0,\n      skewY: 0,\n      rx: 0,\n      ry: 0,\n      name: \"shape-rect-n\",\n    },\n  ],\n};\n\nconst fontCheck = new Set(\n  [\n    // Windows 10\n    \"Arial\",\n    \"Arial Black\",\n    \"Bahnschrift\",\n    \"Calibri\",\n    \"Cambria\",\n    \"Cambria Math\",\n    \"Candara\",\n    \"Comic Sans MS\",\n    \"Consolas\",\n    \"Constantia\",\n    \"Corbel\",\n    \"Courier New\",\n    \"Ebrima\",\n    \"Franklin Gothic Medium\",\n    \"Gabriola\",\n    \"Gadugi\",\n    \"Georgia\",\n    \"HoloLens MDL2 Assets\",\n    \"Impact\",\n    \"Ink Free\",\n    \"Javanese Text\",\n    \"Leelawadee UI\",\n    \"Lucida Console\",\n    \"Lucida Sans Unicode\",\n    \"Malgun Gothic\",\n    \"Marlett\",\n    \"Microsoft Himalaya\",\n    \"Microsoft JhengHei\",\n    \"Microsoft New Tai Lue\",\n    \"Microsoft PhagsPa\",\n    \"Microsoft Sans Serif\",\n    \"Microsoft Tai Le\",\n    \"Microsoft YaHei\",\n    \"Microsoft Yi Baiti\",\n    \"MingLiU-ExtB\",\n    \"Mongolian Baiti\",\n    \"MS Gothic\",\n    \"MV Boli\",\n    \"Myanmar Text\",\n    \"Nirmala UI\",\n    \"Palatino Linotype\",\n    \"Segoe MDL2 Assets\",\n    \"Segoe Print\",\n    \"Segoe Script\",\n    \"Segoe UI\",\n    \"Segoe UI Historic\",\n    \"Segoe UI Emoji\",\n    \"Segoe UI Symbol\",\n    \"SimSun\",\n    \"Sitka\",\n    \"Sylfaen\",\n    \"Symbol\",\n    \"Tahoma\",\n    \"Times New Roman\",\n    \"Trebuchet MS\",\n    \"Verdana\",\n    \"Webdings\",\n    \"Wingdings\",\n    \"Yu Gothic\",\n    // macOS\n    \"American Typewriter\",\n    \"Andale Mono\",\n    \"Arial\",\n    \"Arial Black\",\n    \"Arial Narrow\",\n    \"Arial Rounded MT Bold\",\n    \"Arial Unicode MS\",\n    \"Avenir\",\n    \"Avenir Next\",\n    \"Avenir Next Condensed\",\n    \"Baskerville\",\n    \"Big Caslon\",\n    \"Bodoni 72\",\n    \"Bodoni 72 Oldstyle\",\n    \"Bodoni 72 Smallcaps\",\n    \"Bradley Hand\",\n    \"Brush Script MT\",\n    \"Chalkboard\",\n    \"Chalkboard SE\",\n    \"Chalkduster\",\n    \"Charter\",\n    \"Cochin\",\n    \"Comic Sans MS\",\n    \"Copperplate\",\n    \"Courier\",\n    \"Courier New\",\n    \"Didot\",\n    \"DIN Alternate\",\n    \"DIN Condensed\",\n    \"Futura\",\n    \"Geneva\",\n    \"Georgia\",\n    \"Gill Sans\",\n    \"Helvetica\",\n    \"Helvetica Neue\",\n    \"Herculanum\",\n    \"Hoefler Text\",\n    \"Impact\",\n    \"Lucida Grande\",\n    \"Luminari\",\n    \"Marker Felt\",\n    \"Menlo\",\n    \"Microsoft Sans Serif\",\n    \"Monaco\",\n    \"Noteworthy\",\n    \"Optima\",\n    \"Palatino\",\n    \"Papyrus\",\n    \"Phosphate\",\n    \"Rockwell\",\n    \"Savoye LET\",\n    \"SignPainter\",\n    \"Skia\",\n    \"Snell Roundhand\",\n    \"Tahoma\",\n    \"Times\",\n    \"Times New Roman\",\n    \"Trattatello\",\n    \"Trebuchet MS\",\n    \"Verdana\",\n    \"Zapfino\",\n  ].sort()\n);\n\n//const useForceUpdate = () => useState()[1];\n// Or you can use:\n// const fabric = require(\"fabric\").fabric;\n//const canvas = new fabric.Canvas(\"my-fabric-canvas\");\nfunction getWindowDimensions() {\n  const { innerWidth: width, innerHeight: height } = window;\n  return {\n    width,\n    height,\n  };\n}\nfunction determineAdjustedCoords(fromX, fromY, toX, toY) {\n  // this function uses the last point plotted, the length of the lines to the new x and y coords (using toX and toY) to determine an adjusted rubber band end-point\n\n  // find the angle subtended by the current rubber band line i.e. unadjusted (as dictated by the actual mouse coords) and the x axis\n  // var xLen = Math.abs(toX - fromX);\n  // var yLen = Math.abs(toY - fromY);\n  var xLen = toX - fromX;\n  var yLen = toY - fromY;\n  // if x or y difference is zero then no action needed so return\n  if (xLen === 0 && yLen === 0) return;\n  var theta = Math.atan(yLen / xLen) * (180 / Math.PI);\n  // find the hypontenuse of the triangle bounded by the x axis and the actual rubber band line - this will also be the hypontenuse of the adjusted rubber band line\n  var hyp;\n  // verify if any of the components are zero\n  if (Math.sin(theta * (Math.PI / 180)) === 0) hyp = xLen;\n  else {\n    if (yLen === 0) hyp = xLen;\n    else hyp = yLen / Math.sin(theta * (Math.PI / 180));\n  }\n  // find which sector the angle lies in and round it to the nearest sector\n  var sector = Math.round(theta / 15);\n  // find the angle subtended by the adjusted rubber band line (as dictated by the coords we are trying to determine)\n  var thetaNew = sector * 15;\n  // find new x and y coords of the adjusted rubber band line end points\n  var xNew = Math.cos(thetaNew * (Math.PI / 180)) * hyp;\n  var yNew = Math.sin(thetaNew * (Math.PI / 180)) * hyp;\n  // required coords equal the new coords added to the last point plotted (fromX,fromY)\n  var px = fromX + Math.round(xNew);\n  var py = fromY + Math.round(yNew);\n\n  return { tx: px, ty: py };\n}\nconst App = () => {\n  const isDesktopOrLaptop = useMediaQuery({\n    query: \"(min-width: 1224px)\",\n  });\n  const isBigScreen = useMediaQuery({ query: \"(min-width: 1824px)\" });\n  const isTabletOrMobile = useMediaQuery({ query: \"(max-width: 1224px)\" });\n  const isPortrait = useMediaQuery({ query: \"(orientation: portrait)\" });\n  const isRetina = useMediaQuery({ query: \"(min-resolution: 2dppx)\" });\n  //const mforceUpdate = useForceUpdate();\n  // for undo/redoing\n  const [past, setPast] = useState([initialState]);\n  const [future, setFuture] = useState([initialState]);\n  const [windowDimensions, setWindowDimensions] = useState(\n    getWindowDimensions()\n  );\n  //const [newAction, setNewAction] = useState(0);\n  const [pageLoad, setPageLoad] = useState(null);\n  // const canvasRender = useRef(0);\n  const mouseMoving = useRef(false);\n  const canvasRef = useRef();\n  const containerRef = useRef();\n  const mainDiv = useRef(null);\n  const rightBar = useRef();\n  const shapeCount = useRef(0);\n  const isDrawing = useRef(false);\n  const currentStroke = useRef(\"\");\n  const editPoly = useRef(true);\n  const openPoly = useRef(null);\n  const polyType = useRef(\"\");\n  const someValue = useRef(0.0);\n  const activeObjectStrokeRef = useRef(null);\n  const activeObjectFillRef = useRef(null);\n  //const [reRender, forceUpdate] = useReducer((x) => x + 1, 0);\n  //const forceUpdate = React.useReducer(() => ({}))[1];\n  //const [, updateComponent] = React.useState();\n  //const forceUpdateComponent = React.useCallback(() => updateComponent({}), []);\n  //anchors\n  const [canvas, setCanvas] = useState();\n\n  const [pickerStroke, setPickerColorStroke] = useState(`rgba(0, 0, 0, 1)`);\n  const [pickerFill, setPickerColorFill] = useState(`rgba(0, 0, 0, 1)`);\n  //const [canvasHistory, setCanvasHistory] = useState([initialState]);\n  //const [canvasHistory, setCanvasHistory] = useState([]);\n  // const [canvasState, setCanvasState] = useState(initialState);\n  //const [canvasState, setCanvasState] = useState();\n  const [canvasTool, setCanvasTool] = useState(\"select\");\n  const [strokeWidth, setStrokeWidth] = useState(1);\n  // const [stroke, setStrokeColor] = useState(\"black\");\n  const [stroke, setStrokeColor] = useState({\n    r: \"0\",\n    g: \"0\",\n    b: \"0\",\n    a: \"1\",\n  });\n  const [fill, setFillColor] = useState({\n    r: \"0\",\n    g: \"0\",\n    b: \"0\",\n    a: \"0\",\n  });\n  const [textHighlight, setHighlight] = useState({\n    r: \"255\",\n    g: \"255\",\n    b: \"0\",\n    a: \"1\",\n  });\n  // const [fill, setFillColor] = useState(\"black\");\n  const [dashSize, setDashSize] = useState(0);\n  const [gapSize, setGapSize] = useState(0);\n  const [opacity, setOpacity] = useState(100);\n  // const [snap, setSnap] = useState(false);\n  const [font, setFont] = useState(\"\");\n  const [fontSize, setFontSize] = useState(30);\n  const [fontWeight, setFontWeight] = useState(\"normal\");\n  const [fontStyle, setFontStyle] = useState(\"regular\");\n  //const [textHighlight, setHighlight] = useState(\"yellow\");\n\n  const [showStrokePicker, setShowStrokePicker] = useState(false);\n  const [showFillPicker, setShowFillPicker] = useState(false);\n  const [showHighlightPicker, setShowHighlightPicker] = useState(false);\n  //const [shapeCount, setShapeCount] = useState(0);\n\n  //const opacity = useRef(100);\n  const snap = useRef(false);\n  const newShape = useRef(true);\n  const anchors = useRef([]);\n  const pointer = useRef();\n  const line = useRef(null);\n  const origX = useRef();\n  const origY = useRef();\n  const angle = useRef();\n  const arrow = useRef(null);\n  const selectedShape = useRef(null);\n  const polyPoints = useRef([]);\n  const rpolygon = useRef(null);\n  const Rectangle = useRef(null);\n  const circle = useRef(null);\n  const ellipse = useRef(null);\n  const polyLine = useRef(null);\n  const polyLines = useRef([]);\n  const currentToolId = useRef(null);\n\n  var currentOpenPanel = \"none\";\n  var drawingObject = {};\n  drawingObject.type = \"\";\n  drawingObject.background = \"\";\n  drawingObject.border = \"\";\n\n  const StrokeSwatchClick = () => {\n    setShowStrokePicker((showStrokePicker) => !showStrokePicker);\n    if (!showStrokePicker) {\n      //Todo\n      var activeShape = canvas.getActiveObject();\n      if (activeShape) {\n        if (activeShape.stroke === \"rgba(255,255,255,0)\") {\n          setStrokeColor({ r: 255, g: 255, b: 255, a: 1 });\n          setShapeAttributes({\n            stroke: \"rgba(255,255,255,1)\",\n          });\n        }\n      }\n    }\n  };\n  const FillSwatchClick = () => {\n    setShowFillPicker((showFillPicker) => !showFillPicker);\n    if (!showFillPicker) {\n      //Todo\n      var activeShape = canvas.getActiveObject();\n      if (activeShape) {\n        if (activeShape.fill === \"rgba(255,255,255,0)\") {\n          setFillColor({ r: 255, g: 255, b: 255, a: 1 });\n          setShapeAttributes({\n            fill: \"rgba(255,255,255,1)\",\n          });\n        }\n      }\n    }\n  };\n  const HighlightSwatchClick = () => {\n    setShowHighlightPicker((showHighlightPicker) => !showHighlightPicker);\n  };\n  const StrokeSwatchClose = () => {\n    setShowStrokePicker(false);\n  };\n  const FillSwatchClose = () => {\n    setShowFillPicker(false);\n  };\n  const HighlightSwatchClose = () => {\n    setShowHighlightPicker(false);\n  };\n  const StrokeSwatchChange = (color) => {\n    //console.log(stroke);\n    setStrokeColor(color.rgb);\n    // setShapeAttributes({\n    //   stroke:\n    //     \"rgba(\" +\n    //     color.rgb.r +\n    //     \", \" +\n    //     color.rgb.g +\n    //     \", \" +\n    //     color.rgb.b +\n    //     \", \" +\n    //     color.rgb.a +\n    //     \")\",\n    // });\n    setShapeAttributes({\n      stroke: pickerStroke,\n    });\n  };\n  const FillSwatchChange = (color) => {\n    //console.log(stroke);\n    setFillColor(color.rgb);\n    setShapeAttributes({\n      fill:\n        \"rgba(\" +\n        color.rgb.r +\n        \", \" +\n        color.rgb.g +\n        \", \" +\n        color.rgb.b +\n        \", \" +\n        color.rgb.a +\n        \")\",\n    });\n    //console.log(swatchStyles.fill);\n  };\n  const HighlightSwatchChange = (color) => {\n    //console.log(stroke);\n    setHighlight(color.rgb);\n    setShapeAttributes({\n      textBackgroundColor:\n        \"rgba(\" +\n        color.rgb.r +\n        \", \" +\n        color.rgb.g +\n        \", \" +\n        color.rgb.b +\n        \", \" +\n        color.rgb.a +\n        \")\",\n    });\n  };\n  var calcPolygonPoints = (sideCount, radius) => {\n    var sweep = (Math.PI * 2) / sideCount;\n    var cx = radius;\n    var cy = radius;\n    var points = [];\n\n    for (var i = 0; i < sideCount; i++) {\n      var x = cx + radius * Math.cos(i * sweep);\n      var y = cy + radius * Math.sin(i * sweep);\n      points.push({ x: x, y: y });\n    }\n    return points;\n  };\n  /*\n  function click(id) {\n    var ev = new MouseEvent(\"click\", {\n      view: window,\n      bubbles: true,\n      cancelable: true,\n    });\n\n    var el = document.getElementById(id);\n    el.dispatchEvent(ev);\n  }\n  */\n  const saveCanvasState = (newCanvasState) => {\n    past.push(newCanvasState);\n    setPast(past);\n    setFuture([]);\n    sessionStorage.clear();\n    sessionStorage.myFabricJSCanvas = JSON.stringify(newCanvasState);\n    // sessionStorage.setItem(\"history\", JSON.stringify(past));\n  };\n  /*\n  const onObjectModified = useCallback(\n    (e) => {\n      const newCanvasState = e.target.canvas.toJSON([\"name\"]);\n      //const newCanvasState = canvas.toJSON([\"name\"]);\n      setCanvasState(newCanvasState);\n      // Limit history depth\n      setCanvasHistory((history) => [...history, newCanvasState].slice(-32));\n      //setPast([...past, newCanvasState]);\n      //setFuture([]);\n      console.log(newCanvasState);\n    },\n    [setCanvasState, setCanvasHistory]\n  );\n*/\n  React.useEffect(() => {\n    // window.localStorage.setItem(\"colors\", JSON.stringify(colors));\n    // setShapeAttributes({\n    //   stroke: pickerStroke,\n    // });\n    if (canvas === undefined) return;\n    var activeShape = canvas.getActiveObject();\n    if (activeShape) {\n      // if (activeShape.stroke === \"rgba(255,255,255,0)\") {\n      // setStrokeColor({ r: 255, g: 255, b: 255, a: 1 });\n      setShapeAttributes({\n        stroke: pickerStroke,\n      });\n      // }\n    }\n    // console.log(pickerStroke);\n  }, [pickerStroke, setPickerColorStroke, canvas]);\n  React.useEffect(() => {\n    // window.localStorage.setItem(\"colors\", JSON.stringify(colors));\n    // setShapeAttributes({\n    //   stroke: pickerStroke,\n    // });\n    if (canvas === undefined) return;\n    var activeShape = canvas.getActiveObject();\n    if (activeShape) {\n      // if (activeShape.stroke === \"rgba(255,255,255,0)\") {\n      // setStrokeColor({ r: 255, g: 255, b: 255, a: 1 });\n      setShapeAttributes({\n        fill: pickerFill,\n      });\n      // }\n    }\n    // console.log(pickerStroke);\n  }, [pickerFill, setPickerColorFill, canvas]);\n\n  React.useEffect(() => {\n    /*\n    ---disabled for memory issues--\n    var history = JSON.parse(sessionStorage.getItem(\"history\")); //get them back    \n    if (history !== null) setPast(history);\n    */\n    const fontAvailable = new Set();\n    for (const font of fontCheck.values()) {\n      if (document.fonts.check(`12px \"${font}\"`)) {\n        fontAvailable.add(font);\n        var x = document.getElementById(\"fonts\");\n        var option = document.createElement(\"option\");\n        option.text = font;\n        x.add(option);\n      }\n    }\n  }, []);\n  // React.useEffect(() => {}, [canvasState]);\n\n  React.useEffect(() => {\n    //console.log(\"shift pressed\");\n    const canvas = new fabric.Canvas(canvasRef.current);\n    canvas.set({\n      fireRightClick: true,\n      fireMiddleClick: true, // <-- enable firing of middle click events\n      stopContextMenu: true,\n      controlsAboveOverlay: false,\n      targetFindTolerance: 15,\n      preserveObjectStacking: true,\n      perPixelTargetFind: true,\n    });\n    if (pageLoad === null && sessionStorage.myFabricJSCanvas !== undefined) {\n      setPageLoad(1);\n      //console.log(sessionStorage.myFabricJSCanvas);\n      const data = JSON.parse(sessionStorage.myFabricJSCanvas);\n      canvas.loadFromJSON(data);\n      canvas.forEachObject(function (o) {\n        if (o.name.includes(\"anchor\")) {\n          canvas.remove(o);\n        }\n      });\n      anchors.current = [];\n      var json = canvas.toJSON([\"name\"]);\n      past.push(json);\n      setPast(past);\n      /*\n      //disabled for memory issues. as a result, undoing after refresh is not possible\n      var history = JSON.parse(sessionStorage.getItem(\"history\")); //get them back      \n      if (history !== null) setPast(history);\n      */\n      setFuture([]);\n    } else {\n      canvas.loadFromJSON(past[past.length - 1]);\n    }\n    canvas.renderAll();\n    function handleResize() {\n      const ratio = canvas.getWidth() / canvas.getHeight();\n      const containerWidth =\n        containerRef.current.clientWidth > 1191\n          ? 1191\n          : containerRef.current.clientWidth - 100;\n      const containerHeight = containerRef.current.clientHeight - 100;\n      const scale = containerWidth / canvas.getWidth();\n      const zoom = canvas.getZoom() * scale;\n      canvas.setDimensions({\n        width: containerWidth,\n        height: containerWidth / ratio,\n      });\n      canvas.setViewportTransform([zoom, 0, 0, zoom, 0, 0]);\n    }\n\n    window.addEventListener(\"resize\", handleResize);\n\n    editPoly.current = true;\n    if (canvasTool === \"pen\") {\n      canvas.isDrawingMode = 1;\n      canvas.freeDrawingBrush.color =\n        \"rgba(\" +\n        stroke.r +\n        \", \" +\n        stroke.g +\n        \", \" +\n        stroke.b +\n        \", \" +\n        stroke.a +\n        \")\";\n      canvas.freeDrawingBrush.width = strokeWidth;\n    }\n    if (canvasTool !== \"select\") {\n      canvas.selection = false;\n      canvas.defaultCursor = \"crosshair\";\n      canvas.forEachObject(function (o) {\n        o.selectable = false;\n        o.hoverCursor = \"move\";\n      });\n      if (openPoly.current !== null) {\n        openPoly.current = null;\n        canvas.forEachObject(function (o) {\n          if (o.name.includes(\"anchor\")) {\n            canvas.remove(o);\n          }\n        });\n        anchors.current = [];\n        canvas.renderAll();\n        const newCanvasState = canvas.toJSON([\"name\"]);\n        saveCanvasState(newCanvasState);\n        sessionStorage.myFabricJSCanvas = JSON.stringify(newCanvasState);\n      }\n    } else {\n      canvas.selection = true;\n      canvas.forEachObject(function (o) {\n        o.selectable = true;\n      });\n      var allObjects = canvas.getObjects();\n      var lastObjectCreated = allObjects[allObjects.length - 1];\n      canvas.setActiveObject(lastObjectCreated);\n      //console.log(lastObjectCreated);\n      canvas.renderAll();\n    }\n\n    canvas.on(\"object:rotating\", function (options) {\n      if (!snap.current) return;\n      var angle = options.target.angle;\n      var locked = Math.ceil(options.target.angle / 5) * 5;\n      if (Math.abs(angle - locked) < 10 || Math.abs(locked - angle) < 10) {\n        angle = locked;\n      }\n\n      options.target.set({\n        angle: angle,\n      });\n    });\n    //canvas.on(\"object:added\", onObjectModified);\n    // canvas.on(\"object:modified\", onObjectModified);\n    canvas.on(\"object:modified\", function (e) {\n      const newCanvasState = e.target.canvas.toJSON([\"name\"]);\n      past.push(newCanvasState);\n      setPast(past);\n      //console.log(past);\n      setFuture([]);\n      sessionStorage.clear();\n      sessionStorage.myFabricJSCanvas = JSON.stringify(newCanvasState);\n      // sessionStorage.setItem(\"history\", JSON.stringify(past));\n    });\n    canvas.on(\"object:removed\", function (e) {\n      const newCanvasState = e.target.canvas.toJSON([\"name\"]);\n      past.push(newCanvasState);\n      setPast(past);\n      //console.log(past);\n      setFuture([]);\n      sessionStorage.clear();\n      sessionStorage.myFabricJSCanvas = JSON.stringify(newCanvasState);\n      // sessionStorage.setItem(\"history\", JSON.stringify(past));\n    });\n\n    canvas.on(\"mouse:dblclick\", function (e) {\n      if (canvasTool === \"polygon\") {\n        canvas.remove(line.current);\n        for (var i = 0; i < polyLines.current.length; i++) {\n          canvas.remove(polyLines.current[i]);\n        }\n        newShape.current = true;\n        isDrawing.current = false;\n        var polyGon = null;\n        polyGon = new fabric.Polygon(polyPoints.current, {\n          stroke:\n            \"rgba(\" +\n            stroke.r +\n            \", \" +\n            stroke.g +\n            \", \" +\n            stroke.b +\n            \", \" +\n            stroke.a +\n            \")\",\n          fill:\n            \"rgba(\" +\n            fill.r +\n            \", \" +\n            fill.g +\n            \", \" +\n            fill.b +\n            \", \" +\n            fill.a +\n            \")\",\n          strokeWidth: strokeWidth,\n          selectable: false,\n          hoverCursor: \"default\",\n          name: \"shape-polygon-\" + shapeCount.current,\n        });\n        canvas.add(polyGon);\n        editPoly.current = true;\n        canvas.setActiveObject(polyGon);\n        // document.getElementById(\"select\").click();\n        canvas.renderAll();\n        shapeCount.current++;\n        const newCanvasState = canvas.toJSON([\"name\"]);\n        saveCanvasState(newCanvasState);\n      }\n\n      if (canvasTool === \"polyline\") {\n        canvas.remove(line.current);\n        for (i = 0; i < polyLines.current.length; i++) {\n          canvas.remove(polyLines.current[i]);\n        }\n        newShape.current = true;\n        isDrawing.current = false;\n        var polyLine = new fabric.Polyline(polyPoints.current, {\n          stroke:\n            \"rgba(\" +\n            stroke.r +\n            \", \" +\n            stroke.g +\n            \", \" +\n            stroke.b +\n            \", \" +\n            stroke.a +\n            \")\",\n          fill: \"\",\n          strokeWidth: strokeWidth,\n          selectable: false,\n          hoverCursor: \"default\",\n          name: \"shape-polyline-\" + shapeCount.current,\n        });\n        canvas.add(polyLine);\n        canvas.setActiveObject(polyLine);\n        // document.getElementById(\"select\").click();\n        editPoly.current = true;\n        canvas.renderAll();\n        shapeCount.current++;\n        const newCanvasState = canvas.toJSON([\"name\"]);\n        saveCanvasState(newCanvasState);\n      }\n      if (canvasTool === \"select\") {\n        console.log(e.target);\n        if (e.target === null) return;\n        if (e.target.type === \"polyline\" && editPoly.current) {\n          canvas.set({\n            perPixelTargetFind: false,\n          });\n          canvas.forEachObject(function (o) {\n            if (o.name.includes(\"anchor\")) {\n              canvas.remove(o);\n            }\n          });\n          anchors.current = [];\n          polyType.current = \"polyline\";\n\n          // polyPoints = [];\n          var editable = e.target;\n          openPoly.current = editable; //for future hiding the anchor points.\n          editable.set({\n            hasControls: false,\n            hasBorders: false,\n            selectable: false,\n            hoverCursor: \"default\",\n          });\n          editPoly.current = false;\n          // console.log(editable.get(\"points\"));\n          var str = editable.get(\"name\");\n          var id = str.split(\"-\");\n          var matrix = editable.calcTransformMatrix();\n          var transformedPoints = editable\n            .get(\"points\")\n            .map(function (p) {\n              return new fabric.Point(\n                p.x - editable.pathOffset.x,\n                p.y - editable.pathOffset.y\n              );\n            })\n            .map(function (p) {\n              return fabric.util.transformPoint(p, matrix);\n            });\n          var pFill = editable.get(\"fill\");\n          var pStroke = editable.get(\"stroke\");\n          var pName = editable.get(\"name\");\n          canvas.remove(editable);\n          var updatedPoly = new fabric.Polyline(transformedPoints, {\n            fill: pFill,\n            stroke: pStroke,\n            name: pName,\n            hasControls: false,\n            hasBorders: false,\n            selectable: false,\n            hoverCursor: \"default\",\n          });\n          canvas.add(updatedPoly);\n          canvas.sendToBack(updatedPoly);\n          openPoly.current = updatedPoly;\n          anchors.current = [];\n          transformedPoints.forEach(function (p, index) {\n            var anchor = new fabric.Circle({\n              left: p.x,\n              top: p.y,\n              radius: 15,\n              fill: \"green\",\n              originX: \"center\",\n              originY: \"center\",\n              hasControls: false,\n              hasBorders: false,\n              name: \"anchor-\" + id[2] + \"-\" + index,\n            });\n            canvas.add(anchor);\n            anchors.current.push(anchor);\n          });\n          canvas.renderAll();\n          return;\n        }\n        //if (e.target === null && !editPoly.current) {\n        if (e.target.type === \"polyline\" && !editPoly.current) {\n          canvas.set({\n            perPixelTargetFind: true,\n          });\n          polyType.current = \"\";\n          editable = e.target;\n          editable.set({\n            hasControls: true,\n            hasBorders: true,\n            selectable: true,\n            hoverCursor: \"move\",\n          });\n          editPoly.current = true;\n          anchors.current.forEach(function (anchor) {\n            canvas.remove(anchor);\n          });\n          anchors.current = [];\n          openPoly.current = null;\n          canvas.renderAll();\n          return;\n        }\n        if (e.target.type === \"polygon\" && editPoly.current) {\n          if (e.target === null) return;\n          if (e.target.name.includes(\"rpolygon\")) return;\n          canvas.set({\n            perPixelTargetFind: false,\n          });\n          canvas.forEachObject(function (o) {\n            if (o.name.includes(\"anchor\")) {\n              canvas.remove(o);\n            }\n          });\n          anchors.current = [];\n          polyType.current = \"polygon\";\n          // polyPoints = [];\n          editable = e.target;\n          openPoly.current = editable; //for future hiding the anchor points.\n          editable.set({\n            hasControls: false,\n            hasBorders: false,\n            selectable: false,\n            hoverCursor: \"default\",\n          });\n          editPoly.current = false;\n          // console.log(editable.get(\"points\"));\n          str = editable.get(\"name\");\n          id = str.split(\"-\");\n          matrix = editable.calcTransformMatrix();\n          transformedPoints = editable\n            .get(\"points\")\n            .map(function (p) {\n              return new fabric.Point(\n                p.x - editable.pathOffset.x,\n                p.y - editable.pathOffset.y\n              );\n            })\n            .map(function (p) {\n              return fabric.util.transformPoint(p, matrix);\n            });\n          pFill = editable.get(\"fill\");\n          pStroke = editable.get(\"stroke\");\n          pName = editable.get(\"name\");\n          canvas.remove(editable);\n          updatedPoly = new fabric.Polygon(transformedPoints, {\n            fill: pFill,\n            stroke: pStroke,\n            name: pName,\n            hasControls: false,\n            hasBorders: false,\n            selectable: false,\n            hoverCursor: \"default\",\n          });\n          canvas.add(updatedPoly);\n          canvas.sendToBack(updatedPoly);\n          anchors.current = [];\n          transformedPoints.forEach(function (p, index) {\n            var anchor = new fabric.Circle({\n              left: p.x,\n              top: p.y,\n              radius: 15,\n              fill: \"green\",\n              originX: \"center\",\n              originY: \"center\",\n              hasControls: false,\n              hasBorders: false,\n              name: \"anchor-\" + id[2] + \"-\" + index,\n            });\n            canvas.add(anchor);\n            anchors.current.push(anchor);\n          });\n          canvas.renderAll();\n          return;\n        }\n        if (e.target.type === \"polygon\" && !editPoly.current) {\n          if (e.target.name.includes(\"rpolygon\")) return;\n          canvas.set({\n            perPixelTargetFind: true,\n          });\n          polyType.current = \"\";\n          editable = e.target;\n          editable.set({\n            hasControls: true,\n            hasBorders: true,\n            selectable: true,\n            hoverCursor: \"move\",\n          });\n          editPoly.current = true;\n          anchors.current.forEach(function (anchor) {\n            canvas.remove(anchor);\n          });\n          anchors.current = [];\n          canvas.renderAll();\n          return;\n        }\n      }\n    });\n    // canvas.on(\"dragenter\", function (options) {\n    //   alert(\"draggin\");\n    // });\n    canvas.on(\"object:moving\", function (options) {\n      // if (options.e.altKey) alert(\"moving\");\n      if (options.target.type !== \"circle\") {\n        if (openPoly.current !== null) {\n          openPoly.current = null;\n          editPoly.current = true;\n          anchors.current.forEach(function (anchor) {\n            canvas.remove(anchor);\n          });\n          anchors.current = [];\n          canvas.renderAll();\n          return;\n        }\n      }\n      if (options.target.type === \"circle\") {\n        var p = options.target;\n        //console.log(p.get(\"name\"));\n        if (p.name.includes(\"circle\")) return;\n        if (p.name.includes(\"arc\")) return;\n        var str = p.name.split(\"-\");\n        if (polyType.current === \"polyline\") {\n          var pname = \"shape-polyline-\" + str[1];\n        }\n        if (polyType.current === \"polygon\") {\n          pname = \"shape-polygon-\" + str[1];\n        }\n\n        //console.log(pname);\n        var object = null;\n        var objects = canvas.getObjects();\n        for (var i = 0; i < objects.length; i++) {\n          if (objects[i].name && objects[i].name === pname) {\n            object = objects[i];\n            break;\n          }\n        }\n        // console.log(object);\n        object.points[str[2]] = {\n          x: p.getCenterPoint().x,\n          y: p.getCenterPoint().y,\n        };\n\n        //console.log(p.getCenterPoint());\n        var pFill = object.get(\"fill\");\n        var pStroke = object.get(\"stroke\");\n        var pName = object.get(\"name\");\n        var pPoints = object.get(\"points\");\n        //UNCOMMENT LINES 39 - 42 TO HAVE A WORKAROUND\n        canvas.remove(object);\n        if (polyType.current === \"polyline\") {\n          var updatedPoly = new fabric.Polyline(pPoints, {\n            fill: pFill,\n            stroke: pStroke,\n            name: pName,\n            hasControls: false,\n            hasBorders: false,\n            selectable: false,\n            hoverCursor: \"default\",\n          });\n        }\n        if (polyType.current === \"polygon\") {\n          updatedPoly = new fabric.Polygon(pPoints, {\n            fill: pFill,\n            stroke: pStroke,\n            name: pName,\n            hasControls: false,\n            hasBorders: false,\n            selectable: false,\n            hoverCursor: \"default\",\n          });\n        }\n        canvas.add(updatedPoly);\n        canvas.sendToBack(updatedPoly);\n        canvas.renderAll();\n      }\n    });\n\n    canvas.on(\"mouse:up\", function (e) {\n      this.setViewportTransform(this.viewportTransform);\n      this.isDragging = false;\n      mouseMoving.current = false;\n      if (e.button === 2) return;\n      // if (e.button === 3) {\n      //   setActiveTool(e, \"select\");\n      //   setCanvas(\"select\");\n      //   return;\n      // }\n      // this.selection = true;\n      if (canvas.isDrawingMode) {\n        var allObjects = canvas.getObjects();\n        var path = allObjects[allObjects.length - 1];\n        path.set({ name: \"shape-path-\" + shapeCount.current });\n        //console.log(path);\n        shapeCount.current = shapeCount.current + 1;\n        canvas.selection = true;\n        // document.getElementById(\"select\").click();\n        canvas.setActiveObject(allObjects[allObjects.length - 1]);\n        canvas.renderAll();\n        const newCanvasState = canvas.toJSON([\"name\"]);\n        saveCanvasState(newCanvasState);\n        // }\n      }\n\n      if (canvasTool === \"text\") {\n        //console.log(canvas.getObjects());\n        pointer.current = canvas.getPointer(e);\n        var text = new fabric.IText(\"Esc to edit\", {\n          left: pointer.current.x,\n          top: pointer.current.y,\n          fontFamily: \"Arial\",\n          fontSize: \"30\",\n          // fontWeight: \"regular\",\n          //stroke: stroke,\n          // strokeWidth: strokeWidth,\n          // selectable: false,\n          hoverCursor: \"default\",\n          name: \"shape-text-\" + shapeCount.current,\n        });\n        //console.log(text);\n        canvas.add(text);\n        // document.getElementById(\"select\").click();\n        canvas.setActiveObject(text);\n        canvas.renderAll();\n\n        shapeCount.current = shapeCount.current + 1;\n        // Save the canvas to State variable\n        const newCanvasState = canvas.toJSON([\"name\"]);\n\n        saveCanvasState(newCanvasState);\n      }\n      if (canvasTool === \"line\") {\n        if (newShape.current) {\n          pointer.current = canvas.getPointer(e);\n          var points = [\n            pointer.current.x,\n            pointer.current.y,\n            pointer.current.x,\n            pointer.current.y,\n          ];\n          line.current = new fabric.Line(points, {\n            strokeWidth: strokeWidth,\n            stroke: pickerStroke,\n            originX: \"center\",\n            originY: \"center\",\n            padding: 15,\n            //selectable: false,\n            hoverCursor: \"default\",\n            name: \"shape-line-\" + shapeCount.current,\n          });\n          canvas.add(line.current);\n\n          shapeCount.current = shapeCount.current + 1;\n          newShape.current = false;\n        } else {\n          pointer.current = canvas.getPointer(e);\n          if (e.e.shiftKey) {\n            var { tx, ty } = determineAdjustedCoords(\n              line.current.x1,\n              line.current.y1,\n              pointer.current.x,\n              pointer.current.y\n            );\n            line.current.set({ x2: tx, y2: ty });\n            // var deltaX = Math.abs(pointer.current.x - line.current.x1);\n            // var deltaY = Math.abs(pointer.current.y - line.current.y1);\n            // if (deltaX > deltaY)\n            //   line.current.set({ x2: pointer.current.x, y2: line.current.y1 });\n            // if (deltaY > deltaX)\n            //   line.current.set({ x2: line.current.x1, y2: pointer.current.y });\n          } else\n            line.current.set({ x2: pointer.current.x, y2: pointer.current.y });\n          // line.current.set({ x2: pointer.current.x, y2: pointer.current.y });\n          // document.getElementById(\"select\").click();\n          canvas.setActiveObject(line.current);\n          canvas.renderAll();\n          newShape.current = true;\n          // Save the canvas to State variable\n          const newCanvasState = canvas.toJSON([\"name\"]);\n          saveCanvasState(newCanvasState);\n        }\n      }\n      if (canvasTool === \"arrow\") {\n        if (newShape.current) {\n          pointer.current = canvas.getPointer(e);\n          let arrowLinePoints = [\n            pointer.current.x,\n            pointer.current.y,\n            pointer.current.x,\n            pointer.current.y,\n          ];\n          line.current = new fabric.Line(arrowLinePoints, {\n            stroke: pickerStroke,\n            strokeWidth: strokeWidth,\n            originX: \"center\",\n            originY: \"center\",\n            padding: 15,\n          });\n          // reference points for arrowhead\n          origX.current = line.current.x2;\n          origY.current = line.current.y2;\n          let dx = line.current.x2 - line.current.x1,\n            dy = line.current.y2 - line.current.y1;\n          /* calculate angle.current of arrow.current */\n          angle.current = Math.atan2(dy, dx);\n          angle.current *= 180 / Math.PI;\n          angle.current += 90;\n\n          arrow.current = new fabric.Triangle({\n            angle: angle.current,\n            fill: pickerFill,\n            top: line.current.y2,\n            left: line.current.x2,\n            width: 15,\n            height: 15,\n            originX: \"center\",\n            originY: \"center\",\n            stroke: pickerStroke,\n            strokeWidth: strokeWidth,\n          });\n          canvas.add(line.current);\n          canvas.add(arrow.current);\n          canvas.renderAll();\n          newShape.current = false;\n        } else {\n          canvas.remove(line.current);\n          canvas.remove(arrow.current);\n          selectedShape.current = new fabric.Group(\n            [line.current, arrow.current],\n            {\n              hasBorders: true,\n              hasControls: true,\n              selectable: false,\n              hoverCursor: \"default\",\n              originX: \"center\",\n              originY: \"center\",\n            }\n          );\n          shapeCount.current = shapeCount.current + 1;\n          selectedShape.current.set(\n            \"name\",\n            \"shape-arrow-\" + shapeCount.current + 1\n          );\n          canvas.add(selectedShape.current);\n          canvas.setActiveObject(selectedShape.current);\n          // document.getElementById(\"select\").click();\n          newShape.current = true;\n          // Save the canvas to State variable\n          const newCanvasState = canvas.toJSON([\"name\"]);\n          saveCanvasState(newCanvasState);\n        }\n      }\n      if (canvasTool === \"polyline\") {\n        if (newShape.current) {\n          polyPoints.current = [];\n          isDrawing.current = true;\n          pointer.current = canvas.getPointer(e);\n          origX.current = pointer.current.x;\n          origY.current = pointer.current.y;\n          polyPoints.current.push(pointer.current);\n          line.current = new fabric.Line(\n            [\n              pointer.current.x,\n              pointer.current.y,\n              pointer.current.x,\n              pointer.current.y,\n            ],\n            {\n              stroke: pickerStroke,\n              strokeWidth: strokeWidth,\n              hasControls: false,\n              hasBorders: false,\n              selectable: false,\n              lockMovementX: true,\n              lockMovementY: true,\n              hoverCursor: \"default\",\n              originX: \"center\",\n              originY: \"center\",\n              padding: 15,\n            }\n          );\n          canvas.add(line.current);\n          //polyLines.current.push(polyline);\n          newShape.current = false;\n        } else {\n          pointer.current = canvas.getPointer(e);\n          line.current.set({ x1: pointer.current.x, y1: pointer.current.y });\n          polyPoints.current.push(pointer.current);\n          if (polyPoints.current.length > 1) {\n            var startPoint = polyPoints.current[polyPoints.current.length - 2];\n            var endPoint = polyPoints.current[polyPoints.current.length - 1];\n            var evt = e.e;\n            if (evt.shiftKey === true) {\n              if (\n                Math.abs(pointer.current.x - startPoint.x) >\n                Math.abs(pointer.current.y - startPoint.y)\n              ) {\n                console.log(\"line should be horizontally strait\");\n                endPoint.y = startPoint.y;\n                line.current.set({ x1: pointer.current.x, y1: endPoint.y });\n              } else {\n                console.log(\"line should be vertically strait\");\n                endPoint.x = startPoint.x;\n                line.current.set({\n                  x1: startPoint.x,\n                  y1: pointer.current.y,\n                });\n              }\n              polyPoints.current.pop();\n              polyPoints.current.push(endPoint);\n            }\n            var newPolyLine = new fabric.Line(\n              [startPoint.x, startPoint.y, endPoint.x, endPoint.y],\n              {\n                stroke: pickerStroke,\n                strokeWidth: strokeWidth,\n                hasControls: false,\n                hasBorders: false,\n                selectable: false,\n                lockMovementX: true,\n                lockMovementY: true,\n                hoverCursor: \"default\",\n                originX: \"center\",\n                originY: \"center\",\n                padding: 15,\n              }\n            );\n            var distance = Math.sqrt(\n              Math.pow(origX.current - pointer.current.x, 2) +\n                Math.pow(origY.current - pointer.current.y, 2)\n            );\n            console.log(distance);\n            if (distance < 20) {\n              if (\n                window.confirm(\n                  \"Close the shape? Press OK to close it. Cancel to keep the shape open.\"\n                )\n              ) {\n                newPolyLine.set({\n                  x2: origX.current,\n                  y2: origY.current,\n                });\n                canvas.add(newPolyLine);\n                canvas.renderAll();\n                polyLines.current.push(newPolyLine);\n\n                canvas.remove(line.current);\n                for (var i = 0; i < polyLines.current.length; i++) {\n                  canvas.remove(polyLines.current[i]);\n                }\n                newShape.current = true;\n                isDrawing.current = false;\n                polyLine.current = null;\n                polyPoints.current.pop();\n                polyPoints.current.push(polyPoints.current[0]);\n                console.log(polyPoints.current);\n                polyLine.current = new fabric.Polygon(polyPoints.current, {\n                  stroke: pickerStroke,\n                  fill: pickerFill,\n                  strokeWidth: strokeWidth,\n                  padding: 15,\n                  selectable: false,\n                  hoverCursor: \"default\",\n                  name: \"shape-polygon-\" + shapeCount.current,\n                });\n                // console.log(fill);\n                canvas.add(polyLine.current);\n                canvas.setActiveObject(polyLine.current);\n                // document.getElementById(\"select\").click();\n                editPoly.current = true;\n                canvas.renderAll();\n                shapeCount.current++;\n                const newCanvasState = canvas.toJSON([\"name\"]);\n                saveCanvasState(newCanvasState);\n                return;\n              } else {\n                // Do nothing!\n                console.log(\"Shape still open double click to finish\");\n              }\n            }\n            canvas.add(newPolyLine);\n            polyLines.current.push(newPolyLine);\n            canvas.renderAll();\n          }\n        }\n      }\n      if (canvasTool === \"polygon\") {\n        if (newShape.current) {\n          polyPoints.current = [];\n          isDrawing.current = true;\n          pointer.current = canvas.getPointer(e);\n          polyPoints.current.push(pointer.current);\n          line.current = new fabric.Line(\n            [\n              pointer.current.x,\n              pointer.current.y,\n              pointer.current.x,\n              pointer.current.y,\n            ],\n            {\n              stroke: pickerStroke,\n              strokeWidth: strokeWidth,\n              padding: 15,\n              hasControls: false,\n              hasBorders: false,\n              selectable: false,\n              lockMovementX: true,\n              lockMovementY: true,\n              hoverCursor: \"default\",\n              originX: \"center\",\n              originY: \"center\",\n            }\n          );\n          canvas.add(line.current);\n          newShape.current = false;\n        } else {\n          pointer.current = canvas.getPointer(e);\n          line.current.set({ x1: pointer.current.x, y1: pointer.current.y });\n          polyPoints.current.push(pointer.current);\n          if (polyPoints.current.length > 1) {\n            startPoint = polyPoints.current[polyPoints.current.length - 2];\n            endPoint = polyPoints.current[polyPoints.current.length - 1];\n            newPolyLine = new fabric.Line(\n              [startPoint.x, startPoint.y, endPoint.x, endPoint.y],\n              {\n                stroke: pickerStroke,\n                strokeWidth: strokeWidth,\n                padding: 15,\n                hasControls: false,\n                hasBorders: false,\n                selectable: false,\n                lockMovementX: true,\n                lockMovementY: true,\n                hoverCursor: \"default\",\n                originX: \"center\",\n                originY: \"center\",\n              }\n            );\n            canvas.add(newPolyLine);\n            polyLines.current.push(newPolyLine);\n            canvas.renderAll();\n          }\n        }\n      }\n      if (canvasTool === \"rpolygon\") {\n        if (newShape.current) {\n          pointer.current = canvas.getPointer(e);\n          origX.current = pointer.current.x;\n          origY.current = pointer.current.y;\n          rpolygon.current = new fabric.Polygon(\n            calcPolygonPoints(\n              8,\n              Math.abs(origX.current - pointer.current.x) / 2\n            ),\n            {\n              objectCaching: false,\n              left: origX.current,\n              top: origY.current,\n              originX: \"center\",\n              originY: \"center\",\n              fill: pickerFill,\n              perPixelTargetFind: false,\n              strokeWidth: strokeWidth,\n              stroke: pickerStroke,\n              hasControls: false,\n              hasBorders: false,\n              padding: 15,\n              name: \"shape-rpolygon-\" + shapeCount.current,\n            }\n          );\n          canvas.add(rpolygon.current);\n          newShape.current = false;\n          shapeCount.current++;\n        } else {\n          newShape.current = true;\n          var matrix = rpolygon.current.calcTransformMatrix();\n          var transformedPoints = rpolygon.current\n            .get(\"points\")\n            .map(function (p) {\n              return new fabric.Point(\n                p.x - rpolygon.current.pathOffset.x,\n                p.y - rpolygon.current.pathOffset.y\n              );\n            })\n            .map(function (p) {\n              return fabric.util.transformPoint(p, matrix);\n            });\n          canvas.remove(rpolygon.current);\n          var updatedPoly = new fabric.Polygon(transformedPoints, {\n            fill: pickerFill,\n            stroke: pickerStroke,\n            padding: 15,\n            name: \"shape-rpolygon-\" + shapeCount.current,\n            // hasControls: false,\n            // hasBorders: false,\n            //selectable: false,\n            hoverCursor: \"default\",\n          });\n          updatedPoly.set({\n            originX: \"center\",\n            originY: \"center\",\n            left: origX.current + updatedPoly.width / 2,\n            top: origY.current + updatedPoly.height / 2,\n          });\n          canvas.add(updatedPoly);\n          canvas.setActiveObject(updatedPoly);\n          //  document.getElementById(\"select\").click();\n          canvas.renderAll();\n          // Save the canvas to State variable\n          const newCanvasState = canvas.toJSON([\"name\"]);\n          saveCanvasState(newCanvasState);\n        }\n      }\n      if (canvasTool === \"rect\") {\n        if (newShape.current) {\n          pointer.current = canvas.getPointer(e);\n          origX.current = pointer.current.x;\n          origY.current = pointer.current.y;\n          Rectangle.current = new fabric.Rect({\n            left: origX.current,\n            top: origY.current,\n            fill: pickerFill,\n            stroke: pickerStroke,\n            strokeWidth: strokeWidth,\n            padding: 15,\n            strokeDashArray: [dashSize, gapSize],\n            centeredScaling: true,\n            opacity: opacity,\n            selectable: false,\n            hoverCursor: \"default\",\n            name: \"shape-rect-\" + shapeCount.current,\n          });\n          shapeCount.current++;\n\n          canvas.add(Rectangle.current);\n          newShape.current = false;\n        } else {\n          pointer.current = canvas.getPointer(e);\n\n          if (origX.current > pointer.current.x) {\n            Rectangle.current.set({ left: Math.abs(pointer.current.x) });\n          }\n          if (origY.current > pointer.current.y) {\n            Rectangle.current.set({ top: Math.abs(pointer.current.y) });\n          }\n          Rectangle.current.set({\n            width: Math.abs(origX.current - pointer.current.x),\n          });\n          Rectangle.current.set({\n            height: Math.abs(origY.current - pointer.current.y),\n          });\n          Rectangle.current.set({\n            originX: \"center\",\n            originY: \"center\",\n            left: origX.current + Rectangle.current.width / 2,\n            top: origY.current + Rectangle.current.height / 2,\n          });\n          newShape.current = true;\n          canvas.setActiveObject(Rectangle.current);\n\n          //  document.getElementById(\"select\").click();\n          canvas.renderAll();\n          // Save the canvas to State variable\n          const newCanvasState = canvas.toJSON([\"name\"]);\n          saveCanvasState(newCanvasState);\n        }\n      }\n      if (canvasTool === \"arc\") {\n        if (newShape.current) {\n          pointer.current = canvas.getPointer(e);\n          origX.current = pointer.current.x;\n          origY.current = pointer.current.y;\n          circle.current = new fabric.Circle({\n            left: origX.current,\n            top: origY.current,\n            originX: \"left\",\n            originY: \"top\",\n            radius: pointer.current.x - origX.current,\n            angle: 45,\n            startAngle: 0,\n            endAngle: Math.PI,\n            fill: pickerFill,\n            stroke: pickerStroke,\n            strokeWidth: strokeWidth,\n            padding: 15,\n            selectable: false,\n            hoverCursor: \"default\",\n            name: \"shape-arc-\" + shapeCount.current,\n          });\n          canvas.add(circle.current);\n          newShape.current = false;\n          shapeCount.current++;\n        } else {\n          pointer.current = canvas.getPointer(e);\n          var radius =\n            Math.max(\n              Math.abs(origY.current - pointer.current.y),\n              Math.abs(origX.current - pointer.current.x)\n            ) / 2;\n          if (radius > circle.current.strokeWidth) {\n            radius -= circle.current.strokeWidth / 2;\n          }\n          circle.current.set({ radius: radius });\n\n          if (origX.current > pointer.current.x) {\n            circle.current.set({ originX: \"right\" });\n          } else {\n            circle.current.set({ originX: \"left\" });\n          }\n          if (origY.current > pointer.current.y) {\n            circle.current.set({ originY: \"bottom\" });\n          } else {\n            circle.current.set({ originY: \"top\" });\n          }\n          newShape.current = true;\n          canvas.setActiveObject(circle.current);\n          // document.getElementById(\"select\").click();\n          canvas.renderAll();\n          // Save the canvas to State variable\n          const newCanvasState = canvas.toJSON([\"name\"]);\n          saveCanvasState(newCanvasState);\n        }\n      }\n      if (canvasTool === \"circle\") {\n        if (newShape.current) {\n          pointer.current = canvas.getPointer(e);\n          origX.current = pointer.current.x;\n          origY.current = pointer.current.y;\n          circle.current = new fabric.Circle({\n            left: origX.current,\n            top: origY.current,\n            originX: \"left\",\n            originY: \"top\",\n            radius: pointer.current.x - origX.current,\n            angle: 0,\n            fill: pickerFill,\n            stroke: pickerStroke,\n            strokeWidth: strokeWidth,\n            padding: 15,\n            selectable: false,\n            hoverCursor: \"default\",\n            name: \"shape-circle-\" + shapeCount.current,\n          });\n          canvas.add(circle.current);\n          newShape.current = false;\n          shapeCount.current++;\n        } else {\n          pointer.current = canvas.getPointer(e);\n          radius =\n            Math.max(\n              Math.abs(origY.current - pointer.current.y),\n              Math.abs(origX.current - pointer.current.x)\n            ) / 2;\n\n          if (radius > circle.current.strokeWidth) {\n            radius -= circle.current.strokeWidth / 2;\n          }\n          radius += someValue.current;\n          circle.current.set({ radius: radius });\n\n          if (origX.current > pointer.current.x) {\n            circle.current.set({ originX: \"right\" });\n          } else {\n            circle.current.set({ originX: \"left\" });\n          }\n          if (origY.current > pointer.current.y) {\n            circle.current.set({ originY: \"bottom\" });\n          } else {\n            circle.current.set({ originY: \"top\" });\n          }\n          circle.current.set({\n            originX: \"center\",\n            originY: \"center\",\n            left: origX.current + circle.current.radius,\n            top: origY.current + circle.current.radius,\n          });\n          newShape.current = true;\n          canvas.setActiveObject(circle.current);\n          //  document.getElementById(\"select\").click();\n          canvas.renderAll();\n          // Save the canvas to State variable\n          const newCanvasState = canvas.toJSON([\"name\"]);\n          saveCanvasState(newCanvasState);\n        }\n      }\n      if (canvasTool === \"ellipse\") {\n        if (newShape.current) {\n          pointer.current = canvas.getPointer(e);\n          origX.current = pointer.current.x;\n          origY.current = pointer.current.y;\n          ellipse.current = new fabric.Ellipse({\n            left: origX.current,\n            top: origY.current,\n            originX: \"left\",\n            originY: \"top\",\n            rx: pointer.current.x - origX.current,\n            ry: pointer.current.y - origY.current,\n            angle: 0,\n            fill: pickerFill,\n            stroke: pickerStroke,\n            strokeWidth: strokeWidth,\n            padding: 15,\n            type: \"ellipse\",\n            selectable: false,\n            hoverCursor: \"default\",\n            name: \"shape-ellipse-\" + shapeCount.current,\n          });\n          canvas.add(ellipse.current);\n          newShape.current = false;\n        } else {\n          pointer.current = canvas.getPointer(e);\n          var rx = Math.abs(origX.current - pointer.current.x) / 2;\n          var ry = Math.abs(origY.current - pointer.current.y) / 2;\n          rx += someValue.current;\n          ry += someValue.current;\n          if (rx > ellipse.current.strokeWidth) {\n            rx -= ellipse.current.strokeWidth / 2;\n          }\n          if (ry > ellipse.current.strokeWidth) {\n            ry -= ellipse.current.strokeWidth / 2;\n          }\n          ellipse.current.set({ rx: rx, ry: ry });\n\n          if (origX.current > pointer.current.x) {\n            ellipse.current.set({ originX: \"right\" });\n          } else {\n            ellipse.current.set({ originX: \"left\" });\n          }\n          if (origY.current > pointer.current.y) {\n            ellipse.current.set({ originY: \"bottom\" });\n          } else {\n            ellipse.current.set({ originY: \"top\" });\n          }\n          ellipse.current.set({\n            originX: \"center\",\n            originY: \"center\",\n            left: origX.current + ellipse.current.rx,\n            top: origY.current + ellipse.current.ry,\n          });\n          newShape.current = true;\n          canvas.setActiveObject(ellipse.current);\n          // document.getElementById(\"select\").click();\n          canvas.renderAll();\n          // Save the canvas to State variable\n          const newCanvasState = canvas.toJSON([\"name\"]);\n          saveCanvasState(newCanvasState);\n        }\n      }\n      //check if user clicked an object\n      if (e.target) {\n        evt = e.e;\n        if (evt.altKey === true) {\n          if (e.target.name.includes(\"anchor\")) {\n            console.log(e.target);\n            var editable = openPoly.current;\n            var newPoints = editable.get(\"points\");\n            console.log(newPoints.length);\n            if (newPoints.length <= 3) return;\n            canvas.remove(e.target);\n\n            var pFill = editable.get(\"fill\");\n            var pStroke = editable.get(\"stroke\");\n            var pName = editable.get(\"name\");\n\n            var id = e.target.name.split(\"-\");\n            var pointIndex = parseInt(id[2]);\n            var cloneArray = newPoints.slice();\n            cloneArray.splice(pointIndex, 1);\n            console.log(newPoints);\n            console.log(cloneArray);\n\n            //canvas.remove(openPoly.current);\n            editable.set({ points: cloneArray });\n            console.log(editable);\n            /*\n            var updatedPoly = new fabric.Polyline(cloneArray, {\n              fill: pFill,\n              stroke: pStroke,\n              name: pName,\n              hasControls: false,\n              hasBorders: false,\n              selectable: false,\n              hoverCursor: \"default\",\n            });\n            canvas.add(updatedPoly);\n            canvas.sendToBack(updatedPoly);\n            */\n            canvas.renderAll();\n            //anchors.current = [];\n          }\n        }\n        if (!editPoly.current) return;\n        var activeShape = canvas.getActiveObject();\n        //if (activeShape.length > 1) return;\n        //        console.log(activeShape.type);\n        if (activeShape) {\n          console.log(activeShape);\n          // if (activeShape.stroke && activeShape.type !== \"i-text\") {\n          //   if (currentStroke.current !== null) {\n          //     var rgba = currentStroke.current\n          //       .substr(5)\n          //       .split(\")\")[0]\n          //       .split(\",\");\n          //     setStrokeColor({\n          //       r: rgba[0],\n          //       g: rgba[1],\n          //       b: rgba[2],\n          //       a: rgba[3],\n          //     });\n          //     //if()\n          //     console.log(activeShape.stroke);\n          //     setPickerColor(activeShape.stroke);\n\n          //     currentStroke.current = activeShape.stroke;\n          //     // activeObjectStrokeRef.current();\n          //     if (activeObjectStrokeRef?.current) {\n          //       activeObjectStrokeRef.current(activeShape.stroke);\n          //     }\n          //   }\n          //   setStrokeWidth(activeShape.strokeWidth);\n          // } else {\n          //   if (activeObjectStrokeRef?.current) {\n          //     activeObjectStrokeRef.current(\"nill\");\n          //   }\n          // }\n          if (activeShape.stroke !== null && activeShape.type !== \"i-text\") {\n            // setPickerColorStroke(activeShape.stroke);\n            if (activeObjectStrokeRef?.current) {\n              activeObjectStrokeRef.current(activeShape.stroke);\n            }\n          } else {\n            if (activeObjectStrokeRef?.current) {\n              activeObjectStrokeRef.current(\"nill\");\n            }\n          }\n          if (activeShape.fill) {\n            // setPickerColorFill(activeShape.fill);\n            if (activeObjectFillRef?.current) {\n              activeObjectFillRef.current(activeShape.fill);\n            }\n          } else {\n            if (activeObjectFillRef?.current) {\n              activeObjectFillRef.current(\"nill\");\n            }\n            // console.log(activeShape.fill);\n            // rgba = activeShape.fill.substr(5).split(\")\")[0].split(\",\");\n            // setFillColor({ r: rgba[0], g: rgba[1], b: rgba[2], a: rgba[3] });\n          }\n          //console.log(activeShape.opacity);\n          if (Number.isNaN(activeShape.opacity)) setOpacity(100);\n          else setOpacity(activeShape.opacity * 100);\n          //setOpacity(activeShape.opacity * 100);\n          //setFont(activeShape.fontFamily);\n          ///setFontSize(activeShape.fontSize);\n          //setFontWeight(activeShape.fontWeight);\n          //setFontStyle(activeShape.fontStyle);\n        }\n      }\n    });\n\n    canvas.on(\"mouse:wheel\", function (opt) {\n      var delta = opt.e.deltaY;\n      var zoom = canvas.getZoom();\n      zoom *= 0.999 ** delta;\n      if (zoom > 20) zoom = 20;\n      if (zoom < 0.01) zoom = 0.01;\n      canvas.zoomToPoint({ x: opt.e.offsetX, y: opt.e.offsetY }, zoom);\n      opt.e.preventDefault();\n      opt.e.stopPropagation();\n      var vpt = this.viewportTransform;\n      if (zoom < 400 / 1000) {\n        vpt[4] = 200 - (1000 * zoom) / 2;\n        vpt[5] = 200 - (1000 * zoom) / 2;\n      } else {\n        if (vpt[4] >= 0) {\n          vpt[4] = 0;\n        } else if (vpt[4] < canvas.getWidth() - 1000 * zoom) {\n          vpt[4] = canvas.getWidth() - 1000 * zoom;\n        }\n        if (vpt[5] >= 0) {\n          vpt[5] = 0;\n        } else if (vpt[5] < canvas.getHeight() - 1000 * zoom) {\n          vpt[5] = canvas.getHeight() - 1000 * zoom;\n        }\n      }\n    });\n    //object.on\n    canvas.on(\"mouse:down\", function (opt) {\n      if (canvasTool !== \"select\") {\n        this.selection = false;\n      }\n      var evt = opt.e;\n      if (opt.button === 2) {\n        this.isDragging = true;\n        this.selection = false;\n        this.lastPosX = evt.clientX;\n        this.lastPosY = evt.clientY;\n      }\n      // if (opt.button === 3) {\n      //   setCanvasTool(\"select\");\n      //   setActiveTool(evt, \"select\");\n      //   //document.getElementById(\"select\").click();\n      //   // canvas.renderAll();\n      //   //this.selection = true;\n      //   canvasRef.current.click();\n\n      //   //return;\n      // }\n      if (opt.e.altKey) {\n        if (evt.target) {\n          var temp, oObjectType;\n          var oObject = canvas.getActiveObject();\n\n          if (oObject) {\n            oObjectType = oObject.get(\"type\");\n            oObject.clone(function (cloned) {\n              temp = cloned;\n            });\n            shapeCount.current = shapeCount.current + 1;\n            temp.set({\n              hasControls: false,\n              hasBorders: false,\n              name: oObjectType + shapeCount.current,\n            });\n\n            canvas.add(temp);\n            canvas.renderAll();\n\n            // Save the canvas to State variable\n            const newCanvasState = canvas.toJSON([\"name\"]);\n            saveCanvasState(newCanvasState);\n          }\n        }\n      }\n    });\n    canvas.on(\"mouse:move\", function (opt) {\n      if (this.isDragging) {\n        var e = opt.e;\n        var vpt = this.viewportTransform;\n        vpt[4] += e.clientX - this.lastPosX;\n        vpt[5] += e.clientY - this.lastPosY;\n        this.requestRenderAll();\n        this.lastPosX = e.clientX;\n        this.lastPosY = e.clientY;\n      }\n      if (newShape.current === true && canvasTool !== \"pen\") {\n        return;\n      }\n      if (canvasTool === \"rect\") {\n        mouseMoving.current = true;\n        pointer.current = canvas.getPointer(opt);\n        if (origX.current > pointer.current.x) {\n          Rectangle.current.set({ left: Math.abs(pointer.current.x) });\n        }\n        if (origY.current > pointer.current.y) {\n          Rectangle.current.set({ top: Math.abs(pointer.current.y) });\n        }\n        Rectangle.current.set({\n          width: Math.abs(origX.current - pointer.current.x),\n        });\n        Rectangle.current.set({\n          height: Math.abs(origY.current - pointer.current.y),\n        });\n        canvas.requestRenderAll();\n      }\n      if (canvasTool === \"line\") {\n        mouseMoving.current = true;\n        pointer.current = canvas.getPointer(opt);\n        if (opt.e.shiftKey) {\n          var { tx, ty } = determineAdjustedCoords(\n            line.current.x1,\n            line.current.y1,\n            pointer.current.x,\n            pointer.current.y\n          );\n          line.current.set({ x2: tx, y2: ty });\n          // var deltaX = Math.abs(pointer.current.x - line.current.x1);\n          // var deltaY = Math.abs(pointer.current.y - line.current.y1);\n          // if (deltaX > deltaY)\n          //   line.current.set({ x2: pointer.current.x, y2: line.current.y1 });\n          // if (deltaY > deltaX)\n          //   line.current.set({ x2: line.current.x1, y2: pointer.current.y });\n        } else\n          line.current.set({ x2: pointer.current.x, y2: pointer.current.y });\n\n        canvas.renderAll();\n      }\n      if (canvasTool === \"arrow\") {\n        mouseMoving.current = true;\n        pointer.current = canvas.getPointer(opt);\n        if (opt.e.shiftKey) {\n          var { tx, ty } = determineAdjustedCoords(\n            line.current.x1,\n            line.current.y1,\n            pointer.current.x,\n            pointer.current.y\n          );\n          line.current.set({ x2: tx, y2: ty });\n          // var deltaX = Math.abs(pointer.current.x - line.current.x1);\n          // var deltaY = Math.abs(pointer.current.y - line.current.y1);\n          // if (deltaX > deltaY)\n          //   line.current.set({ x2: pointer.current.x, y2: line.current.y1 });\n          // if (deltaY > deltaX)\n          //   line.current.set({ x2: line.current.x1, y2: pointer.current.y });\n        } else\n          line.current.set({ x2: pointer.current.x, y2: pointer.current.y });\n\n        let dx = line.current.x2 - line.current.x1,\n          dy = line.current.y2 - line.current.y1;\n        angle.current = Math.atan2(dy, dx);\n        angle.current *= 180 / Math.PI;\n        angle.current += 90;\n        arrow.current.set({\n          top: line.current.y2,\n          left: line.current.x2,\n          angle: angle.current,\n          width: 15,\n          height: 15,\n        });\n        canvas.renderAll();\n      }\n      if (canvasTool === \"polyline\") {\n        if (isDrawing.current) {\n          mouseMoving.current = true;\n          var endPoint = canvas.getPointer(opt);\n          var evt = opt.e;\n          if (evt.shiftKey === true) {\n            if (\n              Math.abs(endPoint.x - line.current.x1) >\n              Math.abs(endPoint.y - line.current.y1)\n            ) {\n              console.log(\"line should be horizontally strait\");\n              line.current.set({\n                x2: endPoint.x,\n                y2: line.current.y1,\n              });\n              canvas.renderAll();\n              return;\n            } else {\n              console.log(\"line should be vertically strait\");\n              line.current.set({\n                x2: line.current.x1,\n                y2: endPoint.y,\n              });\n              canvas.renderAll();\n              return;\n            }\n          }\n          line.current.set({\n            x2: endPoint.x,\n            y2: endPoint.y,\n          });\n          canvas.renderAll();\n        }\n      }\n      if (canvasTool === \"polygon\") {\n        if (isDrawing.current) {\n          mouseMoving.current = true;\n          endPoint = canvas.getPointer(opt);\n          line.current.set({\n            x2: endPoint.x,\n            y2: endPoint.y,\n          });\n          canvas.renderAll();\n        }\n      }\n      if (canvasTool === \"rpolygon\") {\n        mouseMoving.current = true;\n        pointer.current = canvas.getPointer(opt);\n        rpolygon.current.set({\n          points: calcPolygonPoints(\n            8,\n            Math.abs(origX.current - pointer.current.x) / 2\n          ),\n          left: origX.current,\n          top: origY.current,\n        });\n        canvas.renderAll();\n      }\n      if (canvasTool === \"arc\") {\n        mouseMoving.current = true;\n        pointer.current = canvas.getPointer(opt);\n        var radius =\n          Math.max(\n            Math.abs(origY.current - pointer.current.y),\n            Math.abs(origX.current - pointer.current.x)\n          ) / 2;\n        if (radius > circle.current.strokeWidth) {\n          radius -= circle.current.strokeWidth / 2;\n        }\n        circle.current.set({ radius: radius });\n        if (origX.current > pointer.current.x) {\n          circle.current.set({ originX: \"right\" });\n          circle.current.set({ angle: -135 });\n        } else {\n          circle.current.set({ originX: \"left\" });\n          circle.current.set({ angle: 135 });\n        }\n        if (origY.current > pointer.current.y) {\n          circle.current.set({ originY: \"bottom\" });\n        } else {\n          circle.current.set({ originY: \"top\" });\n        }\n        canvas.renderAll();\n      }\n      if (canvasTool === \"circle\") {\n        mouseMoving.current = true;\n        pointer.current = canvas.getPointer(opt);\n        someValue.current =\n          Math.max(\n            Math.abs(origX.current - pointer.current.x),\n            Math.abs(origY.current - pointer.current.y)\n          ) / 20;\n        radius =\n          Math.max(\n            Math.abs(origX.current - pointer.current.x),\n            Math.abs(origY.current - pointer.current.y)\n          ) / 2;\n        // radius = Math.abs(origX.current - pointer.current.x) / 2;\n        radius += someValue.current;\n        if (radius > circle.current.strokeWidth) {\n          radius -= circle.current.strokeWidth / 2;\n        }\n        circle.current.set({ radius: radius });\n        if (origX.current > pointer.current.x) {\n          circle.current.set({ originX: \"right\" });\n        } else {\n          circle.current.set({ originX: \"left\" });\n        }\n        if (origY.current > pointer.current.y) {\n          circle.current.set({ originY: \"bottom\" });\n        } else {\n          circle.current.set({ originY: \"top\" });\n        }\n        canvas.renderAll();\n      }\n      if (canvasTool === \"ellipse\") {\n        mouseMoving.current = true;\n        pointer.current = canvas.getPointer(opt);\n        var rx = Math.abs(origX.current - pointer.current.x) / 2;\n        var ry = Math.abs(origY.current - pointer.current.y) / 2;\n        someValue.current =\n          Math.max(\n            Math.abs(origX.current - pointer.current.x),\n            Math.abs(origY.current - pointer.current.y)\n          ) / 20;\n        rx += someValue.current;\n        ry += someValue.current;\n        if (rx > ellipse.current.strokeWidth) {\n          rx -= ellipse.current.strokeWidth / 2;\n        }\n        if (ry > ellipse.current.strokeWidth) {\n          ry -= ellipse.current.strokeWidth / 2;\n        }\n        ellipse.current.set({ rx: rx, ry: ry });\n        if (origX.current > pointer.current.x) {\n          ellipse.current.set({ originX: \"right\" });\n        } else {\n          ellipse.current.set({ originX: \"left\" });\n        }\n        if (origY.current > pointer.current.y) {\n          ellipse.current.set({ originY: \"bottom\" });\n        } else {\n          ellipse.current.set({ originY: \"top\" });\n        }\n        canvas.renderAll();\n      }\n    });\n\n    canvas.on(\"mouse:over\", function (e) {\n      /*\n      if (e.target) {\n        //console.log(currentStroke.current);\n        currentStroke.current = e.target.get(\"stroke\");\n        //console.log(currentStroke.current);\n        e.target.set(\"stroke\", \"rgba(255,0,0,1)\");\n        canvas.renderAll();\n      }\n      */\n    });\n\n    canvas.on(\"mouse:out\", function (e) {\n      /*\n      if (e.target) {\n        e.target.set(\"stroke\", currentStroke.current);\n        canvas.renderAll();\n      }\n      */\n    });\n\n    setCanvas(canvas);\n\n    return () => {\n      canvas.dispose();\n      window.removeEventListener(\"resize\", handleResize);\n    };\n  }, [canvasRef, canvasTool, setCanvas]);\n\n  //const onUndo = useCallback(() => moveHistory(-1), [moveHistory]);\n  const onUndo = () => {\n    const present = past.pop();\n    const newFuture = [present, ...future];\n    setFuture(newFuture);\n    const previous = past[past.length - 1];\n    canvas.loadFromJSON(previous);\n    setPast(past);\n    console.log(past);\n  };\n  // const onRedo = useCallback(() => moveHistory(1), [moveHistory]);\n  const onRedo = () => {\n    const next = future[0];\n    canvas.loadFromJSON(next);\n    const newFuture = future.slice(1);\n    past.push(next);\n    setPast(past);\n    setFuture(newFuture);\n    console.log(future);\n  };\n  const setShapeAttributes = (attributes) => {\n    if (canvas === undefined) return;\n    var activeShape = canvas.getActiveObject();\n    if (activeShape) {\n      var Attributes = attributes || {};\n      if (activeShape.type === \"group\") {\n        activeShape.item(0).set({\n          stroke: Attributes.stroke || activeShape.item(1).stroke,\n          strokeWidth:\n            Attributes.strokeWidth || activeShape.item(1).strokeWidth,\n        });\n        activeShape.item(1).set({\n          stroke: Attributes.stroke || activeShape.item(1).stroke,\n          strokeWidth:\n            Attributes.strokeWidth || activeShape.item(1).strokeWidth,\n          fill: Attributes.fill || activeShape.item(1).fill,\n        });\n      }\n      activeShape.set({\n        strokeWidth: Attributes.strokeWidth || activeShape.strokeWidth,\n        stroke:\n          Attributes.stroke === \"nill\"\n            ? null\n            : Attributes.stroke || activeShape.stroke,\n        fill:\n          Attributes.fill === \"nill\"\n            ? null\n            : Attributes.fill || activeShape.fill,\n        opacity: Attributes.opacity / 100 || activeShape.opacity,\n        strokeDashArray:\n          Attributes.strokeDashArray || activeShape.strokeDashArray,\n        fontFamily: Attributes.fontFamily || activeShape.fontFamily,\n        fontSize: Attributes.fontSize || activeShape.fontSize,\n        fontWeight: Attributes.fontWeight || activeShape.fontWeight,\n        fontStyle: Attributes.fontStyle || activeShape.fontStyle,\n        textBackgroundColor:\n          Attributes.textBackgroundColor || activeShape.textBackgroundColor,\n      });\n      canvas.renderAll();\n      canvas.setActiveObject(activeShape);\n      const newCanvasState = canvas.toJSON([\"name\"]);\n      saveCanvasState(newCanvasState);\n    }\n  };\n\n  function deleteObjects() {\n    if (canvas.getActiveObjects().length === 0) {\n      // window.location.reload();\n      return;\n    }\n    canvas.getActiveObjects().forEach((obj) => {\n      canvas.remove(obj);\n    });\n  }\n\n  /*\n  var simulateMouseEvent = function (element, eventName, coordX, coordY) {\n    element.dispatchEvent(\n      new MouseEvent(eventName, {\n        view: window,\n        bubbles: true,\n        cancelable: true,\n        clientX: coordX,\n        clientY: coordY,\n        button: 0,\n      })\n    );\n  };\n\n  \n  function hexToRGB(hex, alpha) {\n    var r = parseInt(hex.slice(1, 3), 16),\n      g = parseInt(hex.slice(3, 5), 16),\n      b = parseInt(hex.slice(5, 7), 16);\n    if (alpha) {\n      return \"rgba(\" + r + \", \" + g + \", \" + b + \", \" + alpha + \")\";\n    } else {\n      return \"rgb(\" + r + \", \" + g + \", \" + b + \")\";\n    }\n  }\n*/\n  function w3_openPanel(evt, panelId) {\n    if (currentOpenPanel !== panelId) {\n      document.getElementById(\"Library\").style.height = \"400px\";\n      document.getElementById(panelId).style.display = \"block\";\n      if (currentOpenPanel !== \"none\")\n        document.getElementById(currentOpenPanel).style.display = \"none\";\n      currentOpenPanel = panelId;\n      return;\n    }\n\n    if (currentOpenPanel === panelId) {\n      if (panelId === \"none\") return;\n      document.getElementById(panelId).style.display = \"none\";\n      currentOpenPanel = \"none\";\n      document.getElementById(\"Library\").style.height = \"0px\";\n    }\n    /*\n    else {\n      if (currentOpenPanel !== \"None\") {\n        document.getElementById(currentOpenPanel).style.display = \"none\";\n      }\n      document.getElementById(\"Library\").style.height = \"400px\";\n      document.getElementById(panelId).style.display = \"block\";\n      currentOpenPanel = panelId;\n    }\n    */\n  }\n\n  const setActiveTool = (e, id) => {\n    if (currentToolId.current !== null) {\n      //console.log(currentToolId);\n      document.getElementById(currentToolId.current).style.backgroundColor =\n        \"#003059\";\n      document.getElementById(id).style.backgroundColor = \"grey\";\n      currentToolId.current = id;\n      return;\n    } else {\n      //console.log(id);\n      document.getElementById(id).style.backgroundColor = \"grey\";\n      currentToolId.current = id;\n    }\n  };\n\n  function handleKeyDown(event) {\n    if (mouseMoving.current === false) {\n      if (event.key === \"Escape\") {\n        setCanvasTool(\"select\");\n        setActiveTool(event, \"select\");\n        return;\n      }\n      if (event.key === \"s\") {\n        setCanvasTool(\"select\");\n        setActiveTool(event, \"select\");\n        return;\n      }\n      if (event.key === \"r\") {\n        setCanvasTool(\"rect\");\n        setActiveTool(event, \"rect\");\n        return;\n      }\n      if (event.key === \"l\") {\n        setCanvasTool(\"line\");\n        setActiveTool(event, \"line\");\n        return;\n      }\n      if (event.key === \"a\") {\n        setCanvasTool(\"arrow\");\n        setActiveTool(event, \"arrow\");\n        return;\n      }\n      if (event.key === \"c\") {\n        setCanvasTool(\"circle\");\n        setActiveTool(event, \"circle\");\n        return;\n      }\n      if (event.key === \"e\") {\n        setCanvasTool(\"ellipse\");\n        setActiveTool(event, \"ellipse\");\n        return;\n      }\n      if (event.key === \"t\") {\n        setCanvasTool(\"text\");\n        setActiveTool(event, \"text\");\n        return;\n      }\n      if (event.key === \"p\") {\n        setCanvasTool(\"pen\");\n        setActiveTool(event, \"pen\");\n        return;\n      }\n      if (event.key === \"Delete\") {\n        deleteObjects();\n        return;\n      }\n\n      if (event.ctrlKey && event.key === \"z\") {\n        if (past.length === 1) return;\n        onUndo();\n        return;\n      }\n      if (event.ctrlKey && event.key === \"y\") {\n        if (future.length === 0) return;\n        onRedo();\n        return;\n      }\n    }\n    if (mouseMoving.current === true) {\n      mouseMoving.current = false;\n      if (event.key === \"Escape\") {\n        if (canvasTool === \"rect\") {\n          canvas.remove(Rectangle.current);\n          newShape.current = true;\n          shapeCount.current--;\n          return;\n        }\n        if (canvasTool === \"line\") {\n          canvas.remove(line.current);\n          newShape.current = true;\n          shapeCount.current--;\n          return;\n        }\n        if (canvasTool === \"arrow\") {\n          canvas.remove(line.current);\n          canvas.remove(arrow.current);\n          newShape.current = true;\n          return;\n        }\n        if (canvasTool === \"polyline\") {\n          canvas.remove(line.current);\n          //canvas.remove(polyLine.current);\n          newShape.current = true;\n          return;\n        }\n        if (canvasTool === \"polygon\") {\n          canvas.remove(line.current);\n          newShape.current = true;\n          return;\n        }\n        if (canvasTool === \"rpolygon\") {\n          canvas.remove(rpolygon.current);\n          newShape.current = true;\n          shapeCount.current--;\n          return;\n        }\n        if (canvasTool === \"arc\") {\n          canvas.remove(circle.current);\n          newShape.current = true;\n          shapeCount.current--;\n          return;\n        }\n        if (canvasTool === \"circle\") {\n          canvas.remove(circle.current);\n          newShape.current = true;\n          shapeCount.current--;\n          return;\n        }\n        if (canvasTool === \"ellipse\") {\n          canvas.remove(ellipse.current);\n          newShape.current = true;\n          shapeCount.current--;\n          return;\n        }\n      }\n      //setActiveTool(event, \"select\");\n    }\n  }\n\n  let url = \"#\";\n\n  const swatchStyles = reactCSS({\n    default: {\n      stroke: {\n        width: \"36px\",\n        height: \"14px\",\n        borderRadius: \"2px\",\n        background: `rgba(${stroke.r}, ${stroke.g}, ${stroke.b}, ${stroke.a})`,\n      },\n      blank: {\n        width: \"36px\",\n        height: \"14px\",\n        borderRadius: \"2px\",\n      },\n      fill: {\n        width: \"36px\",\n        height: \"14px\",\n        borderRadius: \"2px\",\n        background: `rgba(${fill.r}, ${fill.g}, ${fill.b}, ${fill.a})`,\n      },\n      highlight: {\n        width: \"36px\",\n        height: \"14px\",\n        borderRadius: \"2px\",\n        background: `rgba(${textHighlight.r}, ${textHighlight.g}, ${textHighlight.b}, ${textHighlight.a})`,\n      },\n      swatch: {\n        padding: \"0px\",\n        background: \"#fff\",\n        borderRadius: \"1px\",\n        boxShadow: \"0 0 0 1px rgba(0,0,0,.1)\",\n        display: \"inline-block\",\n        cursor: \"pointer\",\n        backgroundImage: \"url(images/no.png)\",\n      },\n      pickerContainer: {\n        display: \"inline-block\",\n      },\n      popover: {\n        position: \"absolute\",\n        zIndex: \"2\",\n      },\n      cover: {\n        position: \"fixed\",\n        top: \"50px\",\n        right: \"0px\",\n        bottom: \"0px\",\n        left: \"100px\",\n      },\n    },\n  });\n\n  return (\n    <MediaQuery minDeviceWidth={1224}>\n      {/* <h1>Device Test!</h1>\n      {isDesktopOrLaptop && <p>You are a desktop or laptop</p>}\n      {isBigScreen && <p>You have a huge screen</p>}\n      {isTabletOrMobile && <p>You are a tablet or mobile phone</p>}\n      <p>Your are in {isPortrait ? \"portrait\" : \"landscape\"} orientation</p>\n      {isRetina && <p>You are retina</p>} */}\n      <div\n        ref={mainDiv}\n        className=\"App\"\n        id=\"mainDiv\"\n        onKeyDown={(e) => {\n          handleKeyDown(e);\n          document.getElementById(\"my-fabric-canvas\").focus();\n        }}\n        tabIndex={-1}\n        // tabIndex=\"0\"\n      >\n        <div className={tbStyles.propBar}>\n          <a href={url}>\n            <button\n              className={tbStyles.buttontoolbar}\n              onClick={onUndo}\n              id=\"undo\"\n              //disabled={canvasHistory[0] === canvasState}\n              disabled={past.length === 1}\n            >\n              <div className={tbStyles.tooltipDown}>\n                <img src={imgUndo} alt=\"Undo\"></img>\n                <span className={tbStyles.tooltiptextDown}>Undo</span>\n              </div>\n            </button>\n            <button\n              className={tbStyles.buttontoolbar}\n              onClick={onRedo}\n              id=\"redo\"\n              //disabled={canvasHistory[canvasHistory.length - 1] === canvasState}\n              disabled={future.length === 0}\n            >\n              <div className={tbStyles.tooltipDown}>\n                <img src={imgRedo} alt=\"Redo\"></img>\n                <span className={tbStyles.tooltiptextDown}>Redo</span>\n              </div>\n            </button>\n            <button\n              className={tbStyles.buttontoolbar}\n              onClick={deleteObjects}\n              id=\"del\"\n            >\n              <div className={tbStyles.tooltipDown}>\n                <img src={imgDelete} alt=\"Delete\"></img>\n                <span className={tbStyles.tooltiptextDown}>Delete</span>\n              </div>\n            </button>\n          </a>\n          <div className={tbStyles.dropdown}>\n            <button className={tbStyles.buttontoolbar} id=\"wList\">\n              <img src={imglineWidth} alt=\"Line Width\"></img>\n              <div id=\"wlDropDown\" className={tbStyles.dropdowncontent}>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setStrokeWidth(1);\n                    setShapeAttributes({\n                      strokeWidth: 1,\n                    });\n                  }}\n                >\n                  <img src={imgStroke1} alt=\"1\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setStrokeWidth(2);\n                    setShapeAttributes({\n                      strokeWidth: 2,\n                    });\n                  }}\n                >\n                  <img src={imgStroke2} alt=\"2\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setStrokeWidth(4);\n                    setShapeAttributes({\n                      strokeWidth: 4,\n                    });\n                  }}\n                >\n                  <img src={imgStroke4} alt=\"4\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setStrokeWidth(5);\n                    setShapeAttributes({\n                      strokeWidth: 5,\n                    });\n                  }}\n                >\n                  <img src={imgStroke5} alt=\"5\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setStrokeWidth(10);\n                    setShapeAttributes({\n                      strokeWidth: 10,\n                    });\n                  }}\n                >\n                  <img src={imgStroke10} alt=\"10\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setStrokeWidth(12);\n                    setShapeAttributes({\n                      strokeWidth: 12,\n                    });\n                  }}\n                >\n                  <img src={imgStroke12} alt=\"12\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setStrokeWidth(15);\n                    setShapeAttributes({\n                      strokeWidth: 15,\n                    });\n                  }}\n                >\n                  <img src={imgStroke15} alt=\"15\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setStrokeWidth(20);\n                    setShapeAttributes({\n                      strokeWidth: 20,\n                    });\n                  }}\n                >\n                  <img src={imgStroke20} alt=\"20\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setStrokeWidth(25);\n                    setShapeAttributes({\n                      strokeWidth: 25,\n                    });\n                  }}\n                >\n                  <img src={imgStroke25} alt=\"25\"></img>\n                </a>\n              </div>\n            </button>\n          </div>\n          <div className={tbStyles.dropdown}>\n            <button className={tbStyles.buttontoolbar} id=\"sList\">\n              <img src={imgLineStyle} alt=\"Line Style\"></img>\n              <div id=\"lsDropDown\" className={tbStyles.dropdowncontent}>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setDashSize(0);\n                    setGapSize(0);\n                    setShapeAttributes({\n                      strokeDashArray: [0, 0],\n                    });\n                  }}\n                >\n                  <img src={imgLineStyle1} alt=\"1\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setDashSize(10);\n                    setGapSize(5);\n                    setShapeAttributes({\n                      strokeDashArray: [10, 5],\n                    });\n                  }}\n                >\n                  <img src={imgLineStyle2} alt=\"1\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setDashSize(10);\n                    setGapSize(5);\n                    setShapeAttributes({\n                      strokeDashArray: [10, 5],\n                    });\n                  }}\n                >\n                  <img src={imgLineStyle3} alt=\"1\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setDashSize(20);\n                    setGapSize(5);\n                    setShapeAttributes({\n                      strokeDashArray: [20, 5],\n                    });\n                  }}\n                >\n                  <img src={imgLineStyle4} alt=\"1\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setDashSize(20);\n                    setGapSize(10);\n                    setShapeAttributes({\n                      strokeDashArray: [20, 10],\n                    });\n                  }}\n                >\n                  <img src={imgLineStyle5} alt=\"1\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setDashSize(5);\n                    setGapSize(5);\n                    setShapeAttributes({\n                      strokeDashArray: [5, 5],\n                    });\n                  }}\n                >\n                  <img src={imgLineStyle6} alt=\"1\"></img>\n                </a>\n                <a\n                  href={url}\n                  onClick={(e) => {\n                    setDashSize(2);\n                    setGapSize(2);\n                    setShapeAttributes({\n                      strokeDashArray: [2, 2],\n                    });\n                  }}\n                >\n                  <img src={imgLineStyle7} alt=\"1\"></img>\n                </a>\n              </div>\n            </button>\n          </div>\n          <button className={tbStyles.buttontoolbar} id=\"dropper\">\n            <div className={tbStyles.tooltipDown}>\n              <img src={imgDropper} alt=\"Pick a color\"></img>\n              <span className={tbStyles.tooltiptextDown}>Pick a color</span>\n            </div>\n          </button>\n          &nbsp;Stroke&nbsp;\n          <input\n            type=\"number\"\n            id=\"strokePoint\"\n            value={strokeWidth}\n            min=\"0\"\n            max=\"50\"\n            onChange={(e) => {\n              setStrokeWidth(+e.target.value);\n              setShapeAttributes({\n                strokeWidth: +e.target.value,\n              });\n            }}\n          ></input>\n          &nbsp;Dash&nbsp;\n          <input\n            type=\"number\"\n            min=\"0\"\n            max=\"20\"\n            id=\"dashSize\"\n            value={dashSize}\n            onChange={(e) => {\n              setDashSize(+e.target.value);\n              setShapeAttributes({\n                strokeDashArray: [+e.target.value, +e.target.value],\n              });\n            }}\n          ></input>\n          &nbsp;Stroke Color&nbsp;\n          <div style={swatchStyles.pickerContainer}>\n            <Picker\n              setPickerColor={setPickerColorStroke}\n              type=\"Stroke\"\n              ref={activeObjectStrokeRef}\n            />\n          </div>\n          &nbsp;Fill Color&nbsp;\n          <div style={swatchStyles.pickerContainer}>\n            <Picker\n              setPickerColor={setPickerColorFill}\n              type=\"Fill\"\n              ref={activeObjectFillRef}\n            />\n          </div>\n          {/* <div style={swatchStyles.pickerContainer}>\n            <div style={swatchStyles.swatch} onClick={StrokeSwatchClick}>\n              <div style={swatchStyles.stroke} />\n            </div>\n            {showStrokePicker ? (\n              <div style={swatchStyles.popover}>\n                <div style={swatchStyles.cover} onClick={StrokeSwatchClose} />\n                <SketchPicker color={stroke} onChange={StrokeSwatchChange} />\n              </div>\n            ) : null}\n          </div> */}\n          {/* &nbsp;Fill Color&nbsp;\n          <div style={swatchStyles.pickerContainer}>\n            <div style={swatchStyles.swatch} onClick={FillSwatchClick}>\n              <div id=\"fillSwatch\" style={swatchStyles.fill} />\n            </div>\n            {showFillPicker ? (\n              <div style={swatchStyles.popover}>\n                <div style={swatchStyles.cover} onClick={FillSwatchClose} />\n                <SketchPicker color={fill} onChange={FillSwatchChange} />\n              </div>\n            ) : null}\n          </div> */}\n          {/* &nbsp;HighlightText&nbsp;\n          <div style={swatchStyles.pickerContainer}>\n            <div style={swatchStyles.swatch} onClick={HighlightSwatchClick}>\n              <div style={swatchStyles.highlight} />\n            </div>\n            {showHighlightPicker ? (\n              <div style={swatchStyles.popover}>\n                <div\n                  style={swatchStyles.cover}\n                  onClick={HighlightSwatchClose}\n                />\n                <SketchPicker\n                  color={textHighlight}\n                  onChange={HighlightSwatchChange}\n                />\n              </div>\n            ) : null}\n          </div> */}\n          {/* &nbsp;\n          <button\n            id=\"noStroke\"\n            onClick={(e) => {\n              setStrokeColor({ r: 255, g: 255, b: 255, a: 0 });\n              setShapeAttributes({\n                stroke: \"rgba(255,255,255,0)\",\n              });\n            }}\n          >\n            <div className={tbStyles.tooltipDown}>\n              <img src={imgNoStroke} alt=\"No stroke\"></img>\n              <span className={tbStyles.tooltiptextDown}>Set No Stroke</span>\n            </div>\n          </button>\n          &nbsp;\n          <button\n            id=\"noFill\"\n            onClick={(e) => {\n              setFillColor({ r: 255, g: 255, b: 255, a: 0 });\n              setShapeAttributes({\n                fill: \"rgba(255,255,255,0)\",\n              });\n            }}\n          >\n            <div className={tbStyles.tooltipDown}>\n              <img src={imgNoFill} alt=\"No fill\"></img>\n              <span className={tbStyles.tooltiptextDown}>Set No Fill</span>\n            </div>\n          </button> */}\n          &nbsp;Opacity\n          <input\n            type=\"range\"\n            id=\"opacityRange\"\n            value={opacity}\n            onChange={(e) => {\n              //opacity.current = e.target.value;\n              setOpacity(e.target.value);\n              setShapeAttributes({\n                opacity: e.target.value,\n              });\n            }}\n          ></input>\n          &nbsp; Angle snap:\n          <input\n            type=\"checkbox\"\n            id=\"chkSnap\"\n            onChange={(e) => {\n              //console.log(e.target.checked);\n              snap.current = e.target.checked;\n            }}\n          ></input>\n          &nbsp;Font\n          <select\n            name=\"fonts\"\n            id=\"fonts\"\n            onChange={(e) => {\n              setFont(e.target.value);\n              setShapeAttributes({ fontFamily: e.target.value });\n            }}\n          ></select>\n          &nbsp;Size\n          <input\n            type=\"number\"\n            id=\"fontSize\"\n            value={fontSize}\n            min=\"0\"\n            max=\"100\"\n            onChange={(e) => {\n              setFontSize(+e.target.value);\n              setShapeAttributes({\n                fontSize: +e.target.value,\n              });\n            }}\n          ></input>\n          &nbsp;\n          <label>\n            FontWeight:\n            <select\n              value={fontWeight}\n              onChange={(e) => {\n                setFontWeight(e.target.value);\n                setShapeAttributes({\n                  fontWeight: e.target.value,\n                });\n              }}\n            >\n              <option value=\"normal\">Normal</option>\n              <option value=\"bold\">Bold</option>\n            </select>\n          </label>\n          <label>\n            FontSyle:\n            <select\n              value={fontStyle}\n              onChange={(e) => {\n                setFontStyle(e.target.value);\n                setShapeAttributes({\n                  fontStyle: e.target.value,\n                });\n              }}\n            >\n              <option value=\"regular\">Regular</option>\n              <option value=\"italic\">Italic</option>\n            </select>\n          </label>\n        </div>\n        <div id=\"lMenu\" className={styles.menu}>\n          <div className={styles.tableft}>\n            <button\n              onMouseEnter={(e) => {\n                w3_openPanel(e, \"File\");\n              }}\n              onClick={(e) => {\n                w3_openPanel(e, currentOpenPanel);\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgFileAccess} alt=\"FileAccess\"></img>\n                <span className={styles.tooltiptextleft}>File Access</span>\n              </div>\n            </button>\n            <button\n              onClick={(e) => {\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              onMouseEnter={(e) => {\n                w3_openPanel(e, \"CanvasSet\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgCanvasSettings} alt=\"Canvas Settings\"></img>\n                <span className={styles.tooltiptextleft}>Canvas Settings</span>\n              </div>\n            </button>\n            <button\n              onClick={(e) => {\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              onMouseEnter={(e) => {\n                w3_openPanel(e, \"LayerSet\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgLayers} alt=\"Layers\"></img>\n                <span className={styles.tooltiptextleft}>Layers</span>\n              </div>\n            </button>\n            <button\n              onClick={(e) => {\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              onMouseEnter={(e) => {\n                w3_openPanel(e, \"Warehouse\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgWarehouse} alt=\"Warehouse\"></img>\n                <span className={styles.tooltiptextleft}>Warehouse</span>\n              </div>\n            </button>\n            <button\n              onClick={(e) => {\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              onMouseEnter={(e) => {\n                w3_openPanel(e, \"Phases\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgPhase} alt=\"Phases\"></img>\n                <span className={styles.tooltiptextleft}>Phases</span>\n              </div>\n            </button>\n            <button\n              onClick={(e) => {\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              onMouseEnter={(e) => {\n                w3_openPanel(e, \"Measures\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgMeasurement} alt=\"Measurements\"></img>\n                <span className={styles.tooltiptextleft}>Measures</span>\n              </div>\n            </button>\n            <button\n              onClick={(e) => {\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              onMouseEnter={(e) => {\n                w3_openPanel(e, \"Animation\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgAnimation} alt=\"Animation\"></img>\n                <span className={styles.tooltiptextleft}>Phase Player</span>\n              </div>\n            </button>\n            <div className={styles.tabbar}></div>\n          </div>\n        </div>\n        <div\n          id=\"Library\"\n          className={styles.library}\n          onClick={(e) => {\n            //document.getElementById(\"File\").style.display = \"none\";\n            w3_openPanel(e, currentOpenPanel);\n          }}\n        >\n          <div id=\"File\" className={styles.File} style={{ display: \"none\" }}>\n            File Access\n            <span\n              onClick={(e) => {\n                //document.getElementById(\"File\").style.display = \"none\";\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              className={tbStyles.close}\n              title=\"Close Modal\"\n            >\n              &times;\n            </span>\n            <div className={styles.btngroup}>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgNewFile} alt=\"NewFile\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>New File</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgOpenFile} alt=\"OpenFile\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Open File</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgRecentFile} alt=\"RecentFile\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Recent File</span>\n              </div>\n            </div>\n          </div>\n          <div\n            id=\"CanvasSet\"\n            className={styles.CanvasSet}\n            style={{ display: \"none\" }}\n          >\n            Canvas Settings\n            <span\n              onClick={(e) => {\n                //document.getElementById(\"File\").style.display = \"none\";\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              className={tbStyles.close}\n              title=\"Close Modal\"\n            >\n              &times;\n            </span>\n            <div className={styles.btngroup}>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgCanvasSize} alt=\"CanvasSize\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Canvas Size</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgCanvasColor} alt=\"CanvasColor\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Canvas Color</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgCanvasImage} alt=\"CanvasImage\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Canvas Image</span>\n              </div>\n            </div>\n          </div>\n          <div\n            id=\"LayerSet\"\n            className={styles.LayerSet}\n            style={{ display: \"none\" }}\n          >\n            Layers\n            <span\n              onClick={(e) => {\n                //document.getElementById(\"File\").style.display = \"none\";\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              className={tbStyles.close}\n              title=\"Close Modal\"\n            >\n              &times;\n            </span>\n            <div className={styles.sbtngroup}>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgLayerBefore} alt=\"AddLayerBefore\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Add Layer Before</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgLayerAfter} alt=\"AddLayerAfter\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Add Layer After</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgLayerUp} alt=\"LayerUp\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Layer Up</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgLayerDown} alt=\"LayerDown\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Layer Down</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgLayerHide} alt=\"HideLayer\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Hide Layer</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgLayerLock} alt=\"LockLayer\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Lock Layer</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgLayerSort} alt=\"SortLayer\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Sort layer</span>\n              </div>\n            </div>\n            <ul className={styles.a}>\n              <li>Shapes</li>\n              <ul>\n                <li>Circle</li>\n                <li>Rectangle</li>\n              </ul>\n              <li>Texts</li>\n              <li>Lines</li>\n            </ul>\n          </div>\n          <div\n            id=\"Warehouse\"\n            className={styles.Warehouse}\n            style={{ display: \"none\" }}\n          >\n            Warehouse\n            <span\n              onClick={(e) => {\n                //document.getElementById(\"File\").style.display = \"none\";\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              className={tbStyles.close}\n              title=\"Close Modal\"\n            >\n              &times;\n            </span>\n            <div className={styles.btngroup}>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgCrane} alt=\"Crane\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Crane</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgElevator} alt=\"Elevator\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Elevator</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgLabels} alt=\"Labels\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Labels</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgCloud2} alt=\"Cloud\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Cloud</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgCallout} alt=\"Callout\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Callout</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgWedge} alt=\"Wedge\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Wedge</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgRing} alt=\"Ring\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Ring</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgFilledArc} alt=\"FilledArc\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Filled Arc</span>\n              </div>\n            </div>\n          </div>\n          <div\n            id=\"Phases\"\n            className={styles.Phases}\n            style={{ display: \"none\" }}\n          >\n            Phases\n            <span\n              onClick={(e) => {\n                //document.getElementById(\"File\").style.display = \"none\";\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              className={tbStyles.close}\n              title=\"Close Modal\"\n            >\n              &times;\n            </span>\n            <div className={styles.btngroup}>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgNewPhase} alt=\"NewPhase\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>NewPhase</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgPhaseStart} alt=\"StartDate\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Start Date</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgPhaseEnd} alt=\"EndDate\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>End Date</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgPhaseDelete} alt=\"DeletePhase\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Delete Phase </span>\n              </div>\n            </div>\n          </div>\n          <div\n            id=\"Measures\"\n            className={styles.Measures}\n            style={{ display: \"none\" }}\n          >\n            Measurement\n            <span\n              onClick={(e) => {\n                //document.getElementById(\"File\").style.display = \"none\";\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              className={tbStyles.close}\n              title=\"Close Modal\"\n            >\n              &times;\n            </span>\n            <div className={styles.btngroup}>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgPageScale} alt=\"PageScale\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Page Scale</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgSetUnits} alt=\"SetUnits\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Set Units</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgLength} alt=\"Length\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Length</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgPerimeter} alt=\"Perimeter\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Perimeter</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgArea} alt=\"Area\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Area</span>\n              </div>\n            </div>\n          </div>\n          <div\n            id=\"Animation\"\n            className={styles.Animation}\n            style={{ display: \"none\" }}\n          >\n            Phase Player\n            <span\n              onClick={(e) => {\n                //document.getElementById(\"File\").style.display = \"none\";\n                w3_openPanel(e, currentOpenPanel);\n              }}\n              className={tbStyles.close}\n              title=\"Close Modal\"\n            >\n              &times;\n            </span>\n            <div className={styles.sbtngroup}>\n              <div className={styles.tooltip}>\n                <button>Phase1</button>\n                <span className={styles.tooltiptextB}>Play</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>Phase2</button>\n                <span className={styles.tooltiptextB}>Play</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>Phase3</button>\n                <span className={styles.tooltiptextB}>Play</span>\n              </div>\n            </div>\n            <div className={styles.sbtngroup}>\n              <div className={styles.tooltip}>\n                <button>\n                  <img src={imgPlay} alt=\"Play\"></img>\n                </button>\n                <span className={styles.tooltiptextB}>Play/Stop</span>\n              </div>\n              <input type=\"range\" min=\"1\" max=\"100\"></input>\n              Play Speed\n              <div className={styles.tooltip}>\n                <button>1</button>\n                <span className={styles.tooltiptextB}>1 Day/Second</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>2</button>\n                <span className={styles.tooltiptextB}>2 Day/Second</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>5</button>\n                <span className={styles.tooltiptextB}>5 Day/Second</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>10</button>\n                <span className={styles.tooltiptextB}>10 Day/Second</span>\n              </div>\n              <div className={styles.tooltip}>\n                <button>30</button>\n                <span className={styles.tooltiptextB}>30 Day/Second</span>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className={styles.right} ref={rightBar}>\n          <div className={styles.tab}>\n            <button\n              id=\"select\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = true;\n                setCanvasTool(\"select\");\n                setActiveTool(e, \"select\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgSelection} alt=\"Select\"></img>\n                <span className={styles.tooltiptext}>Selection [S]</span>\n              </div>\n            </button>\n            <button\n              id=\"text\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"text\");\n                setActiveTool(e, \"text\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgText} alt=\"TextBox\"></img>\n                <span className={styles.tooltiptext}>Text [T]</span>\n              </div>\n            </button>\n            <button\n              id=\"pen\"\n              onClick={(e) => {\n                setCanvasTool(\"pen\");\n                canvas.isDrawingMode = 1;\n                if (stroke.a === 0) setStrokeColor({ r: 0, g: 0, b: 0, a: 1 });\n                canvas.freeDrawingBrush.color = stroke;\n                canvas.freeDrawingBrush.width = strokeWidth;\n                setActiveTool(e, \"pen\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgFreeHand} alt=\"Pen\"></img>\n                <span className={styles.tooltiptext}>Free-hand [H]</span>\n              </div>\n            </button>\n            <button\n              id=\"cloud\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"cloud\");\n                setActiveTool(e, \"cloud\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgCloud} alt=\"Cloud\"></img>\n                <span className={styles.tooltiptext}>Cloud</span>\n              </div>\n            </button>\n            <button\n              id=\"callout\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"callout\");\n                setActiveTool(e, \"callout\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgCallout} alt=\"Callout\"></img>\n                <span className={styles.tooltiptext}>Callout</span>\n              </div>\n            </button>\n            <button\n              id=\"image\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"image\");\n                setActiveTool(e, \"image\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgImageEdit} alt=\"Edit\"></img>\n                <span className={styles.tooltiptext}>Image Edit [I]</span>\n              </div>\n            </button>\n            <div className={styles.tabspace}></div>\n            <button\n              id=\"line\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                editPoly.current = true;\n                setCanvasTool(\"line\");\n                setActiveTool(e, \"line\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgLine} alt=\"Line\"></img>\n                <span className={styles.tooltiptext}>Line [L]</span>\n              </div>\n            </button>\n            <button\n              id=\"polyline\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                setCanvasTool(\"polyline\");\n                setActiveTool(e, \"polyline\");\n                canvas.selection = false;\n                var objects = canvas.getObjects();\n                for (var i = 0; i < objects.length; i++) {\n                  objects[i].set({ selectable: false, evented: false });\n                }\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgPolyline} alt=\"Polyline\"></img>\n                <span className={styles.tooltiptext}>Polyline [P]</span>\n              </div>\n            </button>\n            <button\n              id=\"arrow\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"arrow\");\n                setActiveTool(e, \"arrow\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgArrow} alt=\"Arrow\"></img>\n                <span className={styles.tooltiptext}>Arrow [A]</span>\n              </div>\n            </button>\n            <button\n              id=\"arc\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"arc\");\n                setActiveTool(e, \"arc\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgArc} alt=\"Arc\"></img>\n                <span className={styles.tooltiptext}>Arc [Q]</span>\n              </div>\n            </button>\n            <button\n              id=\"rect\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                canvas.selection = false;\n                canvas.forEachObject(function (o) {\n                  o.selectable = false;\n                });\n                canvas.renderAll();\n                setCanvasTool(\"rect\");\n                setActiveTool(e, \"rect\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgRect} alt=\"Rectangle\"></img>\n                <span className={styles.tooltiptext}>Rectangle [R]</span>\n              </div>\n            </button>\n            <button\n              id=\"polygon\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"polygon\");\n                setActiveTool(e, \"polygon\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgPolygon} alt=\"Polygon\"></img>\n                <span className={styles.tooltiptext}>Polygon [G]</span>\n              </div>\n            </button>\n            <button\n              id=\"rpolygon\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"rpolygon\");\n                setActiveTool(e, \"rpolygon\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgRPolygon} alt=\"Regular Polygon\"></img>\n                <span className={styles.tooltiptext}>Regular Polygon [U]</span>\n              </div>\n            </button>\n            <button\n              id=\"circle\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"circle\");\n                setActiveTool(e, \"circle\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgCircle} alt=\"Circle\"></img>\n                <span className={styles.tooltiptext}>Circle [C]</span>\n              </div>\n            </button>\n            <button\n              id=\"ellipse\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"ellipse\");\n                setActiveTool(e, \"ellipse\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgEllipse} alt=\"Ellipse\"></img>\n                <span className={styles.tooltiptext}>Ellipse {\"  \"} [E]</span>\n              </div>\n            </button>\n            <div className={styles.tabspace}></div>\n            <button\n              id=\"dimension\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"dimension\");\n                setActiveTool(e, \"dimension\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgDimension} alt=\"Dimension\"></img>\n                <span className={styles.tooltiptext}>Dimension [D]</span>\n              </div>\n            </button>\n\n            <button\n              id=\"area\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"area\");\n                setActiveTool(e, \"area\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgArea} alt=\"Area\"></img>\n                <span className={styles.tooltiptext}>Area</span>\n              </div>\n            </button>\n            <button\n              id=\"length\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"length\");\n                setActiveTool(e, \"length\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgLength} alt=\"Length\"></img>\n                <span className={styles.tooltiptext}>Length</span>\n              </div>\n            </button>\n            <button\n              id=\"perimeter\"\n              onClick={(e) => {\n                canvas.isDrawingMode = false;\n                canvas.selection = false;\n                setCanvasTool(\"perimeter\");\n                setActiveTool(e, \"perimeter\");\n              }}\n            >\n              <div className={styles.tooltip}>\n                <img src={imgPerimeter} alt=\"Perimeter\"></img>\n                <span className={styles.tooltiptext}>Perimeter</span>\n              </div>\n            </button>\n          </div>\n        </div>\n        <div ref={containerRef}>\n          <canvas\n            ref={canvasRef}\n            id=\"my-fabric-canvas\"\n            width={\n              isBigScreen\n                ? 1191\n                : isDesktopOrLaptop\n                ? 1086\n                : isTabletOrMobile\n                ? 960\n                : 640\n            }\n            height={\n              isBigScreen\n                ? 842\n                : isDesktopOrLaptop\n                ? 768\n                : isTabletOrMobile\n                ? 540\n                : 320\n            }\n          ></canvas>\n        </div>\n      </div>\n    </MediaQuery>\n  );\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}